var t,i;t={5490:(t,i,n)=>{"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.BillableEventType=i.BillableEvents=void 0;var r=n(1237);i.BillableEvents=r.default;var e=n(4225);Object.defineProperty(i,"BillableEventType",{enumerable:!0,get:function(){return e.BillableEventType}})},1237:(t,i)=>{"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function t(t,i){this.instanceName=i||"pbjs",this.viewabilityKey=this.getViewabilityKey(t)}return Object.defineProperty(t.prototype,"viewabilityKeyName",{get:function(){return this.viewabilityKey},enumerable:!1,configurable:!0}),t.prototype.getViewabilityKey=function(t){var i=window[this.instanceName];if(i){var n=i.getConfig().realTimeData.dataProviders.find((function(t){return"browsi"===t.name}));if(n&&n.params.keyName)return n.params.keyName}return t},t.prototype.dispatchBillableEvent=function(t){window.top.dispatchEvent(new CustomEvent("browsi_billable_event",{detail:t}))},t.prototype.isSlotInjectedPrediction=function(t){return!!t.getTargeting(this.viewabilityKey).length},t.prototype.removePredictionFromSlot=function(t){t.clearTargeting(this.viewabilityKey)},t}();i.default=n},4225:(t,i)=>{"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.BillableEventType=void 0,function(t){t.PAGEVIEW="pageview",t.AD_REQUEST="ad_request"}(i.BillableEventType||(i.BillableEventType={}))},8939:(t,i,n)=>{"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.BlankAdReportService=void 0;var r=n(8901);i.BlankAdReportService=r.default},8901:(t,i)=>{"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function t(){}return t.prototype.checkForBlankAd=function(t){var i=this;return new Promise((function(n,r){var e=t.querySelector("iframe");if(e&&i.isFriendlyIframe(e)&&e.contentDocument){var s=e.parentElement,o=e.contentWindow.document;setTimeout((function(){var t=i.isHidden(e)||i.isCreativeChildrenMaxHeightReached(o,s)||i.isMinCreativeSizeReached(e)||null;return n(t?{isBlank:!0,reason:t}:{isBlank:!1})}),5e3)}else r("Could not investigate blank ad")}))},t.prototype.isHidden=function(t){return"none"===t.style.display?"hidden":null},t.prototype.isCreativeChildrenMaxHeightReached=function(t,i){return i&&i&&this.getChildrenMaxHeight(i)<2&&this.getChildrenMaxHeight(t.body)<2?"children_max_height":null},t.prototype.isMinCreativeSizeReached=function(t){return t.height===t.width&&+t.height<101?"creative_size":null},t.prototype.isFriendlyIframe=function(t){var i=+new Date+""+Math.random();try{var n=t.contentWindow;return!!n&&(n[i]="asd","asd"===n[i])}catch(t){return!1}},t.prototype.isChildrenMaxHeightReached=function(t,i){return i&&i&&this.getChildrenMaxHeight(i)<2&&this.getChildrenMaxHeight(t.body)<2?"children_max_height":null},t.prototype.getChildrenMaxHeight=function(t){var i=0;return Array.from(t.querySelectorAll(":scope > *")).forEach((function(t){i=Math.max(i,t.getBoundingClientRect().height)})),i},t}();i.default=n},1031:(t,i,n)=>{"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.Engagement=void 0;var r=n(7113);i.Engagement=r.default},7113:function(t,i,n){"use strict";var r=this&&this.__spreadArrays||function(){for(var t=0,i=0,n=arguments.length;i<n;i++)t+=arguments[i].length;var r=Array(t),e=0;for(i=0;i<n;i++)for(var s=arguments[i],o=0,u=s.length;o<u;o++,e++)r[e]=s[o];return r};Object.defineProperty(i,"__esModule",{value:!0});var e=n(1680),s=function(){function t(t){this._velocities=[],this._listeners=[],this._isSubscribed=!1,this._timeoffset=t||Date.now(),this._outOfFocusTime=0,this._hiddenTime=0,this._pageHeight=this.getPageHeight(),this._windowHeight=this.getWindowHeight(),this._lastScrollingDistance=this.getScrollingDistance(),this._maxScrollDepthPercentage=this.getMaxScrollDepth(),this._lastVelocityReportTime=Date.now(),this._title=this.getTitlesText(),this._metaDescription=this.getDescriptionText()}return t.prototype.subscribe=function(){this._isSubscribed||(this._isSubscribed=!0,this.initScrollListener(),this.initVisibilityChangeListener(),this.initVelocityListener(),this.initResizeListener())},t.prototype.unsubscribe=function(){this._isSubscribed&&(this._listeners.forEach((function(t){window.removeEventListener(t.eventName,t.eventHandler)})),clearInterval(this._velocityInterval),this._listeners=[],this._isSubscribed=!1)},t.get=function(i){return t._instance||(t._instance=new t(i)),t._instance},t.prototype.getData=function(){return{max_depth_percentage:this._maxScrollDepthPercentage,screen_length:this.getScreenLength(),time_on_page:this.getTimeOnPage(),velocity_excluding_static_time:this.getAverageVelocity(e.VelocityType.EXCLUDE_STATIC_USER),velocity_including_static_time:this.getAverageVelocity(e.VelocityType.INCLUDE_STATIC_USER),page_load_time:this.getPageLoadTime(),title:this._title,meta_description:this._metaDescription}},t.prototype.getPageLoadTime=function(){try{var t=window.performance.getEntriesByType("navigation")[0];if("complete"===document.readyState&&t&&t.loadEventEnd>0&&t.domContentLoadedEventStart>0)return Math.floor(Math.abs(t.loadEventEnd-t.domContentLoadedEventStart))}catch(t){}return-1},t.prototype.getScreenLength=function(){return window.screen.availHeight||window.screen.height},t.prototype.initResizeListener=function(){var t=this,i=function(){t._pageHeight=t.getPageHeight(),t._windowHeight=t.getWindowHeight()};this._listeners.push({eventName:"resize",eventHandler:i}),window.addEventListener("resize",i)},t.prototype.initScrollListener=function(){var t=this,i=this.throttle((function(){t._maxScrollDepthPercentage=t.getMaxScrollDepth()}),1e3);this._listeners.push({eventName:"scroll",eventHandler:i}),window.addEventListener("scroll",i)},t.prototype.initVisibilityChangeListener=function(){var t=this,i=function(){"hidden"===window.document.visibilityState?t._hiddenTime=Date.now():t._hiddenTime>0&&(t._outOfFocusTime=t._outOfFocusTime+(Date.now()-t._hiddenTime))};this._listeners.push({eventName:"visibilitychange",eventHandler:i}),window.addEventListener("visibilitychange",i)},t.prototype.initVelocityListener=function(){var t=this;this._velocityInterval||(this._velocityInterval=setInterval((function(){t._velocities.push(t.getMomentVelocity())}),1e3))},t.prototype.getMaxScrollDepth=function(){var t=this.getScrollDepthPercentages(),i=this._maxScrollDepthPercentage||0;return Math.max(i,t)},t.prototype.getScrollDepthPercentages=function(){var t=this.getScrollingDistance(),i=this._pageHeight;return Math.round(t/i*100)},t.prototype.getScrollingDistance=function(){return this.getPageYOffset()+this._windowHeight},t.prototype.getPageYOffset=function(){return window.pageYOffset||window.scrollY},t.prototype.getWindowHeight=function(){return window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight},t.prototype.getPageHeight=function(){var t,i;return Math.floor(Math.max(null===(t=window.document.body)||void 0===t?void 0:t.scrollHeight,null===(i=window.document.body)||void 0===i?void 0:i.offsetHeight,window.document.documentElement.clientHeight,window.document.documentElement.scrollHeight,window.document.documentElement.offsetHeight))},t.prototype.getTimeOnPage=function(){var t=(Date.now()-this._timeoffset)/1e3,i=this._outOfFocusTime/1e3;return Number((t-i).toFixed(2))},t.prototype.getAverageVelocity=function(t){var i=r(this._velocities);t===e.VelocityType.EXCLUDE_STATIC_USER&&(i=i.filter(Number));var n=i.reduce((function(t,i){return t+i}),0);return i.length>0?n/i.length:-1},t.prototype.getMomentVelocity=function(){var t=Date.now(),i=this.getScrollingDistance()-this._lastScrollingDistance,n=(t-this._lastVelocityReportTime)/1e3;return this._lastVelocityReportTime=t,this._lastScrollingDistance=this.getScrollingDistance(),i?Math.round(Math.abs(i/n)):0},t.prototype.getTitlesText=function(){var t=[];return document.querySelectorAll("h1").forEach((function(i){t.push(i.innerText.trim().replace(/_/g,"-"))})),t.length?t.join("_"):void 0},t.prototype.getDescriptionText=function(){var t=[];return document.querySelectorAll("meta[name='description'],meta[property='og:description']").forEach((function(i){t.push(i.content.trim().replace(/_/g,"-"))})),t.length?t.join("_"):void 0},t.prototype.throttle=function(t,i){var n=Date.now();return function(){n+i-Date.now()<0&&(t(),n=Date.now())}},t}();i.default=s},1680:(t,i)=>{"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.VelocityType=void 0,function(t){t.EXCLUDE_STATIC_USER="exclude_static_user",t.INCLUDE_STATIC_USER="include_static_user"}(i.VelocityType||(i.VelocityType={}))},7590:(t,i,n)=>{"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.Moat=void 0;var r=n(7971);i.Moat=r.default},7971:(t,i)=>{"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function t(t){this.config=t,this.client={moatClientLevel1:t.layout_id,moatClientLevel2:t.site_key,moatClientLevel3:t.devicePlatform,moatClientLevel4:t.publisher_key}}return t.prototype.getURL=function(){return t.SCRIPT_SRC+"#"+this.toUrlParams(this.client)},t.prototype.toUrlParams=function(t){return Object.keys(t).map((function(i){return i+"="+("object"==typeof t[i]?encodeURIComponent(JSON.stringify(t[i])):encodeURIComponent(t[i]))})).join("&")},t.SCRIPT_SRC="//z.moatads.com/browsidisplay14489870757/moatad.js",t}();i.default=n},9301:(t,i,n)=>{"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.POV_EVENT_TYPE=i.PotentialViewabilityService=void 0;var r=n(3158);Object.defineProperty(i,"PotentialViewabilityService",{enumerable:!0,get:function(){return r.PotentialViewabilityService}}),Object.defineProperty(i,"POV_EVENT_TYPE",{enumerable:!0,get:function(){return r.POV_EVENT_TYPE}})},3158:(t,i)=>{"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.PotentialViewabilityService=i.POV_EVENT_TYPE=void 0,i.POV_EVENT_TYPE="pov";var n="__bpv",r=function(){function t(t,r,e){this.spots=[],localStorage.removeItem(n),this._analytics={et:i.POV_EVENT_TYPE,pvid:t,url:r,mot:0,bs:[]},this.adMarkingHeight=e?15:0,this.initFocusListener(),this.initScrollListener()}return t.prototype.handlePotentialSpot=function(i,r){var e,s=this;if(!this.spots.find((function(t){return t.spotRef===i.spotRef}))){this.spots.push(i);var o=this.CreateIntersectElement(i);new IntersectionObserver((function(e,o){e.forEach((function(e){var u,a=t.intersectionData.findIndex((function(t){return t.spotData.spotRef===i.spotRef}));e.isIntersecting&&e.intersectionRatio>=.5&&(u=window.setTimeout((function(){var e=t.intersectionData.findIndex((function(t){return t.spotData.spotRef===i.spotRef}));if(e>-1){var u=t.intersectionData.splice(e,1)[0];return s._analytics.bs.push({adIndex:u.spotData.spotIndex,offsetTop:window.top.scrollY,reasons:r.join(",")}),localStorage.setItem(n,JSON.stringify(s._analytics)),void o.disconnect()}}),1e3),-1===a&&t.intersectionData.push({spotData:i,observer:o,entry:e,timeout:u})),!e.isIntersecting&&a>-1&&s.resetViewability(a,u)}))}),{threshold:.5}).observe(o.absChild),null===(e=i.spotRef.parentElement)||void 0===e||e.insertBefore(o.point,i.spotRef)}},t.getLastPvData=function(){return new Promise((function(t){var i=localStorage.getItem(n);localStorage.removeItem(n),t(i?JSON.parse(i):void 0)}))},t.unObserve=function(t){var i=this;if(t){var n=this.intersectionData.find((function(i){return i.spotData.spotIndex===t}));n&&this.removeObservation(n)}else this.listeners.forEach((function(t){window.top.document.removeEventListener(t.eventName,t.eventHandler)})),this.intersectionData.forEach((function(t){i.removeObservation(t)}))},t.removeObservation=function(t){t.observer.disconnect(),t.entry.target.remove()},t.prototype.resetViewability=function(i,n){t.intersectionData.splice(i,1),clearTimeout(n)},t.prototype.CreateIntersectElement=function(t){var i=this.getSpotOffset(t),n=this.createPoint(),r=this.createAbsoluteChild(t,i);return n.appendChild(r),{point:n,absChild:r}},t.prototype.createAbsoluteChild=function(t,i){var n=document.createElement("div");return n.style.position="absolute",n.style.height=t.size.h+"px",n.style.width=t.size.w+"px",n.style.top=i+"px",n.style.background="transparent",n.style.zIndex="-99999999",n.style.userSelect="none",n},t.prototype.createPoint=function(){var t=document.createElement("span");return t.setAttribute("bpv",""),t.style.position="relative",t},t.prototype.getSpotOffset=function(t){var i=this.spots.filter((function(i){return i.positionTag===t.positionTag})).sort((function(t,i){return t.adDistanceFromTop>i.adDistanceFromTop?1:-1})),n=32+this.adMarkingHeight;return i.reduce((function(i,r){return r.spotRef!=t.spotRef&&(i+=r.size.h+n),i}),0)},t.prototype.initFocusListener=function(){var i=function(){"hidden"===window.top.document.visibilityState?t.intersectionData.forEach((function(t){clearTimeout(t.timeout),t.observer.disconnect()})):t.intersectionData.forEach((function(t){t.observer.observe(t.entry.target)}))};t.listeners.push({eventName:"visibilitychange",eventHandler:i}),window.top.document.addEventListener("visibilitychange",i)},t.prototype.initScrollListener=function(){var i,r,e,s=this,o=(i=function(){if(s._analytics.mot<window.top.scrollY){s._analytics.mot=window.top.scrollY;var t=Object.assign({},s._analytics,{mot:s._analytics.mot+window.top.innerHeight});localStorage.setItem(n,JSON.stringify(t))}},r=1e3,e=Date.now(),function(){e+r-Date.now()<0&&(i(),e=Date.now())});t.listeners.push({eventName:"scroll",eventHandler:o}),window.top.document.addEventListener("scroll",o)},t.intersectionData=[],t.listeners=[],t}();i.PotentialViewabilityService=r},5218:(t,i,n)=>{"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.WebVitals=void 0;var r=n(4070);Object.defineProperty(i,"WebVitals",{enumerable:!0,get:function(){return r.WebVitals}})},4070:(t,i)=>{"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.WebVitals=void 0;var n="__bwv",r=function(){function t(t,i){this.webVitalsData={pv:t,url:i}}return t.prototype.getData=function(){return new Promise((function(t,i){try{var r=localStorage.getItem(n);r?t(JSON.parse(r)):t(),localStorage.removeItem(n)}catch(t){i(t)}}))},t.prototype.measure=function(){var t=this;this.getInstance().then((function(i){i.getFID(t.collectWebVitals.bind(t)),i.getLCP(t.collectWebVitals.bind(t)),i.getCLS(t.collectWebVitals.bind(t))}))},t.prototype.collectWebVitals=function(t){var i=this.prepareDataFields(t),r=i.name.toLowerCase();this.webVitalsData[r]=i.value;try{localStorage.setItem(n,JSON.stringify(this.webVitalsData))}catch(t){}},t.prototype.getInstance=function(){return new Promise((function(t){if(window.top.webVitals)t(window.top.webVitals);else{var i=document.createElement("script");i.src="//cdn.browsiprod.com/web-vitals/web-vitals.iife.2.1.0.js",i.onload=function(){t(window.top.webVitals)},document.head.appendChild(i)}}))},t.prototype.prepareDataFields=function(t){var i=t.name,n=t.value;return{name:i,value:n="number"==typeof n?+n.toFixed(3):n}},t}();i.WebVitals=r},7121:(t,i,n)=>{"use strict";var r=n(1993),e=n(125),s=n(2970),o=n(7730),u=n(2727),a=n(6393),c=n(905),h=n(9394),f=n(7247),d=n(1128);n(6652);var l,v=n(514),p=n(3034),m=n(4817),w=n(9301),b=n(5218),g=n(4941),_=n(5490),y=n(3881),O=n(1031),j=n(8614),k=function(){function t(){this.logger=new e.Logger("App.ts"),this.profile=o.Profiler.get(),o.Profiler.setLoadTime(l),this.logger.info("profile: ",this.profile),o.Profiler.detectAdBlocker((function(){return r.EventsService.get().sendAdBlockerEvent()}))}return t.prototype.run=function(){this.logger.info("started"),"bl"===this.profile.runMode?this.blocklistedRun():this.standardRun()},t.prototype.blocklistedRun=function(){this.logger.custom("Blocklisted mode",u.Utils.getLogStyle(48,"red","#000")),this.setUserEngagedListener(),r.EventsService.get().sendPageviewEvent(0,0,0,0,0,0)},t.prototype.standardRun=function(){var t,i=this;if(!this.profile.layouts.analysisMode&&!this.profile.identity.isBenchmarkPageview&&(new m.DemandTool,this.profile.layouts.fixedSpotsFirst)){this.logger.info("scanning fixed spots first");var n=s.default.instance.findSpots(d.FIXED_TAGS,(function(){}),!0);a.YieldClient.get().processSpots(n)}this.profile.layouts.analysisMode&&this.logger.custom("AnalysisMode ON",u.Utils.getLogStyle(18,"red","#000")),this.setUserEngagedListener();var e=new b.WebVitals(this.profile.identity.pageviewId,this.profile.identity.url);e.getData().then((function(t){t&&r.EventsService.get().sendWebVitalsEvent(t),i.profile.layouts.useWebVitals&&e.measure()})).catch((function(t){i.logger.error(t)})),!this.profile.identity.isBenchmarkPageview&&(null===(t=this.profile.layouts.lazySpots)||void 0===t?void 0:t.collectPotentialViewability)&&w.PotentialViewabilityService.getLastPvData().then((function(t){if(t){var n=Object.assign({},t,{sk:i.profile.identity.siteKey,pk:i.profile.identity.siteKey});r.EventsService.get().sendGenericAnalyticsEvent(w.POV_EVENT_TYPE,n)}})),this.profile.logEngagement&&c.EngagementService.get().subscribe(),this.initSummaryEvent();var o=u.Utils.getLoaderParams().sec.t;o?(this.logger.info("waiting "+o+"mc"),setTimeout((function(){i.desktopRunner()}),o)):this.desktopRunner()},t.prototype.initSummaryEvent=function(){O.Engagement.get(this.profile.identity.timeOffset).subscribe(),j.Focus.get().subscribe((function(t){t&&r.EventsService.get().sendSummaryEvent()}))},t.prototype.initializeRun=function(){var t=this;return new Promise((function(i){var n="engineInitiator",r=u.Utils.getExternalFlowHandler(n);if(r)try{t.logger.info("executing "+n),r(u.Utils.getLoaderParams(),i,t.profile)}catch(i){t.logger.error("failed to execute "+n,i)}else i(!1)}))},t.prototype.desktopRunner=function(){var t=this;this.initializeRun().then((function(i){i&&(t.profile=o.Profiler.rebuild(u.Utils.getLoaderParams())),t.runPageView()}))},t.prototype.runPageView=function(){var t=this;if(this.runTriggersHook(),this.profile.identity.isBenchmarkPageview)this.SendBenchmarkEvents();else{this.profile.domData=o.Profiler.collectDOMData(),p.SpotsUtils.rebuild();var i=this.isProfileValid(this.profile.domData),n=d.SCAN_SPOT_TAGS.filter((function(t){return!i.invalidTypes.includes(t.oldType)}));this.logger.info("types to scan",n.map((function(t){return t.oldType}))),i.errorMessages.length&&this.logger.warn("invalid profiles: ",i.errorMessages),u.Utils.isStickyActive()&&n.push(d.SPOT_TAGS_MAP[d.SpotType.STICKY]),n.length?this.checkAndHandleDcs(this.profile).catch((function(i){return t.logger.error("DCS: "+i)})).then((function(i){t.profile.layouts.fixedSpotsFirst&&(n=n.filter((function(t){return!d.FIXED_TAGS.includes(t)}))),t.findSpots(s.default.instance,n,i||void 0),h.default.get().scan(!0),u.Utils.buildBrowsiOutput(t.profile)})):(this.profile.state="error",this.logger.warn("Invalid profile",i.errorMessages),r.EventsService.get().sendPageviewEvent(0,0,0,0,0,0,i.errorMessages),this.checkAndHandleDcs(this.profile))}h.default.get().scan(!0),u.Utils.buildBrowsiOutput(this.profile)},t.prototype.checkAndHandleDcs=function(t){var i=f.DcsFactory.buildDcs(t);return i?i.dcsObj&&"error"===t.state?i.detectUrlChangeOnly():i.prepareAndRunDcs():Promise.resolve()},t.prototype.findSpots=function(t,i,n){var r=t.findSpots(i,n,!1);r=r.filter((function(t){return t.type!==d.SpotType.STICKY})),a.YieldClient.get().handleSpots(r)},t.prototype.isProfileValid=function(t){var i=[],n=[];return d.SCAN_SPOT_TAGS.forEach((function(r){var e=p.SpotsUtils.getConf(r),s=o.Profiler.validateProfileForBehavior(t,r.oldType,e);!s.length&&p.SpotsUtils.isActive(r)||(i.push(r.oldType),n=n.concat(s.map((function(t){return r.oldType+"_"+t}))))})),{invalidTypes:i,errorMessages:n}},t.prototype.SendBenchmarkEvents=function(){this.logger.custom("Benchmark Mode",u.Utils.getLogStyle(30,"black","red")),r.EventsService.get().sendPageviewEvent(0,0,0,0,0,0),this.profile.state="done"},t.prototype.setUserEngagedListener=function(){var t=this;if(u.Utils.getScrollPosition().top>0)r.EventsService.get().sendUserEngagementEvent();else{var i=function(){t.logger.info("detected engagementScroll, send event"),v.default.get().removeListener("scroll",u.Utils.getScrollElement(),i),t.profile.isUserEngaged=!0,r.EventsService.get().sendUserEngagementEvent()};v.default.get().listen("scroll",u.Utils.getScrollElement(),i)}},t.prototype.runTriggersHook=function(){var t=u.Utils.getExternalFlowHandler("triggers");t&&t({pv:function(t){r.EventsService.get().sendPageviewEvent(0,0,0,0,0,0,[],t)},gd:function(t,i){r.EventsService.get().sendGeneralDataEvent(t,i)}})},t}();function x(){"interactive"!==document.readyState&&"complete"!==document.readyState||window._middyo.loaded||(window._middyo.loaded=!0,(new k).run())}!function(){var t,i,n,e;n=u.Utils.getLoaderParams(),(e=null===(i=null===(t=null==n?void 0:n.sec)||void 0===t?void 0:t.dcs)||void 0===i?void 0:i.su)&&new g.DcsApi(n,e),r.EventsService.get().sendEngineLoadedEvent(),l=Date.now();var s=o.Profiler.get();s.siteInfo.billableEvents===_.BillableEventType.PAGEVIEW&&function(){var t,i={site_key:o.Profiler.get().identity.siteKey,publisher_key:o.Profiler.get().identity.publisherKey,bill_type:_.BillableEventType.PAGEVIEW,page_view_id:o.Profiler.get().identity.pageviewId};new _.BillableEvents(o.Profiler.get().browsiViewability50Key,null===(t=o.Profiler.get().siteInfo.prebidData)||void 0===t?void 0:t.g).dispatchBillableEvent(i)}(),s.layouts.sendPrebidBillableEvents&&y.PrebidJs.listenToBillableEvents(),window.document.addEventListener("readystatechange",(function(){return x()})),x()}()},7151:function(t,i,n){"use strict";var r=this&&this.__spreadArrays||function(){for(var t=0,i=0,n=arguments.length;i<n;i++)t+=arguments[i].length;var r=Array(t),e=0;for(i=0;i<n;i++)for(var s=arguments[i],o=0,u=s.length;o<u;o++,e++)r[e]=s[o];return r};Object.defineProperty(i,"__esModule",{value:!0}),i.DefaultSpotsStrategy=void 0;var e=n(125),s=n(7730),o=n(2727),u=n(3034),a=n(1128),c=function(){function t(){var t,i,n;this.logger=new e.Logger("SpotsStrategy"),this.profile=s.Profiler.get(),this.maxItems=(null===(t=u.SpotsUtils.getConf(a.SPOT_TAGS_MAP[a.SpotType.DYNAMIC_MC]))||void 0===t?void 0:t.maxSpots)||0,this.logger.custom("spots strategy: default",o.Utils.getLogStyle(18,"black","green")),this.logger.custom("Allow narrow ads to break: "+!!(null===(i=this.profile.layouts)||void 0===i?void 0:i.allowNarrowBreak)+", Allow narrow ads wrap: "+!!(null===(n=this.profile.domData)||void 0===n?void 0:n.allowNarrowWrap)+" ",o.Utils.getLogStyle(18,"white","blue"))}return t.prototype.stopScanning=function(t){return this.maxItems===this.filterSpotsBy(t,"narrow","wrapped",!1).length},t.prototype.selectSpots=function(t){var i=this.maxItems,n=[],e=[],s=this.filterSpotsBy(t,"narrow","wrapped",!0,i);this.logger.debug("selected narrow spots with wrap: ",s),(i-=s.length)>0&&(n=this.filterSpotsBy(t,"narrow","break",!0,i,s),this.logger.debug("selected narrow spots with break: ",n),i-=n.length),i>0&&(e=this.filterSpotsBy(t,"wide","break",!0,i,r(s,n)),this.logger.debug("selected wide spots with break: ",e));var u=o.Utils.sortSpotsByOffsetTop.apply(o.Utils,r(s,n,e)).slice(0,this.maxItems);return(u=this.assignWrappingDirection(u)).forEach((function(t,i){t.initializeTypeIndex(i)})),u},t.prototype.selectEmbeddings=function(t){return t.forEach((function(t){t.compatibleSizes.forEach((function(t){t.selectedEmbedding=t.optionalEmbeddings.includes("wrapped")?"wrapped":"break"}))})),t},t.prototype.filterSpotsBy=function(t,i,n,r,e,s){var o=t.filter((function(t){return(!s||!s.includes(t))&&t.compatibleSizes.filter((function(t){return t.adSizeType===i&&t.optionalEmbeddings.includes(n)})).length>0}));return e&&Number.isInteger(e)&&e<o.length&&(o=o.slice(0,e)),r&&(o=this.selectEmbeddings(o)),o},t.prototype.getWrapType=function(){return"random"===this.profile.spotEngineConfig.embedType?Math.random()>.5?"left":"right":this.profile.spotEngineConfig.embedType},t.prototype.assignWrappingDirection=function(t){var i=this;return t.forEach((function(t){t.compatibleSizes.forEach((function(t){"wrapped"===t.selectedEmbedding&&(t.selectedEmbedding=i.getWrapType())}))})),t},t}();i.DefaultSpotsStrategy=c},5762:function(t,i,n){"use strict";var r,e=this&&this.__extends||(r=function(t,i){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])},r(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)});Object.defineProperty(i,"__esModule",{value:!0});var s=n(2362),o=n(1345),u=function(t){function i(i){return t.call(this,i)||this}return e(i,t),i.prototype.appendAndGetWrapper=function(t){var i=this;return new Promise((function(n,r){if(t.ref&&t.ref.parentNode){var e=void 0;o.Inframe.get().isProviderInframe(t)&&(e=o.Inframe.get().getSpotContainer(t));var s=(null==e?void 0:e.adWrapper)||document.createElement("div"),u=(null==e?void 0:e.adContainer)||document.createElement("div");s.setAttribute("spotType",t.type),s.setAttribute("typeIndex",""+t.typeIndex),u.id=i.containerId,s.id=i.wrapperId,(null==e?void 0:e.adContainer)||s.appendChild(u),s.style.display="none",i.appendAd(t,s,!!e),t.browsiAd.win=window,t.browsiAd.wrapper=s,t.browsiAd.container=u,t.browsiAd.iframe=null,i.setPlaceholder(t,s,u),n(t.browsiAd)}else r(t.browsiAd)}))},i}(s.Embedder);i.default=u},2362:(t,i,n)=>{"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.Embedder=void 0;var r=n(2727),e=n(7730),s=n(125),o=n(6319),u=n(1128),a=n(8104),c=n(3034),h=n(1993),f=n(4869),d=function(){function t(i){var n,r=i.getIdentifier();this.wrapperId=t.wrapperIdPrefix+"_"+r,this.containerId=t.containerIdPrefix+"_"+r,this.profile=e.Profiler.get();var s=o.DcsUtils.getWindowObject(),u=(null==s?void 0:s.count)||(null===(n=this.profile.dcsState)||void 0===n?void 0:n.count);u&&(this.wrapperId+="_dcs_"+u,this.containerId+="_dcs_"+u),i.setDomId(this.wrapperId)}return t.prototype.appendAd=function(i,n,e){if(i.isRefreshing()||t.removeAdFromDom(i),!e)if(i.type===u.SpotType.STICKY)this.appendStickyAd(n);else if(i.ref.parentNode){if(i.tableConfiguration){var s=i.tableConfiguration.mainTd.cloneNode();s.appendChild(n),i.ref.parentNode.insertBefore(s,i.ref)}else switch(i.targetElementPosition){case"ABOVE":i.ref.insertAdjacentElement("beforebegin",n);break;case"INSIDE":i.ref.insertAdjacentElement("afterbegin",n)}r.Utils.reportNewBrowsiAd(n)}else r.Utils.reportNewBrowsiAd(n);this.runPostEmbedHook(i,n)},t.prototype.runPostEmbedHook=function(t,i){var n=r.Utils.getExternalFlowHandler("postEmbed");n&&n(t,i)},t.prototype.appendStickyAd=function(t){var i,n=window.document.body;(null===(i=c.SpotsUtils.getConf(u.SPOT_TAGS_MAP[u.SpotType.STICKY]))||void 0===i?void 0:i.location)===a.StickyLocation.BOTTOM?n.appendChild(t):n.insertBefore(t,n.firstElementChild),r.Utils.reportNewBrowsiAd(t)},t.isEmbeddedByBrowsi=function(i){var n=Array.from(r.Utils.getCurrentContextElement().querySelectorAll('div[id^="'+t.wrapperIdPrefix+'"]')),e=!1;return n.forEach((function(t){!e&&r.Utils.isPositionContained(t,i)&&(e=!0)})),e},t.injectMoat=function(t){t.browsiAd.wrapper&&r.Utils.injectMoat(t.browsiAd.iframe||t.browsiAd.wrapper,!!t.browsiAd.iframe)},t.addStickyCloseButton=function(i,n){var e,s=c.SpotsUtils.getConf(u.SPOT_TAGS_MAP[u.SpotType.STICKY]);if(n&&(null==s?void 0:s.closeButton)){var o=s.location,f=document.documentElement.clientWidth||r.Utils.getPageWidth(),d=(null===(e=i.selectedSize)||void 0===e?void 0:e.w)||f,l=document.createElement("c-button");l.id="close-sticky-"+i.getIdentifier(),l.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 30 30"><defs><style>.a{fill:#fff;stroke:#707070;}.b{stroke:none;}.c{fill:none;}</style></defs><g transform="translate(-1429 -929)"><g class="a" transform="translate(1429 929)"><circle class="b" cx="15" cy="15" r="15"/><circle class="c" cx="15" cy="15" r="14.5"/></g><path d="M20.518,6.563,18.955,5l-6.2,6.2L6.563,5,5,6.563l6.2,6.2L5,18.955l1.563,1.563,6.2-6.2,6.2,6.2,1.563-1.563-6.2-6.2Z" transform="translate(1430.975 930.975)"/></g></svg>',l.setAttribute("style","position: absolute;width: 24px;height: 24px;border:none; background:none;padding:0;cursor:pointer"),l.style.right=f-24<=d?"0px":"-12px",l.style[o===a.StickyLocation.BOTTOM?"top":"bottom"]="-12px",l.onclick=function(){i.isRefreshing()||(t.removeStickyAd(i),h.EventsService.get().sendStickyClosedEvent(i))},n.appendChild(l)}},t.removeStickyAd=function(i){if("s"===i.tags.positionTag){t.removeAdFromDom(i),i.destroySlot(),f.ViewabilityService.get().unsubscribe(i);var n=window.document.body.style,r=c.SpotsUtils.getConf(u.SPOT_TAGS_MAP[u.SpotType.STICKY]);r&&r.location===a.StickyLocation.TOP?n.paddingTop="":n.paddingBottom=""}},t.removeAdFromDom=function(t){var i,n,e,s;if(null===(i=t.placeholder)||void 0===i||i.stopObserving(),(null===(n=t.browsiAd)||void 0===n?void 0:n.externalElement)&&r.Utils.removeElement(t.browsiAd.externalElement),null===(e=t.browsiAd)||void 0===e?void 0:e.wrapper){var o=document.querySelector("#"+t.browsiAd.wrapper.id);if(!(o&&document.body.contains(o)&&o.parentNode))return!1;if((null===(s=t.browsiAd.admarking)||void 0===s?void 0:s.parentElement)===o&&this.removeAdMarkingFromDom(t.browsiAd),!t.tableConfiguration)return o.parentNode.removeChild(o),!0;var u=o.parentElement;if(u&&u.parentNode)return u.parentNode.removeChild(u),!0}return!1},t.removeAdMarkingFromDom=function(t){var i;return!!(null===(i=null==t?void 0:t.admarking)||void 0===i?void 0:i.parentNode)&&(t.admarking.parentNode.removeChild(t.admarking),delete t.admarking,!0)},t.prototype.setPlaceholder=function(t,i,n){if(t.placeholder&&!t.isRefreshing()){var r=t.placeholder.size;i.style.display="block",n.setAttribute("style","display:block; width:"+r.w+"px; height:"+r.h+"px; background-color:transparent;margin:auto;"),t.placeholder.openPlaceholder(t)}},t.logger=new s.Logger("Embedder"),t.wrapperIdPrefix="browsi_adWrapper",t.containerIdPrefix="browsi_adContainer",t}();i.Embedder=d},8033:(t,i,n)=>{"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.EmbeddingFactory=void 0;var r=n(5762),e=n(6790),s=function(){function t(){}return t.getEmbedder=function(t,i){if("header_bidding"===t.rt)return t.c.if?new e.default(i):new r.default(i);if("empty_api"===t.rt)return new r.default(i);var n=t;switch(n.c.p){case"dfp":case"generic_js":return"true"===n.c.a.inIFrame?new e.default(i):new r.default(i);default:return null}},t}();i.EmbeddingFactory=s},6790:function(t,i,n){"use strict";var r,e=this&&this.__extends||(r=function(t,i){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])},r(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)});Object.defineProperty(i,"__esModule",{value:!0});var s=function(t){function i(i){return t.call(this,i)||this}return e(i,t),i.prototype.appendAndGetWrapper=function(t){var i=this;return new Promise((function(n,r){if(t.ref&&t.ref.parentNode){var e=!1,s=document.createElement("div"),o=document.createElement("iframe");s.setAttribute("spotType",t.type),s.setAttribute("typeIndex",""+t.typeIndex),s.appendChild(o),s.id=i.wrapperId,o.id=i.containerId,o.scrolling="no",o.frameBorder="0",o.marginHeight="0",o.marginWidth="0",o.height="0",o.width="0",o.style.display="none",i.setIframePlaceholderStyle(o,t),o.onload=function(){if(!e){if(e=!0,o.contentDocument){o.contentDocument.open(),o.contentDocument.close();var r=o.contentDocument.createElement("div");r.setAttribute("id",i.containerId),o.contentDocument.body.appendChild(r),t.browsiAd.win=o.contentWindow||void 0,t.browsiAd.wrapper=s,t.browsiAd.container=r,t.browsiAd.iframe=o,i.setPlaceholder(t,s,r)}o.contentWindow.__cmp=window.__cmp,n(t.browsiAd)}},o.onerror=function(){r(t.browsiAd)},i.appendAd(t,s,!1)}else r(t.browsiAd)}))},i.prototype.setIframePlaceholderStyle=function(t,i){if(i.placeholder){var n=i.getPlaceholderSize();t.width=""+n.w,t.height=""+n.h,t.style.display="block"}},i}(n(2362).Embedder);i.default=s},6258:(t,i,n)=>{"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.ProviderFactory=void 0;var r=n(2247),e=n(6418),s=n(8008),o=function(){function t(){}return t.getProvider=function(t,i){switch(t.rt){case"empty_api":return new r.DFP(i);case"provider":var n=t;switch(n.c.p){case"dfp":return new r.DFP(i);case"generic_js":return new s.GenericJS(i,n);default:return null}case"header_bidding":var o=t;return i.providerName="header_bidding",new e.HeaderBiddingDA(i,o.c.b,o.c.d)}return null},t.setSpotProviderName=function(t,i){var n,r;switch(i.providerDisplayName=void 0,null==t?void 0:t.rt){case"header_bidding":i.providerName="header_bidding";break;case"empty_api":i.providerName="dfp";break;case"provider":var e=t;switch((null===(n=e.c.a)||void 0===n?void 0:n.template)&&(i.providerName="generic_js",i.providerDisplayName=null===(r=e.c.a.template)||void 0===r?void 0:r.p),e.c.p){case"dfp":i.providerName="dfp";break;case"generic_js":i.providerName="generic_js"}}return i.providerName||null},t}();i.ProviderFactory=o},2970:function(t,i,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(t){for(var i,n=1,r=arguments.length;n<r;n++)for(var e in i=arguments[n])Object.prototype.hasOwnProperty.call(i,e)&&(t[e]=i[e]);return t},r.apply(this,arguments)},e=this&&this.__spreadArrays||function(){for(var t=0,i=0,n=arguments.length;i<n;i++)t+=arguments[i].length;var r=Array(t),e=0;for(i=0;i<n;i++)for(var s=arguments[i],o=0,u=s.length;o<u;o++,e++)r[e]=s[o];return r};Object.defineProperty(i,"__esModule",{value:!0});var s=n(2727),o=n(125),u=n(1993),a=n(635),c=n(7151),h=n(7730),f=n(9235),d=n(1128),l=n(5310),v=n(979),p=n(6319),m=n(9394),w=n(6393),b=n(3034),g=n(4603),_=n(7989),y=n(4510),O=n(5382),j=-1,k=0,x=600,S=100,I=200,M=300,A=400,T=700,P=800,N=function(){function t(){this.firstScanSpots=[],this.adIndexLimit=99,this.logger=new o.Logger("SpotEngine"),this.profile=h.Profiler.get(),this.availableSpots=[],this.spotsFromPreviousPageview=[],this.lastScannedElement=null,this.firstScannedElement=null,this.isMenuPositionFixed=!1,this.spotsStrategy=new c.DefaultSpotsStrategy,this.currentSpotType=d.SpotType.DYNAMIC_MC,this.spotsBeforeDcs=[],this.typesScannedBeforeDcs=[],this.apiSpots=[],this.profile.debugMode&&(this.profile.spotEngineTest={}),this.endlessRails={}}return Object.defineProperty(t,"instance",{get:function(){return this._instance||(this._instance=new t),this._instance},enumerable:!1,configurable:!0}),t.prototype.findSpots=function(i,n,r,e){var o,a,c,h,f,v=this;void 0===n&&(n=this.sendPageViewEvent.bind(this));var m=p.DcsUtils.getDcsType(),w=!!m;if(w&&(i=i.filter((function(t){return!b.SpotsUtils.getTypesToDisableOnDcs(m).includes(t.oldType)&&!v.typesScannedBeforeDcs.includes(t.oldType)})),"end_less"===m)){var g=p.DcsUtils.getCurrentDcsElement();g&&(this.endlessRails={element:g,top:s.Utils.getElementCoordinates(g).top})}var _=i.filter((function(t){return b.SpotsUtils.isFixedSpot(t.oldType)})),y=[],O=[],j=[],k=[];_.length&&(y=this.scanFixedSpots(w,_,!r),(o=this.availableSpots).push.apply(o,y));var x=i.map((function(t){return t.oldType}));if(x.includes(d.SpotType.DYNAMIC_MC)){O=this.scanDynamicSpots(w),(a=this.availableSpots).push.apply(a,O);var S=b.SpotsUtils.getConf(d.SPOT_TAGS_MAP[d.SpotType.DYNAMIC_MC]),I=(null==S?void 0:S.maxItems)||0,M=(null==S?void 0:S.maxSpots)||0;this.logger.custom("Dynamic spots found: "+O.length,s.Utils.getLogStyle(18,"black","green"),O),this.logger.custom("Dynamic max items: "+I+" | potential spots: "+M,s.Utils.getLogStyle(16,"black","green"))}var A=i.filter((function(t){return b.DYNAMIC_RAIL_TYPES.includes(t.oldType)}));A.length&&(j=this.scanDynamicRailsSpots(A),(c=this.availableSpots).push.apply(c,j)),x.includes(d.SpotType.STICKY)&&(k=this.scanForSticky(w)),this.availableSpots=[];var T=this.setAdIndexesByColumn(O,y,j,k);for(var P in T)T.hasOwnProperty(P)&&(h=this.availableSpots).push.apply(h,T[P].spots);return this.availableSpots.forEach((function(t){t.type!==d.SpotType.STICKY&&(l.default.isLazyConfiguredForSpotType(t)&&(t.isLazyLoading=l.default.get().isLazy(t)),u.EventsService.get().sendSpotFoundEvent(t),v.logger.info("Found "+t.type+" spot",t.ref))})),r?((f=this.firstScanSpots).push.apply(f,y),this.availableSpots=[],y.filter((function(t){return!v.spotsFromPreviousPageview.includes(t)}))):(w&&this.handleSpotsFromPreviousPageview(),e||(n(t._instance),this.profile.debugMode&&(this.buildSpotEngineTest(),this.profile.state="done")),this.availableSpots.filter((function(t){return!v.spotsFromPreviousPageview.includes(t)})))},t.prototype.setAdIndexesByColumn=function(t,i,n,r){var e=this,o={topSpots:{spots:s.Utils.sortSpotsByPosition.apply(s.Utils,i.filter((function(t){return t.type===d.SpotType.FIXED_TOP}))),startIndex:S},dynamicInContentSpots:{spots:s.Utils.sortSpotsByPosition.apply(s.Utils,t),startIndex:k},fixedInContentSpots:{spots:s.Utils.sortSpotsByPosition.apply(s.Utils,i.filter((function(t){return t.type===d.SpotType.FIXED_MC}))),startIndex:x},bottomSpots:{spots:s.Utils.sortSpotsByPosition.apply(s.Utils,i.filter((function(t){return t.type===d.SpotType.FIXED_BOTTOM}))),startIndex:I},dynamicRightRailSpots:{spots:s.Utils.sortSpotsByPosition.apply(s.Utils,n.filter((function(t){return t.type===d.SpotType.DYNAMIC_RIGHT_RAIL}))),startIndex:M},dynamicLeftRailSpots:{spots:s.Utils.sortSpotsByPosition.apply(s.Utils,n.filter((function(t){return t.type===d.SpotType.DYNAMIC_LEFT_RAIL}))),startIndex:A},fixedRightRailSpots:{spots:s.Utils.sortSpotsByPosition.apply(s.Utils,i.filter((function(t){return t.type===d.SpotType.FIXED_RIGHT_RAIL}))),startIndex:T},fixedLeftRailSpots:{spots:s.Utils.sortSpotsByPosition.apply(s.Utils,i.filter((function(t){return t.type===d.SpotType.FIXED_LEFT_RAIL}))),startIndex:P},stickySpots:{spots:r,startIndex:j}},u=function(t){if(o.hasOwnProperty(t)){var i=o[t].spots,n=o[t].startIndex;i.forEach((function(t,i){var r=Math.min(i,e.adIndexLimit);t.adIndex=n+r}))}};for(var a in o)u(a);return o},t.prototype.scanBeforeDcs=function(){var t=b.SpotsUtils.getTagsToScanBeforeDcs(),i=!!this.profile.layouts.fixedSpotsFirst;i&&(t=t.filter((function(t){return!b.FIXED_TYPES.includes(t.oldType)})));var n=t.map((function(t){return t.oldType}));this.logger.info("scan for spots before DCS",n),this.spotsBeforeDcs=this.findSpots(t,(function(){}),i),this.typesScannedBeforeDcs=n,this.availableSpots=[],w.YieldClient.get().handleSpots(this.spotsBeforeDcs)},t.prototype.sendPageViewEvent=function(){var t=this.getSpotsByType(d.SpotType.FIXED_BOTTOM).length+this.getSpotsByType(d.SpotType.FIXED_TOP).length;u.EventsService.get().sendPageviewEvent(this.getSpotsByType(d.SpotType.DYNAMIC_MC).length,this.getSpotsByType(d.SpotType.FIXED_MC).length,this.getSpotsByType(d.SpotType.STICKY).length,t,this.getRightRailsSpotsFound().length,this.getLeftRailsSpotsFound().length)},t.prototype.scanFixedSpots=function(t,i,n){var r=this;this.logger.info("Scanning for fixed spots... extra validation: "+n);var e=[];return i.forEach((function(i){var o=b.SpotsUtils.getConf(i);if(o){var a=r.getStartInFold(o),c=o.maxSpots,h=o.elements,f=o.allowedCreativeSizes;r.getFixedElementsBySelector(o.targetElements);for(var l=function(h){if(r.isPositionInsideAndNotEmpty(o,h))return r.logger.debug("invalid spot [position inside and not empty]:",h),u.EventsService.get().sendErrorEvent("configuration_error","","fixed spot rejected - positioned inside of non empty element"),"continue";if(n){if(!b.SpotsUtils.getRailsTypes().includes(i.oldType)&&r.isStopInFoldViolated(h,o.stopInFold))return r.logger.debug("invalid spot [below stop in fold]:",h),"continue";if("invalid"===r.validateSpot(h,a,!0,i,o).status)return"continue"}var l=s.Utils.clone(f).filter((function(t){return!r.isCompSizeBiggerThanParentSize(t,h)})),v=r.getCompatibleAdsSizes(h,0,i.oldType,l,!0);if(n&&"invalid"===r.validateStayAway(h,e,v,i.oldType===d.SpotType.FIXED_MC,i).status)return"continue";if(v.length>0){var p=e.filter((function(t){return t.type===i.oldType})).length,m=r.getSelectorByElement(h),w=new y.FixedSpot(h,p,v,0,i.oldType,t,m);r.logger.info("New",i.oldType," spot found: ",w.ref),e.push(w)}else r.logger.debug("invalid fixed spot [no compatible size found]:",h);return e.filter((function(t){return t.type===i.oldType})).length>=c?"break":void 0},v=0,p=h;v<p.length&&"break"!==l(p[v]);v++);r.logger.custom(i.oldType+" spots found: "+e.filter((function(t){return t.type===i.oldType})).length,s.Utils.getLogStyle(18,"black","green")),r.logger.custom(i.oldType+" max items: "+Math.min(c,o.maxItems)+" | potential spots: "+o.maxSpots,s.Utils.getLogStyle(16,"black","green"))}})),e},t.prototype.scanDynamicSpots=function(t){var i=this;this.logger.info("Scanning for dynamic spots...");var n=[];if(!this.profile.domData)return n;var r=b.SpotsUtils.getConf(d.SPOT_TAGS_MAP[d.SpotType.DYNAMIC_MC]),e=this.getStartInFold(r);if(r)for(var o=function(o){var a;if(u.isAlreadyWrapped(n,o))return"continue";if(u.spotsStrategy.stopScanning(n))return u.lastScannedElement=o.previousElementSibling,"break";if(u.isStopInFoldViolated(o,r.stopInFold))return u.lastScannedElement=o.previousElementSibling,u.logger.debug("SpotEngine Stopped. StopIF = "+r.stopInFold+", reached element at fold "+s.Utils.getElementFoldNumber(o)+": ",o),"break";if("invalid"===u.validateSpot(o,e,!1,d.SPOT_TAGS_MAP[d.SpotType.DYNAMIC_MC],r).status)return"continue";var c=s.Utils.sortByHeight(s.Utils.clone(r.allowedCreativeSizes)).filter((function(t){return!i.isCompSizeBiggerThanParentSize(t,o)})),h=[],f=u.getNextParagraphsTotalHeight(o,u.profile.spotEngineConfig.wrappingAdditionalElements,c,h),l=u.getCompatibleAdsSizes(o,f,d.SpotType.DYNAMIC_MC,c);if("invalid"===u.validateStayAway(o,n,l,!0,d.SPOT_TAGS_MAP[d.SpotType.DYNAMIC_MC]).status)return"continue";if(u.hasValidDynamicSizes(l)){var v=new _.DynamicSpot(o,d.SpotType.DYNAMIC_MC,n.length,l,f,t);u.logger.info("New dynamic spot found: ",v.ref),(a=v.wrappedElements).push.apply(a,h),n.push(v)}else u.logger.debug("invalid dynamic spot [no compatible size found]:",o)},u=this,a=0,c=r.elements;a<c.length&&"break"!==o(c[a]);a++);return this.logger.info("Spots found before filtering: ",n),this.spotsStrategy.selectSpots(n)},t.prototype.scanDynamicRailsSpots=function(t){var i=this;if(this.logger.info("Scanning for dynamic rails spots..."),!t.length)return[];var n=[];return t.forEach((function(t){for(var r=b.SpotsUtils.getConf(t),e=r.maxSpots,o=function(o){if(i.isAlreadyWrapped(n,o))return"continue";if("invalid"===i.validateSpot(o,0,!1,t,r).status)return"continue";var u=s.Utils.clone(r.allowedCreativeSizes).filter((function(t){return!i.isCompSizeBiggerThanParentSize(t,o)})),a=i.getCompatibleAdsSizes(o,0,t.oldType,u);if("invalid"===i.validateStayAway(o,n,a,!1,t).status)return"continue";if(i.hasValidDynamicSizes(a)){var c=new _.DynamicSpot(o,t.oldType,n.filter((function(i){return i.type===t.oldType})).length,a,0,!1);i.logger.info("New "+t.oldType+" spot found: ",c.ref),n.push(c)}else i.logger.debug("invalid "+t.oldType+" spot [no compatible size found]:",o);return n.filter((function(i){return i.type===t.oldType})).length>=e?"break":void 0},u=0,a=r.elements;u<a.length&&"break"!==o(a[u]);u++);i.logger.custom(t.oldType+" spots found: "+n.filter((function(i){return i.type===t.oldType})).length,s.Utils.getLogStyle(18,"black","green")),i.logger.custom(t.oldType+" max items: "+Math.min(e,r.maxItems)+" | potential spots: "+r.maxSpots,s.Utils.getLogStyle(16,"black","green"))})),n},t.prototype.scanForSticky=function(t){if(!s.Utils.isStickyActive())return[];if(this.isStickyApiIdsConfigured())return this.logger.info("Sticky spot in invalid because Sticky Api spot is already defined"),[];if(this.stickyFoundOnPage())return this.logger.info("Sticky spot in invalid because of publisher sticky ad"),[];var i=new O.StickySpot(this.getStickyCompatibleAdsSizes(),t);return u.EventsService.get().sendSpotFoundEvent(i),this.logger.info("Found "+d.SpotType.STICKY+" spot"),w.YieldClient.get().processSingleSpot(i),[i]},t.prototype.isAlreadyWrapped=function(t,i){return t.some((function(t){return t.wrappedElements.map((function(t){return t.el})).includes(i)}))},t.prototype.stickyFoundOnPage=function(){return m.default.get().foundAds.some((function(t){return t.positionType.indexOf("sticky")>-1}))},t.prototype.hasValidDynamicSizes=function(t){return t.filter((function(t){return!s.Utils.is1x1(t)})).length>0},t.prototype.isSkippedElement=function(t){return this.profile.domData&&this.profile.domData.skippedElements.some((function(i){return s.Utils.isDescendantElement([i],t)&&b.SpotsUtils.isValidHeightForSkipSa(t)}))?{status:"invalid",message:"skipped element"}:{status:"valid"}},t.prototype.isBrowsiStayAway=function(t,i,n,r){if(b.SpotsUtils.isFixedSpot(r.oldType))return{status:"valid"};if(this.hasFoundSpots(i)){var e=this.getSpotsByColumn(i,r.oldType).filter((function(t){return!s.Utils.isFixed(t.ref)}));return e.length&&e.some((function(i){if(i.ref===t)return{status:"invalid",message:"stay_away_from_browsi"};var e=s.Utils.calculateDistanceBetween(t,i.ref),o=s.Utils.getHighestElement(t,i.ref),u=t===o?n:i.compatibleSizes,a=s.Utils.getMaxWrapSize(u),c=s.Utils.getWrappingOffset(t,i.ref,r,a);return e+("INSIDE"===i.targetElementPosition?0:o.getBoundingClientRect().height)+c<=b.SpotsUtils.getBrowsiAdsStayAwayDistance(r)}))?{status:"invalid",message:"stay_away_from_browsi"}:{status:"valid"}}return{status:"valid"}},t.prototype.isInsideSkippedRef=function(t,i){var n,r;if("INSIDE"===b.SpotsUtils.getTargetElementPosition(i)){var e=null===(r=null===(n=this.profile)||void 0===n?void 0:n.domData)||void 0===r?void 0:r.skippedElements;return e&&e.includes(t)?{status:"invalid",message:"skipped element"}:{status:"valid"}}return{status:"valid"}},t.prototype.getSpotsByColumn=function(t,i){var n=t.filter((function(t){return t.type===i}));switch(i){case d.SpotType.DYNAMIC_LEFT_RAIL:n=n.concat(this.getSpotsByType(d.SpotType.FIXED_LEFT_RAIL));break;case d.SpotType.DYNAMIC_RIGHT_RAIL:n=n.concat(this.getSpotsByType(d.SpotType.FIXED_RIGHT_RAIL));break;case d.SpotType.DYNAMIC_MC:n=n.concat(this.getSpotsByType(d.SpotType.FIXED_MC))}return n},t.prototype.hasFoundSpots=function(t){return!!(t.length>0||this.getAvailableSpots().length>0)},t.prototype.isAboveStartInFold=function(t,i){var n=s.Utils.getElementFoldNumber(t);return i&&n<i?{status:"invalid",message:"above startIF("+n+")"}:(this.firstScannedElement||(this.firstScannedElement=t),{status:"valid"})},t.prototype.getStartInFold=function(t){if(!t)return 0;if(t.startInFoldSelectors){var i=document.querySelector(t.startInFoldSelectors.join(","));if(i)return s.Utils.getElementFoldNumber(i)+.05}return t.startInFold?t.startInFold:0},t.prototype.isStopInFoldViolated=function(t,i){var n=s.Utils.getElementFoldNumber(t);if(i&&i>0)if(i===Math.floor(i)){if(Math.floor(n)>i)return!0}else if(n>i)return!0;return!1},t.prototype.getNextParagraphsTotalHeight=function(t,i,n,r){var e=0,o=s.Utils.getMaxWrapSize(n),u=0;if(!o)return e;for(;t&&e<o.h&&(!s.Utils.isElement(t)||"valid"===this.isSkippedElement(t).status&&"valid"===f.default.instance.isStayAwayElement(t,!0,d.SpotType.DYNAMIC_MC).status);){if(s.Utils.isElement(t)){if(["auto","hidden","overlay","scroll"].includes(getComputedStyle(t).overflow||""))return this.logger.debug("Stopped height calc. overflow: "+getComputedStyle(t).overflow+". current height: "+e,t),e;!s.Utils.isVisible(t)&&e>0&&t.nextSibling&&(t=t.nextSibling)}switch(t.nodeName){case"BR":break;case"P":if(this.hasNonWrappingChildren(t))return e;s.Utils.isEmptyParagraph(t)?u+=t.getBoundingClientRect().height:(e+=t.getBoundingClientRect().height+u,u=0);break;case"#text":t.nodeValue&&t.nodeValue.length>1?(e+=s.Utils.calculateTextNodeHeight(t)+u,u=0):u+=s.Utils.calculateTextNodeHeight(t);break;default:if(i.includes(t.nodeName)&&!this.hasNonWrappingChildren(t)){e+=t.getBoundingClientRect().height+u,u=0;break}return e}var a=n.find((function(t){return t.h>=e}))||o;r.push({el:t,minWrapSize:a}),t=t.nextSibling}return e},t.prototype.hasNonWrappingChildren=function(t){var i=t.querySelector("img, iframe");return!!i&&(this.logger.info("stopping height calc because "+t.nodeName+" element has special child: ",i),!0)},t.prototype.getCompatibleAdsSizes=function(t,i,n,r,e){var o=s.Utils.getExternalFlowHandler("compatibleAdSizes");if(o){var u=o(t,i,n,r,a.EmbedTypeMap);if(u)return u}var c=[];if(!this.profile.domData&&!e)return c;for(var h=n===d.SpotType.DYNAMIC_MC&&this.isAfterOneLine(t),f=t.getBoundingClientRect().height,l=0,v=r;l<v.length;l++){var p=v[l],m=n===d.SpotType.DYNAMIC_MC?p.optionalEmbeddings.indexOf("wrapped"):-1;if(m>-1?this.isSizeValidForWrapping(i,f,p)||(this.logger.debug(p+" is invalid for wrap. height "+f+", available"+i),p.optionalEmbeddings.splice(m,1)):(b.SpotsUtils.isFixedSpot(n)||b.DYNAMIC_RAIL_TYPES.includes(n))&&(p.selectedEmbedding="break"),h){var w=p.optionalEmbeddings.indexOf("break");w>-1&&(p.optionalEmbeddings.splice(w,1),this.logger.debug(t,"is after one liner, only wrap allowed"))}p.optionalEmbeddings.length&&c.push(p)}return c},t.prototype.getStickyCompatibleAdsSizes=function(){for(var t,i=[],n=0,r=(null===(t=b.SpotsUtils.getConf(d.SPOT_TAGS_MAP[d.SpotType.STICKY]))||void 0===t?void 0:t.allowedCreativeSizes)||[];n<r.length;n++){var e=r[n];if(s.Utils.isValidStickySize(e)){var o={w:e.w,h:e.h,selectedEmbedding:"break",optionalEmbeddings:[],adSizeType:"wide",minSizeForWrapping:-1};i.push(o)}}return i},t.prototype.isSizeValidForWrapping=function(t,i,n){return i>=n.minSizeForWrapping&&t>0||t>=n.minSizeForWrapping},t.prototype.buildSpotEngineTest=function(){if(this.lastScannedElement&&this.firstScannedElement){var t=s.Utils.getElementFoldNumber(this.lastScannedElement),i=s.Utils.getElementFoldNumber(this.firstScannedElement);this.profile.spotEngineTest={firstElementFold:i,lastElementFold:t,spots:this.mapSpotEngineTestSpots(this.availableSpots)}}else this.profile.spotEngineTest={spots:this.mapSpotEngineTestSpots(this.availableSpots)}},t.prototype.mapSpotEngineTestSpots=function(t){var i=[];return t.forEach((function(t){return i[t.adIndex]=t.serialize()})),i},t.prototype.validateSpot=function(t,i,n,r,e){var s=!this.shouldIgnoreStartInFold(r.oldType)&&this.isAboveStartInFold(t,i).message||this.endlessRailsInvalid(t,r.oldType).message||(n?this.isInsideSkippedRef(t,r).message:this.isSkippedElement(t).message||this.isEmptyParagraph(t).message||(b.SpotsUtils.isRailSpot(r.oldType)?null:this.isElementWithFloatSibling(t).message||this.isBetweenTitleAndContent(t).message)),o=s?{status:"invalid",message:s}:{status:"valid"};return"invalid"===o.status&&this.logger.debug("invalid spot ["+o.message+"]:",t),o},t.prototype.endlessRailsInvalid=function(t,i){return this.endlessRails.top&&b.SpotsUtils.getRailsTypes().includes(i)&&s.Utils.getElementCoordinates(t).top<this.endlessRails.top?{status:"invalid",message:"above dcs element"}:{status:"valid"}},t.prototype.shouldIgnoreStartInFold=function(t){return e([d.SpotType.FIXED_TOP,d.SpotType.FIXED_BOTTOM],b.SpotsUtils.getRailsTypes()).includes(t)},t.prototype.isEmptyParagraph=function(t){return s.Utils.isEmptyParagraph(t)?{status:"invalid",message:"empty"}:{status:"valid"}},t.prototype.isCompSizeBiggerThanParentSize=function(t,i){var n=!1;if(i.parentElement){var r=s.Utils.getElementSize(i.parentElement);r&&t.w>r.w&&(n=!0)}return n},t.prototype.validateStayAway=function(t,i,n,r,e){var s=f.default.instance.isStayAwayForAllEmbedTypes(t,n,r,e.oldType),o=("valid"===s.status?this.isBrowsiStayAway(t,i,n,e):null)||s;if("invalid"===o.status){var u=o.element?{element:t,stayAwayElement:s.element}:"";this.logger.debug("invalid spot ["+o.message+"]",u)}return o},t.prototype.isElementWithFloatSibling=function(t){return this.profile.domData&&this.profile.domData.foundFloatElements.includes(t)?{status:"invalid",message:"element with float sibling"}:{status:"valid"}},t.prototype.isBetweenTitleAndContent=function(t){return this.profile.spotEngineConfig.pageLayoutSA&&v.default.get().isBetweenTitleAndContent(t)?{status:"invalid",message:"element is between title and content"}:{status:"valid"}},t.prototype.isAfterOneLine=function(t){return!!this.profile.spotEngineConfig.pageLayoutSA&&v.default.get().isAfterOneLiner(t)},t.prototype.isStickyApiIdsConfigured=function(){var t=b.SpotsUtils.getConf({typeTag:g.TypeTag.API,positionTag:"s",oldType:d.SpotType.API});return!(!t||!t.positionIds)},t.prototype.getAvailableSpots=function(){return this.availableSpots.concat(this.firstScanSpots)},t.prototype.getApiSpots=function(){return this.apiSpots},t.prototype.getDcsSerializedSpot=function(t){return r(r({browsiAd:t.browsiAd,slot:t.slot},t.selectedSize?{selectedSize:t.selectedSize}:{}),{adIndex:t.adIndex,demandIndex:t.demandIndex,type:t.type,ref:t.ref,compatibleSizes:t.compatibleSizes,positionTypes:t.positionTypes,spotTags:t.tags})},t.prototype.handleSpotsFromPreviousPageview=function(){var t=this,i=p.DcsUtils.getWindowObject(),n=i&&i.spots;n&&n.length&&n.forEach((function(i){t.refreshSpotFromPreviousPv(i)}))},t.prototype.refreshSpotFromPreviousPv=function(t){this.generateSpotFromSerialized(t).refreshDcsSpotOnNewPv()},t.prototype.generateSpotFromSerialized=function(t){var i;if("s"===t.spotTags.positionTag)i=new O.StickySpot(t.compatibleSizes,!0);else if(t.spotTags.typeTag===g.TypeTag.FIXED){var n=this.getSelectorByElement(t.ref);i=new y.FixedSpot(t.ref,t.demandIndex,t.compatibleSizes,-1,t.type,!0,n)}else i=new _.DynamicSpot(t.ref,t.type,t.demandIndex,t.compatibleSizes,-1,!0);return i.isLazyLoading=!1,i=Object.assign(i,t),this.logger.info("Found "+i.type+" spot from previous page view: ",i),u.EventsService.get().sendSpotFoundEvent(i),this.availableSpots.push(i),this.spotsFromPreviousPageview.push(i),i},t.prototype.getRightRailsSpotsFound=function(){return this.getSpotsByType(d.SpotType.DYNAMIC_RIGHT_RAIL).concat(this.getSpotsByType(d.SpotType.FIXED_RIGHT_RAIL))},t.prototype.getLeftRailsSpotsFound=function(){return this.getSpotsByType(d.SpotType.DYNAMIC_LEFT_RAIL).concat(this.getSpotsByType(d.SpotType.FIXED_LEFT_RAIL))},t.prototype.getSpotsByType=function(t){return this.availableSpots.filter((function(i){return i.type===t})).concat(this.firstScanSpots.filter((function(i){return i.type===t})))},t.prototype.getFoundSpots=function(){return{fixedFirst:this.firstScanSpots,availableSpots:this.availableSpots}},t.prototype.isPositionInsideAndNotEmpty=function(t,i){var n=this;return"INSIDE"===t.targetElementPosition&&Array.from(i.childNodes).filter((function(t){return n.isExpandableElement(t)})).length>0},t.prototype.isExpandableElement=function(t){return s.Utils.isElement(t)&&!(t instanceof HTMLScriptElement)},t.prototype.getFixedElementsBySelector=function(t){var i=this;this.fixedSelectorsToElementsMap=this.fixedSelectorsToElementsMap||{},t.forEach((function(t){i.fixedSelectorsToElementsMap[t]=s.Utils.querySelectorAll([t],(function(){}))}))},t.prototype.getSelectorByElement=function(t){for(var i in this.fixedSelectorsToElementsMap)if(this.fixedSelectorsToElementsMap[i].some((function(i){return i===t})))return i;return""},t}();i.default=N},4029:(t,i,n)=>{"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=n(125),e=n(7730),s=n(1993),o=function(){function t(){this.logger=new r.Logger("activeViewViewability"),this.isActive=!!e.Profiler.get().siteInfo.activeView}return t.get=function(){return t.instance||(this.instance=new t),t.instance},t.prototype.waitForPublisherAV=function(t,i){if(this.isActive){var n=i.refreshCount;window.googletag.pubads().addEventListener("impressionViewable",(function(r){r.slot==t&&n===i.refreshCount&&s.EventsService.get().sendViewedPublisherAdAV(i)}))}},t.prototype.waitForBrowsiAV=function(t,i){this.isActive&&i.browsiAd.win.googletag.pubads().addEventListener("impressionViewable",(function(n){n.slot==t&&s.EventsService.get().sendViewedImpressionAV(i)}))},t}();i.default=o},2057:(t,i,n)=>{"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=n(125),e=n(2727),s=function(){function t(){this.logger=new r.Logger("BptBrowsiFunctions"),this.bptBrowsiFunctions=t.getBptBrowsiService()}return t.get=function(){return this._instance||(this._instance=new t),this._instance},t.getBptBrowsiService=function(){var t=e.Utils.getBrowsiTag();return t&&"object"==typeof t.__bbs?t.__bbs:null},t.prototype.getFoundPublisherAdData=function(t,i,n,r){var e={plid:i};switch(t){case"dfp":case"header_bidding":if(r)return this.invokeBptFunction({p:"dfp",args:{slot:r,rc:n}})||e;break;case"manual_ad":return this.invokeBptFunction({p:"manual_ad",args:{plid:i,rc:n}})||e}return e},t.prototype.invokeBptFunction=function(t){if(this.bptBrowsiFunctions&&"function"==typeof this.bptBrowsiFunctions.g_fpa_d)try{var i=this.bptBrowsiFunctions.g_fpa_d(t);return i.praw=parseFloat(i.praw),this.logger.info("request: ",t," response: ",i),i}catch(i){this.logger.info("failed to get data from bpt",t)}return null},t}();i.default=s},3006:(t,i,n)=>{"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.ConsentLocation=i.ConsentType=void 0;var r=n(2727),e=n(7730);!function(t){t.GDPR="gdpr",t.CCPA="ccpa"}(i.ConsentType||(i.ConsentType={})),function(t){t.EUROPE="eu",t.USA="us",t.REST_OF_WORLD="row",t.NA="NA"}(i.ConsentLocation||(i.ConsentLocation={}));var s=function(){function t(){}return Object.defineProperty(t,"hasUserConsent",{get:function(){return this.updateConsentStatus(),this.hasConsent},enumerable:!1,configurable:!0}),Object.defineProperty(t,"location",{get:function(){return"string"!=typeof this._location&&null!==this._location&&(this._location=e.Profiler.get().userAnonymousContinent||null),this._location},enumerable:!1,configurable:!0}),t.updateConsentStatus=function(){var t=this.getCurrentConsentType();this.hasConsent=!t||this.getConsentStatus(t)},t.getConsentStatus=function(t){var i=r.Utils.getBrowsiTag();return i&&i.__cs&&"function"==typeof i.__cs[t]?i.__cs[t]():this.hasConsent},Object.defineProperty(t,"prebidConf",{get:function(){var t=null;return"eu"===this.location?t={gdpr:{cmpApi:"iab",allowAuctionWithoutConsent:!0,timeout:1e3}}:"us"===this.location&&(t={usp:{cmpApi:"iab",timeout:1e3}}),t?{consentManagement:t}:null},enumerable:!1,configurable:!0}),t.getCurrentConsentType=function(){if(this.location){if("eu"===this.location)return"gdpr";if("us"===this.location)return"ccpa"}return null},t}();i.default=s},3063:function(t,i,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(t){for(var i,n=1,r=arguments.length;n<r;n++)for(var e in i=arguments[n])Object.prototype.hasOwnProperty.call(i,e)&&(t[e]=i[e]);return t},r.apply(this,arguments)};Object.defineProperty(i,"__esModule",{value:!0}),i.DCS=void 0;var e=n(7730),s=n(125),o=n(2727),u=n(514),a=n(9790),c=n(905),h=n(8614),f=n(9235),d=n(6319),l=n(1993),v=n(2970),p=n(5310),m=n(7631),w=n(1128),b=n(4869),g=n(2362),_=n(1031),y=function(){function t(t){this.dcsObj=d.DcsUtils.getWindowObject(),this.contextElement=top.document.body,this.steps=[],this.dataFromLastStep=null,this.observers=[],this.listeners=[],this.checkUrlInterval=0,this.timeoutBeforeNewRun=0,this.type=t,this.logger=new s.Logger("DCS_"+this.type),d.DcsUtils.dcsType=this.type,this.mutationConfig={childList:!0,subtree:!0},this.currentURL=window.location&&window.location.href.split("?")[0],this.dcsObj&&this.updateNewPv(this.dcsObj),this.logger.info("Started "+this.type,this.dcsObj?"Object: "+this.dcsObj:"")}return t.prototype.detectDcs=function(t,i){var n=this;return void 0===i&&(i=!1),(i?Promise.race([this.checkUrl(),this.checkSteps(0,t)]):this.checkSteps(0,t)).then((function(){n.handleStepsEnded(n.dataFromLastStep)})).catch((function(t){n.clearDcsListeners(),n.logger.error(t)})),Promise.resolve()},t.prototype.detectUrlChangeOnly=function(){var t=this;return this.checkUrl().then((function(){return t.handleStepsEnded(t.dataFromLastStep)}))},t.prototype.checkUrl=function(){return this.checkStep(-1,{type:"urlChange",value:""})},t.prototype.checkSteps=function(t,i,n){var r=this;return i.length&&i[t]?this.checkStep(t,i[t],n).then((function(n){return r.checkSteps(++t,i,n)})):Promise.resolve()},t.prototype.checkStep=function(t,i,n){var r=this;return this.logger.debug("checking step",t),"function"==typeof i?i()?Promise.resolve():Promise.reject("step function failed"):this.listenToEventOrMutation(i,n).then((function(t){if(t)return r.dataFromLastStep=t,t;r.logger.info("listenToEventOrMutation ended",t,r.dataFromLastStep)}))},t.prototype.listenToEventOrMutation=function(t,i){var n=this;if(t.container)return this.watch(t);var r=t;return r.elements=i?[i]:r.elements,this.waitForTrigger(r).then((function(t){return n.logger.info("trigger caught",t),t}))},t.prototype.watch=function(t){var i=this;return this.logger.info("watching for "+t.article+" in "+t.container),new Promise((function(n,r){var e=[],s=i.getElement(t.container);if(!s)return r("no elements found for selector: "+t.container);var o=new MutationObserver((function(r){i.mutationHandler(r,t,e,n)}));i.observers.push(o),o.observe(s,i.mutationConfig)}))},t.prototype.waitForTrigger=function(t){var i=this;switch(this.logger.info("waiting for trigger "+t.type+" of "+t.value,t.elements),t.type){case"distance":return this.distanceTrigger(t);case"buttonClick":return t.value?this.buttonClickTrigger(t):Promise.reject("no selectors");case"urlChange":return this.urlChangeTrigger().then((function(t){return i.logger.info("urlChanged",t),t}));default:return Promise.reject("no type")}},t.prototype.mutationHandler=function(t,i,n,r){var e=this;t.forEach((function(t){for(var s=0;s<t.addedNodes.length;s++){var o=t.addedNodes[s];if(o instanceof Element){if(e.matches(o,i.article))return e.handleNewArticle(o,n,r);var u=o.querySelector(i.article);if(u)return e.handleNewArticle(u,n,r)}}}))},t.prototype.handleNewArticle=function(t,i,n){return this.logger.info("New Articles detected!",t),i.push(t),n(t)},t.prototype.distanceTrigger=function(t){var i=this;return new Promise((function(n,r){t.elements&&t.elements[0]?i.addListener("scroll",o.Utils.getScrollElement(),o.Utils.throttle((function(){return i.distanceHandler(t,n)}),500)):r()}))},t.prototype.distanceHandler=function(t,i){if(t.elements&&t.elements[0]){var n=t.elements[0],r=o.Utils.getPercentageInView(n);if(r>+t.value)return this.logger.info("element in view: ",r,n),i(n)}},t.prototype.buttonClickTrigger=function(t){var i=this;return new Promise((function(n,r){var e=document.querySelectorAll(t.value);if(e.length)for(var s=0;s<e.length;s++){var o=e[s];i.addListener("click",o,(function(){n()}))}else r("no elements found for selector: "+t.value)}))},t.prototype.urlChangeTrigger=function(){var t=this;return new Promise((function(i,n){return t.hasUrlChanged()?i():(t.addListener("hashchange",window,(function(){return i})),t.addListener("popstate",window,(function(){return i})),t.addListener("locationchange",window,(function(){return i})),t.checkUrlInterval=window.setInterval((function(){t.hasUrlChanged()&&(clearInterval(t.checkUrlInterval),i())}),1e3),t.hasUrlChanged()?i():void 0)}))},t.prototype.setWindowObject=function(t,i){var n=this.createPvObject(t),r=d.DcsUtils.getWindowObject()||this.createDcsObject();return r.count++,r.pvs.push(n),i&&Object.assign(r.ppv,{e:i}),r},t.prototype.createDcsObject=function(){var t={count:0,dcsType:this.type,pvs:[],ppv:{pv:e.Profiler.get().identity.pageviewId}};return window[d.DcsUtils.winObjName]=t,t},t.prototype.createPvObject=function(t){var i=m.PubAdsRefreshService.get();return{pv:void 0,e:t,data:r(r({},"end_less"===this.type||"slides"===this.type?{sAE:f.default.instance.getStayAwayElementsList().filter((function(i){return o.Utils.isPositionedAfter(i.element,t)}))}:{}),{pad:i?i.pubAdsData:[]})}},t.prototype.updateNewPv=function(t){t.pvs[t.count-1].pv=e.Profiler.get().identity.pageviewId},t.prototype.handleStepsEnded=function(t){this.logger.info("handleStepsEnded"),this.dcsSuccessActions(t)},t.prototype.dcsSuccessActions=function(t){var i=this;this.clearListeners(),this.timeoutBeforeNewRun?setTimeout((function(){i.runNewPv()}),this.timeoutBeforeNewRun):this.runNewPv();var n=this.setWindowObject(t,this.firstArticle);this.keepSpotsReference(),this.sendDcsEvent(this.eventType,{ac:n.count,ppvid:n.ppv.pv})},t.prototype.runNewPv=function(){this.logger.info("runNewPv"),window.browsi_bootstrap_loaded=!1,window._middyo=null,this.logger.info("injecting bootstrap");var t=o.Utils.cloneAndEmbedBoostrap();t&&t.parentElement&&t.parentElement.removeChild(t)},t.prototype.clearListeners=function(){u.default.get().removeAll(),this.observers.forEach((function(t){return t.disconnect()})),a.default.setInactive(),c.EngagementService.unsubscribeIfNeeded(),_.Engagement.get().unsubscribe(),h.Focus.get().unsubscribe(),clearInterval(this.checkUrlInterval),p.default.get().stopService(!0);var t=m.PubAdsRefreshService.get();t&&t.deactivate()},t.prototype.sendDcsEvent=function(t,i){l.EventsService.get().sendDcs(t,i)},t.prototype.matches=function(t,i){return t.matches?t.matches(i):t.msMatchesSelector?t.msMatchesSelector(i):!t.webkitMatchesSelector||t.webkitMatchesSelector(i)},t.prototype.getElement=function(t){return this.contextElement.querySelector(t)},t.prototype.getElements=function(t){return Array.from(this.contextElement.querySelectorAll(t))},t.prototype.getPreviousElements=function(){var t=d.DcsUtils.getWindowObject();return t?t.pvs.map((function(t){return t.e})):null},t.prototype.hasUrlChanged=function(){var t=window.location&&window.location.href.split("?")[0];return!t||this.currentURL!==t},t.prototype.addListener=function(t,i,n){this.listeners.push({type:t,listenObj:i,callback:n}),u.default.get().listen(t,i,n)},t.prototype.clearDcsListeners=function(){this.listeners.forEach((function(t){u.default.get().removeListener(t.type,t.listenObj,t.callback)}))},t.prototype.setSpots=function(t){this.spots=t},t.prototype.RemoveBrowsiAdsFromDom=function(){var t=v.default.instance.getAvailableSpots();(t=t.concat(v.default.instance.getApiSpots())).forEach(this.removeSpot.bind(this))},t.prototype.removeSpot=function(t){t.destroySlot()||this.logger.debug("could not destroy slot",t);var i=g.Embedder.removeAdFromDom(t);this.logger.debug("Spot removed from DOM",i,t)},t.prototype.keepSpotsReference=function(){var t=d.DcsUtils.getWindowObject();if(t){var i=v.default.instance.getSpotsByType(w.SpotType.STICKY),n=v.default.instance.getLeftRailsSpotsFound().concat(v.default.instance.getRightRailsSpotsFound()).filter((function(t){if(t.browsiAd&&t.browsiAd.wrapper){var i=t.browsiAd.wrapper;return b.ViewabilityService.get().inViewPercentage({getCoords:function(){return o.Utils.getElementPosition(i)},getHeight:function(){return o.Utils.getElementSize(i).h}})>=100}return!1})),r=i.concat(n);if(r.length&&t){var e=[];r.forEach((function(t){e.push(v.default.instance.getDcsSerializedSpot(t))})),t.spots=e}}},t}();i.DCS=y},4941:(t,i,n)=>{"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.DcsApi=void 0;var r=n(7730),e=n(2970),s=n(125),o=n(2362),u=n(1993),a=n(514),c=n(9790),h=n(905),f=n(8614),d=n(5310),l=n(7631),v=n(2727),p=n(4869),m=n(6319),w="browsiDcs",b=function(){function t(t,i){this.logger=new s.Logger("dcsAPI"),this.logger.info("started"),this.injectScriptAndDispatchEvent(i,t)}return t.prototype.injectScriptAndDispatchEvent=function(t,i){var n=this;this.injectDcsScript(t,(function(){n.logger.info("event fired"),window.dispatchEvent(new CustomEvent("dcsAPI",{detail:n.api(i)}))}))},t.prototype.api=function(t){var i=this;return{getSpotsMap:function(){var t=i.mapSpots();return i.logger.debug("getSpotsMap "+i.getPv(),t),t},removeSpots:function(t){var n=t.map(i.removeSpot.bind(i)).every(Boolean);return i.logger.debug("removeSpots "+i.getPv(),n),n},refreshSpots:function(t){var n=i.refreshSpot(t);return i.logger.debug("refreshedSpots "+i.getPv(),n),n},injectEngine:function(){return i.logger.debug("InjectEngine "+i.getPv()),i.runNewPv()},rebuildProfile:function(n){return v.Utils.mergeDeep(t,n),i.logger.debug("rebuildProfile "+i.getPv(),n,t),r.Profiler.rebuild(t),t},getSaObjects:function(t){return m.DcsUtils.getSaObjects(t)},clearListeners:function(){return i.clearListeners()},reportError:function(t){u.EventsService.get().sendErrorEvent("crash",t.filename,t.message)},pageViewId:r.Profiler.get().identity.pageviewId}},t.prototype.injectDcsScript=function(t,i){if(!window.document.querySelector("#browsiDcs")){this.logger.info("Injecting Browsi Dcs Script");var n=window.document.createElement("script");return n.async=!0,n.setAttribute("crossorigin","anonymous"),n.setAttribute("src",t),n.id=w,n.onload=i,n.addEventListener("error",(function(){u.EventsService.get().sendErrorEvent("script_load_error",t,"DcsScript")})),window.document.head.appendChild(n),n}i()},t.prototype.getPv=function(){return r.Profiler.get().identity.pageviewId},t.prototype.getSpots=function(){var t=e.default.instance.getApiSpots();return e.default.instance.getAvailableSpots().concat(t)},t.prototype.mapSpots=function(){var t=this.getSpots(),i={};return t.forEach((function(t){var n=e.default.instance.getDcsSerializedSpot(t),r=i[t.tags.positionTag];r?r.push(n):i[t.tags.positionTag]=[n]})),i},t.prototype.removeSpot=function(t){var i=this.getSpots().find((function(i){return i.ref===t.ref}));i&&(i.destroySlot(),p.ViewabilityService.get().unsubscribe(i));var n=o.Embedder.removeAdFromDom(t);return this.logger.debug("Spot "+(n?"":"not")+" removed from DOM",t),n},t.prototype.refreshSpot=function(t){var i=t.map(e.default.instance.generateSpotFromSerialized);return i.forEach((function(t){return t.refreshDcsSpotOnNewPv()})),i},t.prototype.clearListeners=function(){a.default.get().removeAll(),c.default.setInactive(),h.EngagementService.unsubscribeIfNeeded(),f.Focus.get().unsubscribe(),d.default.get().stopService(!0);var t=l.PubAdsRefreshService.get();t&&t.deactivate()},t.prototype.runNewPv=function(){this.logger.info("runNewPv"),window.browsi_bootstrap_loaded=!1,window._middyo=null,this.logger.info("injecting bootstrap");var t=v.Utils.cloneAndEmbedBoostrap();t&&t.parentElement&&t.parentElement.removeChild(t),this.sendDcsEvent()},t.prototype.sendDcsEvent=function(t){u.EventsService.get().sendDcs("dcs_script",t)},t}();i.DcsApi=b},2713:function(t,i,n){"use strict";var r,e=this&&this.__extends||(r=function(t,i){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])},r(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)});Object.defineProperty(i,"__esModule",{value:!0}),i.DcsEndless=void 0;var s=n(3063),o=n(6319),u=function(t){function i(i,n){var r=t.call(this,"end_less")||this;return r.eventType="dcs_endlessScroll",r.checkUrlChanges=!1,r.steps=i,r.checkUrlChanges=n.urlChange||r.checkUrlChanges,r.timeoutBeforeNewRun=n.delay,r}return e(i,t),i.prototype.prepareAndRunDcs=function(){var t=this,i=this.steps[0],n=this.steps[1],r=this.findUnhandledArticles(i);return r.shift(),r.forEach((function(i){t.logger.info("Handling unhandled",i);var r=Object.assign(n,{elements:[i]});t.checkStep(-1,r).then((function(){return t.logger.info("Unhandled element reached distance",r),t.handleStepsEnded(i)}))})),this.detectDcs(this.steps,this.checkUrlChanges),Promise.resolve()},i.prototype.findUnhandledArticles=function(t){var i=o.DcsUtils.getHandledArticles(this.dcsObj),n=[];return Array.from(document.querySelectorAll(t.container)).forEach((function(r){var e=Array.from(r.querySelectorAll(t.article));n.push.apply(n,e.filter((function(t){return!i.includes(t)})))})),n},i}(s.DCS);i.DcsEndless=u},7247:(t,i,n)=>{"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.DcsFactory=void 0;var r=n(2713),e=n(4824),s=n(6504),o=n(7286),u=function(){function t(){}return t.buildDcs=function(t){var i=t.spotEngineConfig.dcs;if(i&&i.steps)switch(i.type){case"read_more":return this.buildReadMore(i);case"end_less":return this.buildEndless(i);case"gallery":return this.buildGallery(i);case"spa":return this.buildSpa(i);default:return}},t.buildEndless=function(t){var i=t.steps[0],n=t.steps.find((function(t){return"distance"===t.type})),e=t.steps.find((function(t){return"url"===t.type}));if(i&&i.elementSelector&&i.containerSelector&&n&&n.value){var s=[{article:i.elementSelector.join(","),container:i.containerSelector.join(",")},{type:"distance",value:n.value}];return e&&"true"===e.value&&s.push({type:"urlChange",value:""}),new r.DcsEndless(s,t)}},t.buildReadMore=function(t){if(1===t.steps.length){var i=t.steps[0].elementSelector;return i?new e.DcsReadMore(i):void 0}},t.buildGallery=function(t){var i=t.steps.find((function(t){return"button"===t.type})),n=t.steps.find((function(t){return"selector"===t.type})),r=t.steps.find((function(t){return"url"===t.type}));if(i&&i.elementSelector){var e=[{type:"buttonClick",value:i.elementSelector.join(",")}];return r&&r.value&&e.push({type:"urlChange",value:""}),new s.DcsGallery(e,n&&n.elementSelector||[],t)}},t.buildSpa=function(t){var i=t.steps[0],n=t.steps.find((function(t){return"url"===t.type}));if(i&&i.elementSelector&&i.containerSelector){var r=[{article:i.elementSelector.join(","),container:i.containerSelector.join(",")}];return n&&n.value&&r.push({type:"urlChange",value:""}),new o.DcsSpa(r,t)}},t}();i.DcsFactory=u},6504:function(t,i,n){"use strict";var r,e=this&&this.__extends||(r=function(t,i){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])},r(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)});Object.defineProperty(i,"__esModule",{value:!0}),i.DcsGallery=void 0;var s=function(t){function i(i,n,r){var e=t.call(this,"gallery")||this;return e.eventType="dcs_gallery",e.checkUrlChanges=!1,e.articleSelectors=[],e.steps=i,e.articleSelectors=n||[],e.checkUrlChanges=r.urlChange||e.checkUrlChanges,e.timeoutBeforeNewRun=r.delay,e}return e(i,t),i.prototype.prepareAndRunDcs=function(){return this.dcsObj||(this.firstArticle=this.getArticleElement()),this.detectDcs(this.steps,this.checkUrlChanges)},i.prototype.handleStepsEnded=function(t){this.logger.info("handleStepsEnded");var i=this.getArticleElement()||t;this.RemoveBrowsiAdsFromDom(),this.dcsSuccessActions(i)},i.prototype.getArticleElement=function(){if(this.articleSelectors.length){var t=this.getElement(this.articleSelectors.join(","));if(t)return t}},i}(n(3063).DCS);i.DcsGallery=s},4824:function(t,i,n){"use strict";var r,e=this&&this.__extends||(r=function(t,i){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])},r(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)});Object.defineProperty(i,"__esModule",{value:!0}),i.DcsReadMore=void 0;var s=n(3063),o=n(2727),u=n(514),a=n(1993),c=n(6319),h=n(2970),f=n(1128),d=n(3034),l=function(t){function i(i){var n=t.call(this,"read_more")||this;return n.eventType="dcs_readMore",n.checkUrlChanges=!1,n.mutationConfig={},n.clickDetected=!1,n.selectors=i,n.elements=[],n}return e(i,t),i.prototype.prepareAndRunDcs=function(){var t=this;if(h.default.instance.scanBeforeDcs(),this.elements=o.Utils.querySelectorAll(this.selectors,(function(){})),this.elements.length){c.DcsUtils.isDcs=!0;var i=h.default.instance.spotsBeforeDcs,n=i.filter((function(t){return t.type===f.SpotType.FIXED_TOP||t.type===f.SpotType.FIXED_BOTTOM})).length,r=i.filter((function(t){return t.type===f.SpotType.DYNAMIC_RIGHT_RAIL||t.type===f.SpotType.FIXED_RIGHT_RAIL})).length,e=i.filter((function(t){return t.type===f.SpotType.DYNAMIC_LEFT_RAIL||t.type===f.SpotType.FIXED_LEFT_RAIL})).length;return a.EventsService.get().sendPageviewEvent(-1,-1,h.default.instance.getSpotsByType(f.SpotType.STICKY).length,n,r,e),this.buttonClickTrigger().then((function(){return t.handleStepsEnded(),t.onSpotEngineComplete.bind(t)}))}return Promise.reject("no elements found for selector: "+this.selectors)},i.prototype.buttonClickTrigger=function(){var t=this;return new Promise((function(i){var n=function(){t.clickDetected||(t.clickDetected=!0,t.elements.forEach((function(t){u.default.get().removeListener("click",t,n)})),setTimeout((function(){d.SpotsUtils.updateMCSpotsElements(),i()}),1e3))};t.elements.forEach((function(i){t.addListener("click",i,n)}))}))},i.prototype.handleStepsEnded=function(){this.logger.info("handleStepsEnded"),c.DcsUtils.isDcs=!0},i.prototype.onSpotEngineComplete=function(t){var i=t.getSpotsByType(f.SpotType.FIXED_BOTTOM).length+t.getSpotsByType(f.SpotType.FIXED_TOP).length,n={sf:t.getSpotsByType(f.SpotType.DYNAMIC_MC).length,fsf:t.getSpotsByType(f.SpotType.FIXED_MC).length,rrsf:t.getRightRailsSpotsFound().length,lrsf:t.getLeftRailsSpotsFound().length,ftbsf:i};this.sendDcsEvent(this.eventType,n)},i}(s.DCS);i.DcsReadMore=l},7286:function(t,i,n){"use strict";var r,e=this&&this.__extends||(r=function(t,i){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])},r(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)});Object.defineProperty(i,"__esModule",{value:!0}),i.DcsSpa=void 0;var s=function(t){function i(i,n){var r=t.call(this,"spa")||this;return r.eventType="dcs_spa",r.checkUrlChanges=!1,r.steps=i,r.checkUrlChanges=n.urlChange||r.checkUrlChanges,r.timeoutBeforeNewRun=n.delay,r}return e(i,t),i.prototype.prepareAndRunDcs=function(){return this.detectDcs(this.steps,this.checkUrlChanges)},i.prototype.handleStepsEnded=function(t){this.logger.info("handleStepsEnded"),this.RemoveBrowsiAdsFromDom(),this.dcsSuccessActions(t)},i}(n(3063).DCS);i.DcsSpa=s},6319:(t,i,n)=>{"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.DcsUtils=void 0;var r=n(7730),e=n(9235),s=n(2727),o=function(){function t(){}return Object.defineProperty(t,"dcsElement",{get:function(){return t.getCurrentDcsElement()},enumerable:!1,configurable:!0}),t.getWindowObject=function(){return window[this.winObjName]},t.getDcsType=function(){if(r.Profiler.get().dcsState)return"script";var t=this.getWindowObject();return t&&t.dcsType},t.getIfEndless=function(){return"end_less"===this.getDcsType()?this.getWindowObject():void 0},t.getCurrentPvsObject=function(){var t=this.getWindowObject();return t&&t.pvs[t.count-1]},t.getCurrentDcsElement=function(){var t,i=null===(t=r.Profiler.get().dcsState)||void 0===t?void 0:t.mainContentElement;if(i)return i;var n=this.getDcsActionCounter(),e=this.getWindowObject();return e&&e[n]?e.pvs[n].e:null},t.getDcsActionCounter=function(){var t,i=null===(t=r.Profiler.get().dcsState)||void 0===t?void 0:t.count,n=this.getWindowObject(),e=i||(n?n.count:null);return e&&e>0?e:0},t.getHandledArticles=function(t){var i=[];return t&&(t.ppv.e&&i.push(t.ppv.e),t.pvs.forEach((function(t){i.push(t.e)}))),i},t.getDemandDcsSuffix=function(){var t=this.getDcsActionCounter();return t?"_d_"+t:""},t.getSaObjects=function(t){return e.default.instance.getStayAwayElementsList().filter((function(i){return s.Utils.isPositionedBefore(t,i.element)}))},t.winObjName="__dcs",t.isDcs=!!t.getWindowObject(),t}();i.DcsUtils=o},8712:function(t,i,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(t){for(var i,n=1,r=arguments.length;n<r;n++)for(var e in i=arguments[n])Object.prototype.hasOwnProperty.call(i,e)&&(t[e]=i[e]);return t},r.apply(this,arguments)},e=this&&this.__spreadArrays||function(){for(var t=0,i=0,n=arguments.length;i<n;i++)t+=arguments[i].length;var r=Array(t),e=0;for(i=0;i<n;i++)for(var s=arguments[i],o=0,u=s.length;o<u;o++,e++)r[e]=s[o];return r};Object.defineProperty(i,"__esModule",{value:!0}),i.DemandManager=void 0;var s=n(125),o=n(5879),u=n(7730),a=n(5310),c=n(1993),h=n(1128),f=n(9235),d=n(2727),l=n(2362),v=n(8033),p=n(6258),m=n(6393),w=n(4949),b=n(3034),g=n(3006),_=n(9490),y=n(4569),O=function(){function t(){this.logger=new s.Logger("DemandManager"),this.profile=u.Profiler.get()}return t.get=function(){return t.instance||(t.instance=new t),t.instance},t.prototype.processResponse=function(t,i,n){var r=this;switch(i.rt){case"provider":case"empty_api":var e=i;this.logger.info("getDemand returned ["+e.c.p+"] for spot "+t.adIndex+", attempt "+t.attemptIndex,i),t.adUnit="generic_js"===e.c.p?"NA":e.c.aup;break;case"header_bidding":var s=i;this.logger.info("getDemand returned ["+s.c.b+"] for spot "+t.adIndex+", attempt "+t.attemptIndex,i),t.adUnit="NA";break;case"SRA":if(this.sraManager)0===n.indexOf(t)&&this.sraManager.updateResponse(i);else{var u=i;this.sraManager=new o.SRAResponseManager(u,n)}}this.isLazySpot(t)&&!t.isRefreshing()?a.default.get().subscribe(t,(function(){return r.matchResponse(i,t)})):this.matchResponse(i,t)},t.prototype.matchResponse=function(i,n){var r,e=t.isSRAResponse(i)&&this.sraManager?this.sraManager.peek(n):i;if(e){n.demandCompatibleSizes=n instanceof y.ApiSpot&&(null===(r=n.options)||void 0===r?void 0:r.sizes)||this.getDemandCompatibleSizes(n,e);var s=this.checkSpotViolations(n,e);if(s.length)this.profile.layouts.lazySpots.collectPotentialViewability&&g.default.hasUserConsent&&_.PotentialViewabilityHandler.get().reportPotentialViewability(n,[{reason:"lazy_ad_missed"}]),this.handleAdRequestBlock(n,s);else{var o=t.isSRAResponse(i)&&this.sraManager?this.sraManager.pop(n,e):e;if(o){if("empty"===o.rt)return this.logger.info("getDemand returned empty, waterfall ended for spot "+n.adIndex),void n.closePlaceholderAndRemove();n.isSaas=d.Utils.isSaas(o),n.isAutoSize=this.isAutoSizeResponse(o,n),this.fetch(o,n)}}}else this.logger.info("failed matching candidate response for spot "+n.adIndex+". response: "+i)},t.prototype.getDemandCompatibleSizes=function(t,i){return t.compatibleSizes.filter((function(t){return i.szs.some((function(i){return i.w===t.w&&i.h===t.h}))}))},t.prototype.fetch=function(t,i){var n=this,r=v.EmbeddingFactory.getEmbedder(t,i),e=p.ProviderFactory.getProvider(t,i);e&&r?(t=i.prepareResponseForFetch(t),this.runPreFetch(i,t,e).then((function(){return i.updateRefreshDetails(t),e.fetch(t,r)})).then((function(r){if(d.Utils.isBrowsiLoggerActive()){var s=n.buildLoggerData(i,r);window.dispatchEvent(new CustomEvent("fetch_end",{detail:s}))}switch(n.logger.logWaterfallDetails(i,t,r.status),r.status){case"failure":case"timeout":case"not_supported":case"generic_snippet_error":i.destroySlot(),i.stopRefreshing(),i.isRefreshing()&&l.Embedder.removeAdFromDom(i),i.updateBrowsiAdWrapper(),m.YieldClient.get().nextWaterfallStep(i);break;case"success":n.logger.info("SUCCESS"),"dfp"!==e.providerName&&new w.default(i,i.adUnit||"").waitForSpotMeasurable(),i.type===h.SpotType.API&&d.Utils.dispatchDOMEvent("browsiAdImpression",i.ref),n.shouldInjectMoat(u.Profiler.get().layouts.moatPercentage)&&l.Embedder.injectMoat(i),i.unsetRefDisplay(),n.runPostFetch(i,t)}})).catch((function(t){n.logger.info("Failed fetching "+i.type+" spot "+i.typeIndex+":",t)}))):m.YieldClient.get().nextWaterfallStep(i)},t.prototype.shouldInjectMoat=function(t){return Math.floor(100*Math.random())<t},t.prototype.isLazySpot=function(t){return a.default.isLazyConfiguredForSpotType(t)&&t.isLazyLoading},t.isSRAResponse=function(t){return"SRA"===t.rt},t.prototype.handleAdRequestBlock=function(t,i){var n;t.demandCompatibleSizes=null,t.adRequestBlockedSent||i.length&&(this.profile.layouts.lazySpots.collectPotentialViewability&&g.default.hasUserConsent&&_.PotentialViewabilityHandler.get().reportPotentialViewability(t,i),this.logger.info("spot "+t.adIndex+" blocked: "+i.map((function(t){return t.reason})).join(",")),c.EventsService.get().sendAdBlockedEvent(t,i)),null===(n=t.placeholder)||void 0===n||n.closePlaceholder(!1,t)},t.prototype.checkSpotViolations=function(t,i){var n,r=[],s=t.optimizeViewability&&this.checkViewabilityThreshold(t.tags,i);return s&&r.push(s),t.type===h.SpotType.API||(this.checkDemandSizeViolation(t)&&r.push({reason:"no_compatible_demand_sizes"}),e([h.SpotType.DYNAMIC_MC],b.DYNAMIC_RAIL_TYPES).includes(t.type)&&!t.isRefreshing()&&(n=f.default.instance.checkStayAwayViolation(t))&&r.push(n),"provider"===i.rt&&"generic_js"===i.c.p&&(n=this.checkGenericExpectedSizeViolation(t,i))&&r.push(n),d.Utils.isPositionedDisconnected(t.ref,document.body)&&r.push({reason:"spot_not_exists"}),t.type===h.SpotType.STICKY&&(t.getCompatibleSizes().length||r.push({reason:"no_compatible_sizes"}))),r},t.prototype.checkViewabilityThreshold=function(t,i){var n,r,e=b.SpotsUtils.getViewabilityThreshold(t);if(e){var s=(null===(r=null===(n=null==i?void 0:i.od)||void 0===n?void 0:n[50])||void 0===r?void 0:r.p)&&Number(i.od[50].p);if(s&&s>0&&s<e)return{reason:"prediction_threshold",message:""}}return null},t.prototype.checkGenericExpectedSizeViolation=function(t,i){var n={w:Number(i.c.a.expectedWidth),h:Number(i.c.a.expectedHeight)};return t.isSizeInSpot(n)?null:{reason:"generic_js_size_mismatch"}},t.prototype.checkDemandSizeViolation=function(t){return!t.demandCompatibleSizes||!t.demandCompatibleSizes.length},t.prototype.runPreFetch=function(t,i,n){var r,e=this,s=d.Utils.getExternalFlowHandler("preFetchAsync"),o=d.Utils.getExternalFlowHandler("preFetch");if(o||s){var u=null===(r=d.Utils.getDemandConfig(i))||void 0===r?void 0:r.aup;return new Promise((function(r,u){if(i=d.Utils.convertToOldStyleAdUnit(i),s){e.logger.info("Invoking preFetchAsync");try{return void s(t,n,i,r,u)}catch(t){e.logger.error("Failed to execute preFetchAsync",t),r()}}else{if(o){e.logger.info("Invoking preFetch");try{o(t,n,i)}catch(t){e.logger.error("Failed to execute preFetch",t)}}r()}})).then((function(){i=u?d.Utils.convertToNewStyleAdUnit(i,u):i}))}return Promise.resolve()},t.prototype.runPostFetch=function(t,i){var n,r="postFetch",e=d.Utils.getExternalFlowHandler(r);if(e)try{this.logger.info("executing postFetch");var s=null===(n=d.Utils.getDemandConfig(i))||void 0===n?void 0:n.aup;e(t,i=d.Utils.convertToOldStyleAdUnit(i)),i=s?d.Utils.convertToNewStyleAdUnit(i,s):i}catch(t){this.logger.error("failed to execute postFetch",t)}},t.prototype.isAutoSizeResponse=function(t,i){if(i.type===h.SpotType.STICKY)return!1;var n=t.c.d||t.c,r=n.a&&n.a.autoSize;return!!r&&"true"===r},t.prototype.buildLoggerData=function(t,i){var n,e,s,o,u=d.Utils.getGAMResponseInfo(t.slot),a=(null===(n=t.slot)||void 0===n?void 0:n.getSizes())||[],c=null==a?void 0:a.map((function(t){if("string"==typeof t)return t;var i=Object.keys(t);return{w:+t[i[0]],h:+t[i[1]]}}));return r(r({demandType:t.providerName,placement:null===(e=t.browsiAd)||void 0===e?void 0:e.container,adUnit:null===(s=t.slot)||void 0===s?void 0:s.getAdUnitPath(),requestedSizes:c,targeting:(null===(o=t.slot)||void 0===o?void 0:o.getTargetingMap())||{},responseSize:t.selectedSize||null,refreshCount:t.refresh.count,orderId:(null==u?void 0:u.oid)||null,lineItemId:(null==u?void 0:u.lid)||null},"dfp"===t.providerName||"generic_js"===t.providerName?{}:{winner:"success"===i.status?"GAM":"NONE"}),"success"!==i.status?{noFill:!0}:{})},t}();i.DemandManager=O},9790:(t,i,n)=>{"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=n(125),e=n(2727),s=n(9394),o=n(2247),u=n(7631),a=function(){function t(){this.logger=new r.Logger("Dfp Detector"),this.googletag=window.googletag||{},this.googletag.cmd=this.googletag.cmd||[],this.isActive=!1}return Object.defineProperty(t,"instance",{get:function(){return this._instance||(this._instance=new t),this._instance},enumerable:!1,configurable:!0}),t.start=function(){if(this.instance.isActive)return this.instance.logger.info("already started");this.instance.logger.info("starting"),this.instance.run()},t.setInactive=function(){this.instance.isActive=!1},t.prototype.run=function(){this.isActive=!0,this.listenToLazyAds(),this.checkFetchedSlots()},t.prototype.checkFetchedSlots=function(){var t=this;this.logger.debug("checkFetchedSlots"),this.checkCurrentSlots(),setTimeout((function(){return t.checkCurrentSlots()}),1e3)},t.prototype.checkCurrentSlots=function(){var t=this;this.logger.debug("checking current slots"),this.googletag.cmd.push((function(){t.googletag.pubads().getSlots().forEach((function(i){var n=document.getElementById(i.getSlotElementId());if(n){var r=t.resolveInnerMostSingleChild(n),o=e.Utils.getElementSize(r),u=e.Utils.getDfpAdSize(n);if(u&&(o=u.size,r=u.element),t.validationPassed(n,i)&&i.getResponseInformation())if(t.isRendered(r,o)){var a=t.buildFoundProvider(n,i,!1);s.default.get().addFoundProvider(a,i,o)}else t.handleThirdPartySlowAdRendering(n,i,!1)}}))}))},t.prototype.getProviderType=function(t){var i=t.getTargetingKeys();return-1!=i.indexOf("hb_pb")&&-1!=i.indexOf("hb_size")?"header_bidding":"dfp"},t.prototype.isRendered=function(t,i){return e.Utils.isVisible(t)&&o.DFP.isValidSize(i)},t.prototype.listenToLazyAds=function(){var t=this,i=u.PubAdsRefreshService.get();this.googletag.cmd.push((function(){t.googletag.pubads().addEventListener("slotRenderEnded",(function(n){var r=i&&i.handleRenderEnded(n);if(t.isActive&&!n.isEmpty){var o=document.getElementById(n.slot.getSlotElementId());if(o){var u=t.resolveInnerMostSingleChild(o),a=t.buildFoundProvider(o,n.slot,!0);t.validationPassed(o,n.slot)?t.isRendered(u,n.size)?s.default.get().addFoundProvider(a,n.slot,e.Utils.getDfpEventSize(n)):t.handleThirdPartySlowAdRendering(o,n.slot,!0):r?s.default.get().addFoundProvider(a,n.slot,e.Utils.getDfpEventSize(n),"browsi"):t.isForcedRefreshed(o,n.slot)&&s.default.get().addFoundProvider(a,n.slot,e.Utils.getDfpEventSize(n),"forced")}}}))}))},t.prototype.handleThirdPartySlowAdRendering=function(t,i,n){var r=this;this.waitForDeflating(t).then((function(e){r.logger.debug("deflated to ",e,t);var o=r.buildFoundProvider(t,i,n);s.default.get().addFoundProvider(o,i,e)})).catch((function(i){return r.logger.debug("did not deflate",i,t)}))},t.prototype.validationPassed=function(t,i){return!this.isBrowsiAd(i)&&!s.default.get().isDetectedAlready(t)&&(e.Utils.isInCurrentArticle(t)||e.Utils.isBetweenArticles(t)||e.Utils.isFixed(t))},t.prototype.isForcedRefreshed=function(t,i){return!this.isBrowsiAd(i)&&s.default.get().isDetectedAlready(t)&&(e.Utils.isInCurrentArticle(t)||e.Utils.isBetweenArticles(t)||e.Utils.isFixed(t))},t.prototype.isBrowsiAd=function(t){var i=t.getSlotElementId();return/^browsi_(ad.*)_ai_-?(\d+)_ati_(\d+).*$/.test(i)},t.prototype.resolveAdSize=function(t){for(var i,n=t;1===(i=this.getNonScriptChildren(n)).length;)n=i[0];return e.Utils.getElementSize(n)},t.prototype.resolveInnerMostSingleChild=function(t){for(var i,n=t;1===(i=this.getNonScriptChildren(n)).length;)n=i[0];return n},t.prototype.getNonScriptChildren=function(t){return Array.from(t.children).filter((function(t){return"SCRIPT"!==t.tagName}))},t.prototype.waitForDeflating=function(t){var i=this;return new Promise((function(n,r){var e=10;i.logger.debug("waiting for deflation",t);var s=setInterval((function(){var u=i.resolveAdSize(t);o.DFP.isValidSize(u)&&(clearInterval(s),n(u)),e--||(clearInterval(s),r(u))}),500)}))},t.prototype.buildFoundProvider=function(t,i,n){return{element:t,providerName:this.getProviderType(i),placementId:i.getSlotElementId(),adUnit:i.getAdUnitPath(),isLazyLoaded:n,isManualAd:!1}},t}();i.default=a},905:(t,i,n)=>{"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.EngagementService=void 0;var r=n(125),e=n(2727),s=n(1993),o=n(7730),u=n(8614),a=function(){function t(){this.isSubscribed=!1,this.timeoutObjId=null,this.logger=new r.Logger("EngagementService"),this.logger.info("initializing"),this.engagementCounter=0,this.lastScrollingDistance=0,this.lastEngagementReport=0,this.engagementsCounter=0,this.eventsBatchCounter=0,this.engagementsBatch=[],this.profile=o.Profiler.get(),this.isHidden=!1,this.hiddenTime=0,this.hiddenTimeDelta=0,this.outOfFocusTime=0,u.Focus.get().subscribe(this.onFocusChanged.bind(this))}return t.get=function(){return t._instance||(t._instance=new t),t._instance},t.prototype.subscribe=function(){var t=this;if(this.isSubscribed)this.logger.info("Already subscribed!");else{this.isSubscribed=!0;var i=this.profile.timeBetweenEngagementReports||2;this.setEventInterval(),this.timeoutObjId=setTimeout((function(){t.eventsSender(i)}),1e3*i)}},t.prototype.setEventInterval=function(){var t=this;this.eventSenderInterval=setInterval((function(){t.isSubscribed?t.isHidden||(t.eventsBatchCounter++,t.engagementsCounter++,t.engagementsBatch.push(t.buildEngagementData())):clearInterval(t.eventSenderInterval)}),1e3)},t.prototype.unsubscribe=function(){this.isSubscribed=!1,u.Focus.get().unsubscribe(),this.timeoutObjId&&clearTimeout(this.timeoutObjId)},t.unsubscribeIfNeeded=function(){t._instance&&t._instance.unsubscribe()},t.prototype.buildEngagementData=function(){var t=Date.now(),i=e.Utils.getScrollingDistance()-this.lastScrollingDistance,n=Math.abs(this.lastScrollingDistance?i:0),r=this.getTimeDelta(t),s={et:"general_engagement",c:this.engagementsCounter,dep:e.Utils.getScrollDepthPercentages(),po:e.Utils.getScrollingDistance(),pl:e.Utils.getPageHeight(),td:r,pd:n,sl:e.Utils.getWindowHeight(),now:e.Utils.getNowInSeconds(),lt:this.getLoadTime(),plt:this.getPageLoadTime(),to:e.Utils.getTimeOffset(),top:this.getTimeOnPage(),mcst:this.profile.domData?this.profile.domData.mainContent.start:-1,mcs:e.Utils.getMainContentSize(this.profile.domData),v:Math.round(n/(r/1e3))||0,bpvid:o.Profiler.get().identity.bootstrapPageviewId};return this.lastScrollingDistance=e.Utils.getScrollingDistance(),this.lastEngagementReport=t,s},t.prototype.eventsSender=function(t){var i=this;this.isSubscribed&&(!this.isHidden&&this.engagementsBatch.length>0&&(t=this.calculateNextEventSend(t),s.EventsService.get().sendEngagementReportEvent(this.engagementsBatch),this.engagementsBatch=[]),this.timeoutObjId=setTimeout((function(){i.eventsSender(t)}),1e3*t))},t.prototype.calculateNextEventSend=function(t){return this.eventsBatchCounter>=60&&(this.eventsBatchCounter=0,t+=2),(e.Utils.getTimeOffset()/1e3>=600||!e.Utils.getCookie("__browsiSessionID"))&&this.unsubscribe(),t},t.prototype.getTimeOnPage=function(){var t=e.Utils.getTimeOffset()/1e3,i=this.outOfFocusTime/1e3;return Number((t-i).toFixed(2))},t.prototype.getTimeDelta=function(t){var i=this.lastEngagementReport?t-this.lastEngagementReport:0;return this.hiddenTimeDelta>0&&(i=this.hiddenTimeDelta,this.hiddenTimeDelta=0),i},t.prototype.getLoadTime=function(){try{if(window.performance&&window.performance.timing.navigationStart>0&&window.performance.timing.domInteractive>0)return Math.floor(window.performance.timing.domInteractive-window.performance.timing.navigationStart)}catch(t){}return-1},t.prototype.getPageLoadTime=function(){try{if("complete"===document.readyState&&window.performance&&window.performance.timing.loadEventEnd>0&&window.performance.timing.domContentLoadedEventStart>0)return Math.floor(Math.abs(window.performance.timing.loadEventEnd-window.performance.timing.domContentLoadedEventStart))}catch(t){}return-1},t.prototype.onFocusChanged=function(t){if(this.isHidden=t,t)this.hiddenTime=Date.now(),clearInterval(this.eventSenderInterval);else{this.hiddenTime>0&&(this.outOfFocusTime=this.outOfFocusTime+(Date.now()-this.hiddenTime));var i=Date.now(),n=i-this.hiddenTime;this.hiddenTimeDelta=this.lastEngagementReport?i-this.lastEngagementReport-n:0,this.logger.info("Out Of focus time: "+this.outOfFocusTime/1e3+" seconds, time on page: "+this.getTimeOnPage()),this.setEventInterval()}},t}();i.EngagementService=a},1993:function(t,i,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(t){for(var i,n=1,r=arguments.length;n<r;n++)for(var e in i=arguments[n])Object.prototype.hasOwnProperty.call(i,e)&&(t[e]=i[e]);return t},r.apply(this,arguments)},e=this&&this.__spreadArrays||function(){for(var t=0,i=0,n=arguments.length;i<n;i++)t+=arguments[i].length;var r=Array(t),e=0;for(i=0;i<n;i++)for(var s=arguments[i],o=0,u=s.length;o<u;o++,e++)r[e]=s[o];return r};Object.defineProperty(i,"__esModule",{value:!0}),i.EventsService=void 0;var s=n(7730),o=n(125),u=n(2727),a=n(6319),c=n(3034),h=n(1128),f=n(5490),d=n(1031),l=function(){function t(){this.eventsQue={},this.browsiImpressionsCount=0,this.commonFields=this.buildCommonFields(),this.eventServerUrl=s.Profiler.get().yieldData.eventServerUrl,this.logger=new o.Logger("Events"),this.profile=s.Profiler.get(),this.sendEventsThrottle=u.Utils.throttle(this.flushEventsQue.bind(this),this.profile.siteInfo.bulkEventsThrottle||0),this.isValidEventServerUrl=this.isValidURL(this.eventServerUrl),this.isValidEventServerUrl||this.logger.error("Invalid event server URL")}return t.get=function(){return t._instance||(this._instance=new t),t._instance},t.prototype.sendEngineLoadedEvent=function(){var t=s.Profiler.get(),i=this.getEngineLoadedEvent(t);this.addToEventsQue("supply",i.et,[i])},t.prototype.sendSpotFoundEvent=function(t){var i=this.getSpotFoundEvent(t);this.addToEventsQue("demand",i.et,[i])},t.prototype.sendPageviewEvent=function(t,i,n,r,e,s,o,u){var a=o&&o.length>0?{rsn:o.join(";")}:{},c=this.getPageviewEvent(t,i,n,r,e,s,a,u);this.addToEventsQue("supply",c.et,[c])},t.prototype.sendAdBlockerEvent=function(){var t=this.getAdBlockerEvent();this.addToEventsQue("supply",t.et,[t])},t.prototype.sendAdRequest=function(t,i,n,r,e){var s=this.getAdRequestEvent(t,i,n,r,e);this.addToEventsQue("demand",s.et,[s])},t.prototype.sendAdMatchedEvent=function(t,i,n,r,e,s,o){var u=this.getAdMatchedEvent(t,i,n,r,e,s,o);this.addToEventsQue("demand",u.et,[u])},t.prototype.sendAdImpression=function(t,i,n,r,e){var s,o=u.Utils.getSpotCoords(t),a=(null===(s=t.refresh)||void 0===s?void 0:s.count)||0,c=this.getAdImpressionEvent(o,t,i,n,r,e);0==a&&this.browsiImpressionsCount++,this.addToEventsQue("demand",c.et,[c]),this.sendLoggerEvent(t)},t.prototype.sendViewedImpression=function(t,i){var n=u.Utils.getSpotCoords(t),r=this.getViewedImpressionEvent(n,t,i);this.addToEventsQue("demand",r.et,[r])},t.prototype.sendViewedImpression100=function(t){var i=u.Utils.getSpotCoords(t),n=this.getViewedImpression100Event(i,t);this.addToEventsQue("demand",n.et,[n])},t.prototype.sendViewedImpressionAV=function(t){var i=this.getViewedImpressionEventAV(t);this.addToEventsQue("demand",i.et,[i])},t.prototype.sendViewedPublisherAd=function(t,i){var n=this.getViewedPublisherAdEvent(t,i);this.addToEventsQue("demand",n.et,[n])},t.prototype.sendUserEngagementEvent=function(){var t=this.getUserEngagementEvent();this.addToEventsQue("supply",t.et,[t])},t.prototype.sendEngagementReportEvent=function(t){var i=this,n=t.map((function(t){return Object.assign({},i.commonFields,t)}));this.addToEventsQue("engagement",n[0].et,n)},t.prototype.sendBidRequest=function(t,i){var n=this.getBidRequestEvent(t,i);this.addToEventsQue("hb",n.et,[n])},t.prototype.sendBidMatched=function(t,i){var n=this.getBidMatchedEvent(t,i);this.addToEventsQue("hb",n.et,[n])},t.prototype.sendAdBlockedEvent=function(t,i){t.adRequestBlockedSent=!0;var n=this.getAdBlockedEvent(t,i);this.addToEventsQue("demand",n.et,[n])},t.prototype.sendApiRequestBlockedEvent=function(t,i,n){var r=this.getApiBlockEvent(t,i,n);this.addToEventsQue("demand","api_request_blocked",[r])},t.prototype.sendPubAdRefreshBlockedEvent=function(t,i,n,r){var e=this.getRefreshBlockEvent(t,i,n,r);this.addToEventsQue("demand","parb",[e])},t.prototype.sendFocusChangedEvent=function(t,i){var n=this.getFocusChangedEvent(t,i);this.addToEventsQue("supply",n.et,[n])},t.prototype.sendPublisherAdFound=function(t,i,n,r){var e=this.getPublisherAdFoundEvent(t,i,n,r);this.addToEventsQue("demand",e.et,[e])},t.prototype.sendPubAdRefreshRequest=function(t,i,n){var r=this.getPubAdRefreshEvent(t,i,n);this.addToEventsQue("demand",r.et,[r])},t.prototype.sendAdInViewport=function(t,i){var n=this.getAdInViewportEvent(t,i);this.addToEventsQue("demand",n.et,[n])},t.prototype.sendDcs=function(t,i){void 0===i&&(i={});var n=this.getDcsEvent(t,i);this.addToEventsQue("supply",t,[n])},t.prototype.sendAdMeasurableEvent=function(t,i,n,r){var e=this.getAdMeasurableEvent(t,i,n,r);this.addToEventsQue("demand",e.et,[e])},t.prototype.sendViewedPublisherAdAV=function(t){var i=this.getViewedPublisherAdAv(t);this.addToEventsQue("demand",i.et,[i])},t.prototype.sendStickyClosedEvent=function(t){var i=this.getStickyClosedEvent(t);this.addToEventsQue("demand","sticky_closed",[i])},t.prototype.sendErrorEvent=function(t,i,n,r){var e=this.getErrorEvent(t,n,i,r);this.sendError(t,e)},t.prototype.sendPlaceholderViewed=function(t){var i=this.getPlaceholderEvent(t,"placeholder_viewed");this.addToEventsQue("demand","placeholder_viewed",[i])},t.prototype.sendPlaceholderClosed=function(t,i){var n=this.getPlaceholderEvent(t,"placeholder_closed",i);this.addToEventsQue("demand","placeholder_closed",[n])},t.prototype.sendBlankAdEvent=function(t,i,n,r){var e=this.getBlankAdEvent(t,i,n,r);this.addToEventsQue("demand","blank",[e])},t.prototype.sendPublisherBlankAdEvent=function(t,i,n,r){var e=this.getPublisherBlankAdEvent(t,i,n,r);this.addToEventsQue("pub_demand","blank",[e])},t.prototype.sendBillableEvent=function(t){var i=this.getBillableEvent(t);this.addToEventsQue("demand","billable_event",[i])},t.prototype.sendWebVitalsEvent=function(t){var i=this.commonFields,n=i.sk,e=i.pk,s=i.dp,o=t.pv,u=t.fid,a=t.lcp,c=t.cls,h=r(r(r({sk:n,pk:e,dp:s,pvid:o},u?{fid:u}:{}),a?{lcp:a}:{}),c?{cls:c}:{});this.sendBeacon("web_vitals","web_vitals",[h])||this.addToEventsQue("web_vitals","web_vitals",[h])},t.prototype.sendGenericAnalyticsEvent=function(t,i){this.addToEventsQue("analytic",t,[i])},t.prototype.sendGeneralDataEvent=function(t,i){var n=r(r({},this.commonFields),{now:u.Utils.getNowInSeconds(),et:"general_data",to:u.Utils.getTimeOffset(),gd:t});i&&i.forEach((function(t){delete n[t]})),this.sendBeacon("analytic","general_data",[n])||this.addToEventsQue("analytic","general_data",[n])},t.prototype.sendSummaryEvent=function(){var t=d.Engagement.get().getData(),i=r(r(r({sk:this.commonFields.sk,pk:this.commonFields.pk,pvid:this.commonFields.pvid,dp:this.commonFields.dp,et:"summary",now:u.Utils.getNowInSeconds(),to:u.Utils.getTimeOffset(),sid:this.profile.identity.sessionId,mv:this.commonFields.mv,scid:this.profile.identity.supplyConfigId,geo:this.commonFields.geo,ts:this.commonFields.ts,db:this.commonFields.db,dos:this.commonFields.dos,d:this.commonFields.d,url:encodeURIComponent(u.Utils.getPageUrl()),ads:this.browsiImpressionsCount,dep:t.max_depth_percentage,sl:t.screen_length,plt:t.page_load_time,top:t.time_on_page,v:t.velocity_including_static_time,vest:t.velocity_excluding_static_time,bpvid:this.commonFields.bpvid},t.title?{tt:t.title}:{}),t.meta_description?{md:t.meta_description}:{}),{pl:u.Utils.getPageHeight()});this.sendBeacon("engagement","summary",[i])||this.addToEventsQue("engagement","summary",[i])},t.prototype.getResponseTimeEvent=function(t){return{sk:this.profile.identity.siteKey,pk:this.profile.identity.publisherKey,pvid:this.profile.identity.pageviewId,geo:this.profile.yieldData.countryCode,url:this.profile.identity.url,dos:this.profile.deviceDetails.os,dosv:this.profile.deviceDetails.osVersion,dv:this.profile.deviceDetails.deviceVendor,dbt:this.profile.deviceDetails.browserType,ibpv:this.profile.identity.isBenchmarkPageview,ts:this.profile.yieldData.trafficSource,db:this.profile.deviceDetails.browser,d:this.profile.deviceDetails.device,dp:this.profile.deviceDetails.deviceType,mv:this.profile.yieldData.version,scid:this.profile.identity.supplyConfigId,aid:this.profile.identity.articleId,now:u.Utils.getNowInSeconds(),et:"rt",pl:u.Utils.getPageHeight(),to:u.Utils.getTimeOffset(),td:t}},t.prototype.getEngineLoadedEvent=function(t){return Object.assign({},this.commonFields,r({now:u.Utils.getCurrentTime(!0),et:"engine_loaded",to:this.getTimeOffset(),res:t.deviceDetails.screenWidth+"x"+t.deviceDetails.screenHeight},this.profile.siteInfo.billableEvents===f.BillableEventType.PAGEVIEW?{be:!0}:{}))},t.prototype.getSpotFoundEvent=function(t){return r(r(r(r(r({},this.commonFields),{now:u.Utils.getCurrentTime(!0),et:"spot_found",adix:t.adIndex,f:this.getFold(t),pt:t.positionTypeToString(),ot:t.offsetTop,to:this.getTimeOffset(),ill:t.isLazyLoading,pw:u.Utils.getPageWidth(),st:t.type}),this.getDcsEventData(t.isDcs)),this.getSpotTags(t)),t.selector?{sel:t.selector}:{})},t.prototype.getPageviewEvent=function(t,i,n,e,s,o,a,f){var d,l,v,p,m;return r(r(r(r(r(r({},this.commonFields),a),{now:u.Utils.getCurrentTime(!0),et:"page_view",uid:u.Utils.getUserID(),sid:this.profile.identity.sessionId,bpvid:this.profile.identity.bootstrapPageviewId,sf:t,fsf:i,ie:t+i>0,tlls:-1,pl:u.Utils.getPageHeight(),pw:u.Utils.getPageWidth(),to:this.getTimeOffset(),res:this.profile.deviceDetails.screenWidth+"x"+this.profile.deviceDetails.screenHeight,scid:this.profile.identity.supplyConfigId,iru:this.profile.yieldData.isReturningUser,mcs:this.profile.domData?this.profile.domData.mainContent.start:-1,mcw:this.profile.domData?this.profile.domData.mainContent.width:-1,mch:u.Utils.getMainContentSize(this.profile.domData),sl:this.profile.deviceDetails.screenHeight,mi:(null===(d=c.SpotsUtils.getConf(h.SPOT_TAGS_MAP[h.SpotType.DYNAMIC_MC]))||void 0===d?void 0:d.maxItems)||0,fmi:(null===(l=c.SpotsUtils.getConf(h.SPOT_TAGS_MAP[h.SpotType.FIXED_MC]))||void 0===l?void 0:l.maxItems)||0,ftmi:(null===(v=c.SpotsUtils.getConf(h.SPOT_TAGS_MAP[h.SpotType.FIXED_TOP]))||void 0===v?void 0:v.maxItems)||0,fbmi:(null===(p=c.SpotsUtils.getConf(h.SPOT_TAGS_MAP[h.SpotType.FIXED_BOTTOM]))||void 0===p?void 0:p.maxItems)||0,ssf:n,rmi:(null===(m=this.profile.layouts.spots.rails)||void 0===m?void 0:m.maxItems)||0,rrsf:s,lrsf:o,ftbsf:e}),f?{ppvid:this.commonFields.pvid,pvid:f}:{}),this.profile.runMode?{mod:this.profile.runMode}:{}),this.getDcsEventData())},t.getFiredEvents=function(){return t.firedEvents},t.prototype.getAdBlockerEvent=function(){return r(r({},this.commonFields),{now:u.Utils.getCurrentTime(!0),et:"ad_blocker",to:this.getTimeOffset(),ex:s.Profiler.adBlockerExists})},t.prototype.getUserEngagementEvent=function(){return r(r({},this.commonFields),{now:u.Utils.getCurrentTime(!0),et:"user_engaged",to:this.getTimeOffset()})},t.prototype.getAdRequestEvent=function(t,i,n,e,s){var o;return r(r(r(r(r(r(r(r(r({},this.commonFields),{now:u.Utils.getCurrentTime(!0),et:"ad_request",adf:"display",adix:t.adIndex,au:t.adUnit,saas:t.isSaas,atix:t.attemptIndex,pr:i,f:this.getFold(t),ot:u.Utils.getSpotCoords(t).top,ill:t.isLazyLoading,pw:u.Utils.getPageWidth(),rc:t.refresh.count,to:this.getTimeOffset(),ul:u.Utils.getScrollPosition().top,st:t.type,pt:t.positionTypeToString(),di:t.demandIndex,s:this.getSizesByOrder(n),plk:e}),t.type===h.SpotType.API?{plid:t.ref.id}:{}),t.type===h.SpotType.API&&(null===(o=t.options)||void 0===o?void 0:o.disableViewabilityOptimization)?{vod:!0}:{}),this.getDcsEventData(t.isDcs)),t.generalData?{gd:t.generalData}:{}),this.getSpotTags(t)),t.placeholder?{ps:t.placeholder.size.w+"x"+t.placeholder.size.h}:{}),"number"==typeof s?{pi:s}:{})},t.prototype.getSizesByOrder=function(t){return Array.isArray(t[0])?t.sort((function(t,i){if("fluid"===t[0])return-1;if("fluid"===i[0])return 1;try{var n=t[0],r=i[0];return n===r?t[1]-i[1]:n-r}catch(t){return-1}})).map((function(t){return"fluid"===t[0]?"fluid":t[0]+"x"+t[1]})).join("|"):t.join("x")},t.prototype.getAdBlockedEvent=function(t,i){return r(r(r(r(r({},this.commonFields),{now:u.Utils.getCurrentTime(!0),et:"ad_request_blocked",adf:"display",adix:t.adIndex,au:t.adUnit,saas:t.isSaas,atix:t.attemptIndex,f:this.getFold(t),ot:u.Utils.getSpotCoords(t).top,ill:t.isLazyLoading,pw:u.Utils.getPageWidth(),rc:t.refresh.count,to:this.getTimeOffset(),rsn:i.map((function(t){return t.reason})).join(","),msg:i.map((function(t){return t.message||""})).join(","),ul:u.Utils.getScrollPosition().top,st:t.type,pt:t.positionTypeToString()}),this.getDcsEventData(t.isDcs)),t.generalData?{gd:t.generalData}:{}),this.getSpotTags(t))},t.prototype.getApiBlockEvent=function(t,i,n){return r(r({},this.commonFields),{now:u.Utils.getCurrentTime(!0),et:"api_request_blocked",rsn:t,msg:i,to:this.getTimeOffset(),plid:n})},t.prototype.getRefreshBlockEvent=function(t,i,n,e){return r(r(r({},this.commonFields),{now:u.Utils.getCurrentTime(!0),et:"parb",to:this.getTimeOffset(),rsn:e,plid:t,rc:i,pt:u.Utils.sortedString(n)}),this.getDcsEventData())},t.prototype.getPublisherAdFoundEvent=function(t,i,n,e){return r(r(r(r(r(r(r(r({},this.commonFields),{now:u.Utils.getCurrentTime(!0),et:"found_publisher_ad",adix:-1,au:t.adUnit,f:t.foldNum,ot:u.Utils.getElementPosition(t.element).top,ol:u.Utils.getElementPosition(t.element).left,pw:u.Utils.getPageWidth(),to:this.getTimeOffset(),pr:t.providerName,pt:u.Utils.sortedString(t.positionType),h:t.height,w:t.width,plid:t.placementId,ul:u.Utils.getScrollPosition().top,rc:t.refreshCount}),i),this.getDcsEventData()),t.refreshType?{rt:t.refreshType}:{}),t.gamResponseInfo),n?{be:!0}:{}),e?{ded:!0}:{})},t.prototype.getPubAdRefreshEvent=function(t,i,n){return r(r(r({},this.commonFields),{now:u.Utils.getCurrentTime(!0),et:"pub_ad_refresh_request",adix:-1,au:t.adUnit,f:t.foldNum,ot:u.Utils.getElementPosition(t.element).top,ol:u.Utils.getElementPosition(t.element).left,pw:u.Utils.getPageWidth(),to:this.getTimeOffset(),pr:t.providerName,pt:u.Utils.sortedString(t.positionType),h:t.height,w:t.width,plid:t.placementId,ul:u.Utils.getScrollPosition().top,rc:i}),n?{rt:n}:{})},t.prototype.getViewedPublisherAdEvent=function(t,i){return r(r(r(r(r({},this.commonFields),{now:u.Utils.getCurrentTime(!0),et:"viewed_publisher_ad",adix:-1,au:t.adUnit,f:t.foldNum,ot:u.Utils.getElementPosition(t.element).top,ol:u.Utils.getElementPosition(t.element).left,ill:t.isLazyLoaded,pw:u.Utils.getPageWidth(),to:this.getTimeOffset(),pr:t.providerName,pt:u.Utils.sortedString(t.positionType),h:t.height,w:t.width,plid:t.placementId,ul:u.Utils.getScrollPosition().top,c:1,tiv:-1,piv:i,rc:t.refreshCount}),this.getDcsEventData()),t.refreshType?{rt:t.refreshType}:{}),t.gamResponseInfo)},t.prototype.getAdMatchedEvent=function(t,i,n,e,s,o,a){return r(r(r(r(r(r(r(r(r(r({},this.commonFields),s?{rsn:s}:{}),{now:u.Utils.getCurrentTime(!0),et:"ad_matched",adf:"display",adix:t.adIndex,au:t.adUnit,im:n,saas:t.isSaas,atix:t.attemptIndex,w:t.selectedSize?t.selectedSize.w:-1,h:t.selectedSize?t.selectedSize.h:-1,pr:i,emt:t.selectedSize&&t.selectedSize.selectedEmbedding?t.selectedSize.selectedEmbedding:"NA",ot:u.Utils.getSpotCoords(t).top,f:this.getFold(t),ill:t.isLazyLoading,pw:u.Utils.getPageWidth(),rc:t.refresh.count,to:this.getTimeOffset(),st:t.type,pt:t.positionTypeToString(),di:t.demandIndex,ul:u.Utils.getScrollPosition().top,plk:e}),this.getDcsEventData(t.isDcs)),o?{hb:o}:{}),t.generalData?{gd:t.generalData}:{}),this.getSpotTags(t)),u.Utils.getGAMResponseInfo(t.slot)),this.profile.siteInfo.billableEvents===f.BillableEventType.AD_REQUEST?{be:!0}:{}),a?{msg:a}:{})},t.prototype.getAdImpressionEvent=function(t,i,n,e,s,o){var a;return r(r(r(r(r(r(r({},this.commonFields),{now:u.Utils.getCurrentTime(!0),et:"ad_impression",adf:"display",au:(null===(a=i.slot)||void 0===a?void 0:a.getAdUnitPath())||i.adUnit,h:i.browsiAd.h,w:i.browsiAd.w,adix:i.adIndex,saas:i.isSaas,emt:o,atix:i.attemptIndex,ol:t.left,ot:t.top,pr:n,f:this.getFold(i),ill:i.isLazyLoading,pw:u.Utils.getPageWidth(),rc:i.refresh.count,to:this.getTimeOffset(),ul:u.Utils.getScrollPosition().top,st:i.type,pt:i.positionTypeToString(),di:i.demandIndex,plk:s}),this.getDcsEventData(i.isDcs)),u.Utils.getGAMResponseInfo(i.slot)),i.generalData?{gd:i.generalData}:{}),this.getSpotTags(i)),e?{ded:!0}:{})},t.prototype.getViewedImpressionEvent=function(t,i,n){return r(r(r(r(r(r({},this.commonFields),{now:u.Utils.getCurrentTime(!0),et:"viewed_impression",adf:"display",adix:i.adIndex,au:i.adUnit,saas:i.isSaas,h:i.browsiAd.h,w:i.browsiAd.w,emt:i.selectedSize&&i.selectedSize.selectedEmbedding?i.selectedSize.selectedEmbedding:"NA",ol:t.left,ot:t.top,atix:i.attemptIndex,c:1,pr:i.providerDisplayName||i.providerName,f:this.getFold(i),to:this.getTimeOffset(),pw:u.Utils.getPageWidth(),rc:i.refresh.impressionsEventCount,tiv:-1,piv:n,ill:i.isLazyLoading,st:i.type,pt:i.positionTypeToString(),di:i.demandIndex}),this.getDcsEventData()),i.generalData?{gd:i.generalData}:{}),this.getSpotTags(i)),u.Utils.getGAMResponseInfo(i.slot))},t.prototype.getViewedImpression100Event=function(t,i){return r(r(r(r(r({},this.commonFields),{now:u.Utils.getCurrentTime(!0),et:"v_100",adf:"display",adix:i.adIndex,au:i.adUnit,saas:i.isSaas,h:i.browsiAd.h,w:i.browsiAd.w,emt:i.selectedSize&&i.selectedSize.selectedEmbedding?i.selectedSize.selectedEmbedding:"NA",ol:t.left,ot:t.top,atix:i.attemptIndex,c:1,pr:i.providerDisplayName||i.providerName,f:this.getFold(i),to:this.getTimeOffset(),pw:u.Utils.getPageWidth(),rc:i.refresh.impressionsEventCount,tiv:-1,ill:i.isLazyLoading,st:i.type,pt:i.positionTypeToString(),di:i.demandIndex}),this.getDcsEventData(i.isDcs)),i.generalData?{gd:i.generalData}:{}),this.getSpotTags(i))},t.prototype.getBidRequestEvent=function(t,i){var n=u.Utils.getSpotCoords(t);return r(r(r({},this.commonFields),{now:u.Utils.getNowInSeconds(),et:"bid_request",adix:t.adIndex,di:t.demandIndex,atix:t.attemptIndex,ot:n.top,rc:t.refresh.count,to:u.Utils.getTimeOffset(),st:t.type,b:i}),this.getSpotTags(t))},t.prototype.getBidMatchedEvent=function(t,i){var n=u.Utils.getSpotCoords(t);return r(r(r({},this.commonFields),{now:u.Utils.getNowInSeconds(),et:"bid_matched",adix:t.adIndex,di:t.demandIndex,atix:t.attemptIndex,ot:n.top,rc:t.refresh.count,to:u.Utils.getTimeOffset(),st:t.type,b:i}),this.getSpotTags(t))},t.prototype.getFocusChangedEvent=function(t,i){return r(r(r({},this.commonFields),{now:u.Utils.getCurrentTime(!0),et:"focus_changed",if:t,to:this.getTimeOffset()}),i&&{opl:!0})},t.prototype.getAdInViewportEvent=function(t,i){return{now:u.Utils.getCurrentTime(!0),et:"ad_in_viewport",to:this.getTimeOffset(),pvid:this.commonFields.pvid,rc:t.refresh.count,atix:t.attemptIndex,adix:t.adIndex,ivp:i.toFixed(2)}},t.prototype.getDcsEvent=function(t,i){var n,e;return r(r(r({},this.commonFields),{now:u.Utils.getCurrentTime(!0),et:t,to:this.getTimeOffset(),pl:u.Utils.getPageHeight(),mi:(null===(e=null===(n=this.profile.layouts.spots)||void 0===n?void 0:n.dynamic)||void 0===e?void 0:e.maxItems)||0}),i)},t.prototype.getHBWinnerEvent=function(t,i,n){var e=s.Profiler.get(),o={n:i,s:[{br:n}]};return r({now:u.Utils.getNowInSeconds(),et:"hbw",pk:this.commonFields.pk,sk:this.commonFields.sk,dp:this.commonFields.dp,to:u.Utils.getTimeOffset(),url:e.identity.url,pvid:this.commonFields.pvid,adix:t.adIndex,di:t.demandIndex,st:t.type,atix:t.attemptIndex,rc:t.refresh.count,b:[o],scid:this.profile.identity.supplyConfigId},this.getSpotTags(t))},t.prototype.sendHBWinner=function(t,i){var n=this.getHBWinnerEvent(t,i.bidder,i.cpm);this.addToEventsQue("hb","hbw",[n])},t.prototype.sendAPSWinner=function(t){var i=this.getHBWinnerEvent(t,"aps",-1);this.addToEventsQue("hb","hbw",[i])},t.prototype.getAdMeasurableEvent=function(t,i,n,e){return r(r(r(r({},this.commonFields),{now:u.Utils.getNowInSeconds(),et:"measurable_impression",adix:t.adIndex,di:t.demandIndex,au:i||"NA",atix:t.attemptIndex,saas:n,pr:t.providerDisplayName||t.providerName||"NA",w:t.selectedSize?t.selectedSize.w:-1,h:t.selectedSize?t.selectedSize.h:-1,f:this.getFold(t),ot:u.Utils.getSpotCoords(t).top,pt:t.positionTypeToString(),ill:t.isLazyLoading,pw:u.Utils.getPageWidth(),rc:t.refresh.count||0,to:u.Utils.getTimeOffset(),dcs:t.isDcs,ul:u.Utils.getPageYOffset(),st:t.type}),e?{rsn:e}:{}),this.getSpotTags(t))},t.prototype.getStickyClosedEvent=function(t){var i,n={sk:(i=this.commonFields).sk,pk:i.pk,pvid:i.pvid,geo:i.geo,url:i.url,db:i.db,d:i.d,dp:i.dp,dos:i.dos,mv:i.mv};return r(r({},n),{now:u.Utils.getNowInSeconds(),et:"sticky_closed",adix:t.adIndex,di:t.demandIndex,pr:t.providerDisplayName||t.providerName||"NA",w:t.selectedSize?t.selectedSize.w:-1,h:t.selectedSize?t.selectedSize.h:-1,ot:u.Utils.getSpotCoords(t).top,pt:t.positionTypeToString(),rc:t.refresh.impressionsEventCount||0,to:u.Utils.getTimeOffset(),ul:u.Utils.getPageYOffset()})},t.prototype.getInframePlacementEvent=function(t){return{pc:t,to:u.Utils.getTimeOffset(),pvid:this.commonFields.pvid,sid:this.profile.identity.sessionId,et:"placements",mv:this.commonFields.mv,dos:this.profile.deviceDetails.os,sk:this.commonFields.sk,scid:this.profile.identity.supplyConfigId,dp:this.commonFields.dp,geo:this.commonFields.geo,db:this.commonFields.db}},t.prototype.getBillableEvent=function(t){return{now:u.Utils.getNowInSeconds(),to:u.Utils.getTimeOffset(),et:"billable_event",mv:this.commonFields.mv,pk:this.commonFields.pk,sk:this.commonFields.sk,dp:this.commonFields.dp,url:this.commonFields.url,pvid:this.commonFields.pvid,geo:this.profile.yieldData.countryCode,scid:this.profile.identity.supplyConfigId,pr:t.type,db:this.commonFields.db,ts:this.commonFields.ts,d:this.commonFields.d,dos:this.commonFields.dos}},t.prototype.sendError=function(t,i){this.profile.debugMode?this.logger.error(i):this.addToEventsQue("engineError",t,[i])},t.prototype.addToEventsQue=function(i,n,r){var s,o;this.isValidEventServerUrl&&(this.shouldThrottleEvent(i)?(this.eventsQue[i]=this.eventsQue[i]||[],(s=this.eventsQue[i]).push.apply(s,r),this.sendEventsThrottle()):this.send(i,r),t.addToFiredEvents(i,n,r),(o=this.logger).custom.apply(o,e([i+"/"+n,"background: #AAFF7F; color: black; font-weight: bold; text-decoration:underline; font-size: 18px;"],r)))},t.prototype.shouldThrottleEvent=function(t){return!!this.profile.siteInfo.bulkEventsThrottle&&!["engineError","supply"].includes(t)},t.prototype.flushEventsQue=function(){for(var t in this.eventsQue)if(this.eventsQue.hasOwnProperty(t)){var i=this.eventsQue[t]||[];i.length&&(this.send(t,i),this.eventsQue[t]=[])}},t.prototype.send=function(t,i){var n=new XMLHttpRequest;n.open("POST",""+this.eventServerUrl+t+"?p="+this.commonFields.pvid,!0),n.send(JSON.stringify(i))},t.prototype.sendBeacon=function(i,n,r,s){var o;return!(!window.navigator||"function"!=typeof window.navigator.sendBeacon||!navigator.sendBeacon(""+this.eventServerUrl+i+"?p="+this.commonFields.pvid,JSON.stringify(r)))&&(t.addToFiredEvents(i,n,r),(o=this.logger).custom.apply(o,e([i+"/"+n,"background: #AAFF7F; color: black; font-weight: bold; text-decoration:underline; font-size: 18px;"],r)),!0)},t.addToFiredEvents=function(i,n,r){t.firedEvents.has(i)||t.firedEvents.set(i,new Map);var e=t.firedEvents.get(i);e&&!e.has(n)&&e.set(n,[]);var s=e&&e.get(n);s&&s.push.apply(s,r)},t.prototype.buildCommonFields=function(){var t=s.Profiler.get();return{sk:t.identity.siteKey,pk:t.identity.publisherKey,pvid:t.identity.pageviewId,geo:t.yieldData.countryCode,r:t.referrer,bpvid:t.identity.bootstrapPageviewId,url:t.identity.url,dos:t.deviceDetails.os,dosv:t.deviceDetails.osVersion,dv:t.deviceDetails.deviceVendor,dbt:t.deviceDetails.browserType,iru:t.yieldData.isReturningUser,ibpv:t.identity.isBenchmarkPageview,ts:t.yieldData.trafficSource,db:t.deviceDetails.browser,d:t.deviceDetails.device,dp:t.deviceDetails.deviceType,mv:t.yieldData.version,scid:t.identity.supplyConfigId,res:t.deviceDetails.screenWidth+"x"+t.deviceDetails.screenHeight,aid:t.identity.articleId}},t.prototype.getTimeOffset=function(){return u.Utils.getCurrentTime(!1)-this.profile.identity.timeOffset},t.prototype.getFold=function(t){return t.isImpression&&t.browsiAd.container?t.browsiAd.iframe?u.Utils.getElementFoldNumber(t.browsiAd.iframe):u.Utils.getElementFoldNumber(t.browsiAd.container):u.Utils.getElementFoldNumber(t.ref)},t.prototype.getDcsEventData=function(t){void 0===t&&(t=a.DcsUtils.isDcs);var i=a.DcsUtils.getWindowObject();return r({dcs:t},t&&i?{ac:a.DcsUtils.getDcsActionCounter(),dcst:a.DcsUtils.dcsType}:{})},t.prototype.getViewedImpressionEventAV=function(t){return r(r(r({},this.commonFields),{now:u.Utils.getNowInSeconds(),et:"viewed_impression_av",adix:t.adIndex,di:t.demandIndex,au:t.adUnit||"NA",atix:t.attemptIndex,pr:t.providerDisplayName||t.providerName||"",w:t.selectedSize&&t.selectedSize.w?t.selectedSize.w:-1,h:t.selectedSize&&t.selectedSize.h?t.selectedSize.h:-1,f:this.getFold(t),ot:u.Utils.getSpotCoords(t).top,pt:t.positionTypeToString(),ill:t.isLazyLoading,rc:t.refresh.impressionsEventCount||0,to:u.Utils.getTimeOffset(),ul:u.Utils.getScrollPosition().top,st:t.type}),this.getSpotTags(t))},t.prototype.getViewedPublisherAdAv=function(t){return r(r({},this.commonFields),{now:u.Utils.getNowInSeconds(),et:"viewed_publisher_ad_av",rc:t.refreshCount,h:t.height,f:t.foldNum,ot:u.Utils.getElementPosition(t.element).top,to:u.Utils.getTimeOffset(),pt:t.positionType,pr:t.providerName,plid:t.placementId,au:t.adUnit,ill:t.isLazyLoaded,ul:u.Utils.getScrollPosition().top})},t.prototype.getErrorEvent=function(t,i,n,e){return r({et:t,msg:i,file:n,now:Math.floor(Date.now()/1e3),to:+new Date-this.profile.identity.timeOffset,lineNo:-1,columnNo:-1,ibpv:!1,r:this.commonFields.r,url:this.commonFields.url,d:this.commonFields.d,res:this.commonFields.res,bpid:this.profile.identity.bootstrapPageviewId,sk:this.profile.identity.siteKey,pk:this.profile.identity.publisherKey,uid:u.Utils.getUserID(),sid:this.profile.identity.sessionId,pvid:this.profile.identity.pageviewId,scid:this.profile.identity.supplyConfigId,geo:this.profile.yieldData.countryCode,ts:this.profile.yieldData.trafficSource,mv:this.profile.yieldData.version,iru:this.profile.yieldData.isReturningUser,db:this.profile.deviceDetails.browser,dbt:this.profile.deviceDetails.browserType,dp:this.profile.deviceDetails.deviceType,dv:this.profile.deviceDetails.deviceVendor,dos:this.profile.deviceDetails.os,dosv:this.profile.deviceDetails.osVersion},e?{error:e}:{})},t.prototype.getSpotTags=function(t){return{ptg:t.tags.positionTag,ttg:t.tags.typeTag}},t.prototype.getPlaceholderEvent=function(t,i,n){return r(r({now:u.Utils.getNowInSeconds(),et:i,mv:this.profile.yieldData.version,sk:this.profile.identity.siteKey,pk:this.profile.identity.publisherKey,di:t.demandIndex,st:t.type,dp:this.profile.deviceDetails.deviceType,to:u.Utils.getTimeOffset(),url:this.profile.identity.url,pvid:this.profile.identity.pageviewId,adix:t.adIndex,atix:t.attemptIndex,ul:u.Utils.getScrollPosition().top},this.getSpotTags(t)),n?{rsn:n}:{})},t.prototype.getBlankAdEvent=function(t,i,n,e){return r(r({},this.commonFields),r({now:u.Utils.getNowInSeconds(),to:u.Utils.getTimeOffset(),et:"blank",adix:t.adIndex,di:t.demandIndex,au:i||"NA",atix:t.attemptIndex,st:t.type,rc:t.refresh.count,rsn:n},e||{}))},t.prototype.getPublisherBlankAdEvent=function(t,i,n,e){return r(r({now:u.Utils.getNowInSeconds(),to:u.Utils.getTimeOffset(),et:"blank",rc:i,sk:this.profile.identity.siteKey,pk:this.profile.identity.publisherKey,pvid:this.profile.identity.pageviewId,dp:this.profile.deviceDetails.deviceType,mv:this.profile.yieldData.version,plid:t},e),{scid:this.profile.identity.supplyConfigId,rsn:n})},t.prototype.sendLoggerEvent=function(t){if(u.Utils.isBrowsiLoggerActive()){var i={adUnit:t.adUnit,spot:t};window.dispatchEvent(new CustomEvent("ad_impression",{detail:i}))}},t.prototype.sendInframePlacementEvent=function(t){var i=this.getInframePlacementEvent(t);this.addToEventsQue("inframe","placements",[i])},t.prototype.isValidURL=function(t){if(!t)return!1;try{return new URL("https://"+t),!0}catch(t){return!1}},t.firedEvents=new Map,t}();i.EventsService=l},9527:(t,i,n)=>{"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.FixedHeaderService=void 0;var r=n(125),e=n(2727),s=n(7730),o=function(){function t(){var t=this;this.observer=null,this.noneFixedHeight=0,this.fixedHeight=0,this.isFixedHeader=!1;var i=s.Profiler.get().spotEngineConfig.fixedHeader;if(this.logger=new r.Logger("FixedHeader"),i&&"function"==typeof window.MutationObserver){var n=i.s,o=e.Utils.getCurrentContextElement().querySelector(n);o&&(this.updateProperties(o),this.noneFixedHeight=i.h,this.observer=new MutationObserver((function(i){t.updateProperties(o)})),this.observer.observe(o,{attributes:!0}),this.logger.info("found header, watching ",o,i))}}return t.prototype.updateProperties=function(t){var i=this.isHeaderFixed(t);this.isFixedHeader!==i&&this.logger.debug("header fixed: "+i),this.isFixedHeader=i,this.fixedHeight=this.isFixedHeader?e.Utils.getElementSize(t).h:0},t.get=function(){return t._instance||(this._instance=new t),t._instance},t.prototype.getFixedHeaderSize=function(){return this.fixedHeight},t.prototype.getNoneFixedHeaderSize=function(){return this.isFixedHeader?this.noneFixedHeight:0},t.prototype.isHeaderFixed=function(t){return t&&e.Utils.isPositionFixed(t)},t}();i.FixedHeaderService=o},8614:(t,i,n)=>{"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.Focus=void 0;var r=n(125),e=n(1993),s=n(7730),o=n(514),u=function(){function t(){var t=this;this.logger=new r.Logger("Focus"),this.profile=s.Profiler.get(),this.isSubscribed=!0,this.isHidden="hidden"===document.visibilityState,this.isHidden&&e.EventsService.get().sendFocusChangedEvent(!1,!0),this.subscribe((function(i){t.onFocusChanged(i)})),this.waitForFocus=[]}return t.get=function(){return this.instance||(this.instance=new t),this.instance},t.prototype.subscribe=function(t){this.profile.debugMode&&this.listenToDemoVisibilityChange(t),o.default.get().listen("visibilitychange",document,(function(){t("hidden"===document.visibilityState)}))},t.prototype.unsubscribe=function(){return this.isSubscribed=!1,!0},t.prototype.waitForUserFocusWithAdBlock=function(t){return this.profile.spotEngineConfig.blockAdRequestOnOOF?(this.isHidden&&!t.adRequestBlockedSent&&e.EventsService.get().sendAdBlockedEvent(t,[{reason:"out_of_focus"}]),this.waitForUserFocus()):Promise.resolve()},t.prototype.waitForUserFocus=function(){var t=this;return new Promise((function(i){if(!t.isHidden)return i();t.waitForFocus.push(i)}))},t.prototype.onFocusChanged=function(t){var i=this;setTimeout((function(){var n="hidden"===document.visibilityState;if(t===n&&i.isHidden!==n){if(i.isHidden=n,!n)for(;i.waitForFocus.length;){var r=i.waitForFocus.shift();"function"==typeof r&&r()}i.logger.info("focus changed. in focus: "+!i.isHidden),e.EventsService.get().sendFocusChangedEvent(!n)}}),1e3)},t.prototype.listenToDemoVisibilityChange=function(t){var i=this;o.default.get().listen("demoVisibilityChange",document,(function(){i.isHidden=!!window._isHidden,t(i.isHidden)}))},t}();i.Focus=u},9792:(t,i,n)=>{"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=n(125),e=n(8614),s=function(){function t(t,i,n,e){void 0===n&&(n=[1e3]),this.timeouts=[],this.isInView=!1,this.logger=new r.Logger("IntersectionHandler"),this.element=t,this.threshold=i,this.observer=this.initObserver(),n=Array.from(new Set(n)),this.breakpoints=n.sort((function(t,i){return t-i})),this.callback=e}return t.prototype.initObserver=function(){var t=this,i={threshold:[this.threshold,Math.max(0,this.threshold-.01)]};return e.Focus.instance.subscribe((function(i){i?t.clearAllTimeouts():t.isInView&&t.setBreakpointsTimeouts()})),new IntersectionObserver(this.observationCallback.bind(this),i)},t.prototype.observe=function(){var t=this;return this.logger.info("observe ",this.element,"for threshold of "+this.threshold+" with breakpoint of "+this.breakpoints),this.observer.observe(this.element),new Promise((function(i){t.resolver=i}))},t.prototype.observationCallback=function(t){t[0].intersectionRatio>=this.threshold?(this.isInView=!0,this.setBreakpointsTimeouts()):(this.isInView=!1,this.clearAllTimeouts())},t.prototype.setBreakpointsTimeouts=function(){var t=this;this.breakpoints.forEach((function(i){t.timeouts.push(setTimeout((function(){var i=t.breakpoints.shift();t.callback(i),t.breakpoints.length||t.observationDone(i)}),i))}))},t.prototype.clearAllTimeouts=function(){this.timeouts.forEach((function(t){clearTimeout(t)}))},t.prototype.observationDone=function(t){this.logger.info(100*this.threshold+"% of the element",this.element,"was in view for "+t+" ms or more. stop observing"),this.clearObserver(),this.resolver()},t.prototype.clearObserver=function(){clearInterval(this.durationInterval),this.observer.unobserve(this.element),this.observer.disconnect()},t}();i.default=s},5310:(t,i,n)=>{"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=n(125),e=n(2727),s=n(7730),o=n(1993),u=n(514),a=n(3034),c=n(1128),h=n(3006),f=n(9490),d=function(){function t(){var t=this;this.logger=new r.Logger("Lazy"),this.profile=s.Profiler.get(),this.lazySpots=[],this.lazySpotsLocations=[],this.generalLazyConfig=this.profile.layouts.lazySpots,this.lazyStatus={lastPosition:-1,positionListenerActive:!1,expectedNextPosition:-1,scrollDirection:"up",previousTime:-1},this.lazySpotsListener=e.Utils.throttle((function(){return t.checkLocationAndFetch()}),100),this.fetchTime=this.buildFetchTime(),this.postMovementTimeoutActive=!1,this.serviceActive=!1,this.userPositionInterval=null}return t.get=function(){return t._instance||(this._instance=new t),t._instance},t.isLazyConfiguredForSpotType=function(t){if(!this.isSupportedSpotType(t.type))return!1;var i=a.SpotsUtils.getConf(t.tags);return!(!i||!i.lazyLoading)},t.isSupportedSpotType=function(t){return a.SpotsUtils.getOptimizeViewabilityTypes().includes(t)},t.prototype.getThresholdMidPoint=function(t){if(t.isLazyLoading){t.offsetTop=e.Utils.getElementPosition(t.ref).top;var i=this.getThresholdLocation(t);return Math.floor(t.offsetTop-.5*(t.offsetTop-i))}return e.Utils.getScrollingDistance()},t.prototype.isLazy=function(i){var n;if(i.isEagerFirstFold())return!1;if(!t.isSupportedSpotType(i.type))return!1;var r=null===(n=a.SpotsUtils.getConf(i.tags))||void 0===n?void 0:n.lazyLoading;return!!(this.generalLazyConfig&&r&&this.shouldCheckLazyLoad(i))&&(void 0===r.firstAdIndex||void 0===r.firstFold?(this.logger.error(i.type+" spot "+i.adIndex+" has an illegal configuration",r),!1):i.typeIndex>=r.firstAdIndex&&e.Utils.getElementFoldNumber(i.ref)>=r.firstFold)},t.prototype.shouldCheckLazyLoad=function(t){return t.type!==c.SpotType.STICKY&&this.fetchTime>-1},t.prototype.buildFetchTime=function(){return this.generalLazyConfig?this.generalLazyConfig.avgFetchTime:-1},t.prototype.subscribe=function(t,i){this.serviceActive||this.startService(),this.isSpotMissed(t)&&this.handleAdRequestBlock(t),t.offsetTop=e.Utils.getElementPosition(t.ref).top;var n=this.getThresholdLocation(t);this.logger.info(t.type+" spot "+t.typeIndex+" at "+t.offsetTop+" will start at "+n.toFixed(2)),this.lazySpots.push({spot:t,approvalsCount:0,thresholdLocation:n,fetchCallback:i}),this.lazySpotsLocations=this.lazySpots.sort((function(t,i){return t.spot.adIndex-i.spot.adIndex})).map((function(t){return{t:t.thresholdLocation,l:t.spot.offsetTop}})),this.fetchChecking()},t.prototype.unsubscribe=function(t){this.serviceActive&&this.lazySpots.length>0&&(this.logger.debug("Stopping subscription for "+t.length+" spots: ",t),this.lazySpots=this.lazySpots.filter((function(i){return!t.includes(i.spot)})),this.lazySpots.length||this.stopService())},t.prototype.getThresholdLocation=function(t){return t.offsetTop-e.Utils.getViewportHeight()*this.generalLazyConfig.threshold},t.prototype.stopService=function(t){var i;this.logger.info("stopping service"),u.default.get().removeListener("scroll",e.Utils.getScrollElement(),this.lazySpotsListener),this.userPositionInterval&&clearInterval(this.userPositionInterval),null===(i=this.thresholdMonitor)||void 0===i||i.stopMonitoring(),this.serviceActive=!1,t||(this.lazyStatus=this.getLazyStatus(!0),this.fetchChecking())},t.prototype.startService=function(){var t;this.logger.info("starting service"),this.lazyStatus=this.getLazyStatus(!0),u.default.get().listen("scroll",e.Utils.getScrollElement(),this.lazySpotsListener),this.startUserPositionInterval(),(null===(t=this.profile.layouts.lazySpots)||void 0===t?void 0:t.recalculateThreshold)&&(this.thresholdMonitor=this.ThresholdMonitor(),this.thresholdMonitor.startMonitoring()),this.serviceActive=!0},t.prototype.getLazyStatus=function(t){var i=e.Utils.getScrollPosition().bottom,n=Date.now(),r=t?0:i-this.lazyStatus.lastPosition,s=t?0:n-this.lazyStatus.previousTime,o=t||this.lazyStatus.lastPosition<=i?"down":"up",u=this.fetchTime/s;return{scrollDirection:o,expectedNextPosition:0===s?i:i+r*u,previousTime:n,lastPosition:i,positionListenerActive:!t&&this.lazyStatus.positionListenerActive}},t.prototype.checkLocationAndFetch=function(){this.lazyStatus.positionListenerActive||this.startUserPositionInterval(),this.fetchChecking()},t.prototype.startUserPositionInterval=function(){var t=this;this.lazyStatus=this.getLazyStatus(),this.lazyStatus.positionListenerActive||(this.userPositionInterval=window.setInterval((function(){if(t.lazyStatus=t.getLazyStatus(),t.logger.debug("direction: ",t.lazyStatus.scrollDirection.toString(),"at ",e.Utils.getScrollPosition().bottom.toFixed(2),"spots threshold: ",t.lazySpotsLocations),t.noMovement()&&!t.postMovementTimeoutActive){var i=t.lazyStatus.lastPosition;setTimeout((function(){t.postMovementTimeoutActive=!1,i===t.lazyStatus.lastPosition&&(t.userPositionInterval&&clearInterval(t.userPositionInterval),t.generalLazyConfig.staticUser&&t.fetchChecking(!0),t.lazyStatus.positionListenerActive=!1,t.logger.debug("positionInterval stopped, static user"))}),500),t.postMovementTimeoutActive=!0}}),100)),this.lazyStatus.positionListenerActive=!0,this.logger.debug("positionInterval started")},t.prototype.noMovement=function(){return this.lazyStatus.lastPosition===this.lazyStatus.expectedNextPosition},t.prototype.fetchChecking=function(t){var i=this;if("down"===this.lazyStatus.scrollDirection)for(var n=0,r=this.lazySpots;n<r.length;n++){var e=r[n];if(this.isSpotMissed(e.spot))this.handleAdRequestBlock(e.spot),this.zeroApprovalsCount(e);else if(this.isUserInThreshold(e)){if(this.logger.debug("user in threshold of "+e.spot.type+" spot "+e.spot.typeIndex,this.lazyStatus.lastPosition,e.spot.ref),this.isExpectedNextPositionOk(e)){if(e.approvalsCount++,this.approvalsTargetReached(e)||t){this.logger.info(e.spot.type+" spot "+e.spot.typeIndex+" is good for fetching ,"+e.approvalsCount+" /"+this.generalLazyConfig.approvalCount),e.fetchCallback();var s=this.lazySpots.indexOf(e);s>-1&&this.lazySpots.splice(s,1),this.lazySpots.length||this.stopService()}break}this.zeroApprovalsCount(e)}else this.zeroApprovalsCount(e)}else this.lazySpots.forEach((function(t){return i.zeroApprovalsCount(t)}))},t.prototype.isSpotMissed=function(t){return e.Utils.getElementPosition(t.ref).top<=this.lazyStatus.lastPosition},t.prototype.handleAdRequestBlock=function(t){if(!t.adRequestBlockedSent){this.logger.debug(t.type+" spot "+t.typeIndex+" at position "+e.Utils.getElementPosition(t.ref).top+" missed, current position: "+e.Utils.getScrollPosition().bottom);var i=[{reason:"lazy_ad_missed",message:""+e.Utils.getCurrentFoldDecimal()}];this.profile.layouts.lazySpots.collectPotentialViewability&&h.default.hasUserConsent&&f.PotentialViewabilityHandler.get().reportPotentialViewability(t,i),o.EventsService.get().sendAdBlockedEvent(t,i)}},t.prototype.zeroApprovalsCount=function(t){t.approvalsCount>0&&this.logger.debug("approval count reset"),t.approvalsCount=0},t.prototype.isUserInThreshold=function(t){var i=e.Utils.getElementPosition(t.spot.ref).top;return this.lazyStatus.lastPosition<i&&this.lazyStatus.lastPosition>t.thresholdLocation},t.prototype.isExpectedNextPositionOk=function(t){return this.lazyStatus.expectedNextPosition<e.Utils.getElementPosition(t.spot.ref).top},t.prototype.approvalsTargetReached=function(t){return this.logger.debug("approval count is now "+t.approvalsCount+" and approvalsCountTarget is "+this.generalLazyConfig.approvalCount,t.spot.ref),t.approvalsCount>=this.generalLazyConfig.approvalCount},t.prototype.ThresholdMonitor=function(){var t,i,n=this,r=function(){var t=document.body,i=document.documentElement;return Math.max(t.scrollHeight,t.offsetHeight,i.clientHeight,i.scrollHeight,i.offsetHeight)},e=r();return{startMonitoring:function(){window.ResizeObserver?(i=new ResizeObserver((function(){e=n.recalculateLazySpots(r,e)}))).observe(document.body):t=window.setInterval((function(){e=n.recalculateLazySpots(r,e)}),800)},stopMonitoring:function(){i?i.disconnect():clearInterval(t)}}},t.prototype.recalculateLazySpots=function(t,i){var n=this,r=t();return r!==i&&(i=r,this.lazySpots.forEach((function(t){n.reCalculateSpotThreshold(t)}))),i},t.prototype.reCalculateSpotThreshold=function(t){var i=e.Utils.getElementPosition(t.spot.ref).top;t.spot.offsetTop=i;var n=this.getThresholdLocation(t.spot);n-t.thresholdLocation>50&&(this.logger.info("spot "+t.spot.adIndex+" moved to "+i+"px and will start at "+n),t.thresholdLocation=n)},t}();i.default=d},514:(t,i,n)=>{"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=n(125),e=n(7730),s=function(){function t(){this.callbackMap={},this.logger=new r.Logger("ListenerService")}return t.get=function(){return this.instance||(this.instance=new t),this.instance},t.prototype.listen=function(t,i,n,r){var s,o;e.Profiler.get().identity.pageviewId===(null===(o=null===(s=window._middyo)||void 0===s?void 0:s.i)||void 0===o?void 0:o.pv)?i&&"function"==typeof i.addEventListener?(this.insert(t,{callback:n,listenObject:i}),i.addEventListener(t,n,r),this.logger.info("Listening to "+t+" on ",i)):this.logger.error("Failed listening to: ",i):this.logger.info("Pv changed, NOT Listening to "+t+" on ",i)},t.prototype.removeListener=function(t,i,n){if(i&&"function"==typeof i.removeEventListener){var r=this.findListener(t,n);n=r?r.callback:n,this.remove(t,{callback:n,listenObject:i}),i.removeEventListener(t,n),this.logger.info("Stopped listening to "+t+" on ",i)}else this.logger.error("Failed listening to: ",i)},t.prototype.listenToPbjs=function(t,i,n){var r,s=window._middyo;e.Profiler.get().identity.pageviewId===(null===(r=null==s?void 0:s.i)||void 0===r?void 0:r.pv)?i&&"function"==typeof i.onEvent?(this.insert(t,{callback:n,listenObject:i}),i.onEvent(t,n),this.logger.info("Listening to pbjs "+t+" on ",i)):this.logger.error("Failed listening to pbjs: ",i):this.logger.info("Pv changed, NOT Listening to "+t+" on ",i)},t.prototype.removePbjsListener=function(t,i,n){if(i&&"function"==typeof i.offEvent){var r=this.findListener(t,n);n=r?r.callback:n,this.remove(t,{callback:n,listenObject:i}),i.offEvent(t,n),this.logger.info("Stopped listening to pbjs "+t+" on ",i)}else this.logger.error("Failed listening to pbjs: ",i)},t.prototype.removeAll=function(){var t=this,i=function(i){n.callbackMap.hasOwnProperty(i)&&(n.callbackMap[i].forEach((function(n){if("removeEventListener"in n.listenObject)(r=n).listenObject.removeEventListener(i,r.callback);else if("offEvent"in n.listenObject){var r;(r=n).listenObject.offEvent(i,r.callback)}else t.logger.debug("could not remove callback",n);t.logger.info("Stopped listening to "+i+" on ",n.listenObject)})),n.callbackMap[i]=[])},n=this;for(var r in this.callbackMap)i(r)},t.prototype.findListener=function(t,i){return this.callbackMap[t]&&this.callbackMap[t].find((function(t){return t.callback===i}))},t.prototype.insert=function(t,i){this.callbackMap.hasOwnProperty(t)||(this.callbackMap[t]=[]),this.callbackMap[t].push(i)},t.prototype.remove=function(t,i){if(this.callbackMap.hasOwnProperty(t)){var n=this.callbackMap[t].find((function(t){return t.callback.toString()===i.callback.toString()&&t.listenObject===i.listenObject}));if(null!=n){var r=this.callbackMap[t].indexOf(n);r>-1&&this.callbackMap[t].splice(r,1)}}},t}();i.default=s},4949:(t,i,n)=>{"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=n(125),e=n(1993),s=n(2727),o={childList:!0,subtree:!0},u=function(){function t(t,i){this.logger=new r.Logger("MeasurableImpressions"),this.spot=t,this.nonFriendlyFound=0,this.rootFrames=[],this.secLevelFrames=[],this.adUnit=i}return t.prototype.waitForSpotMeasurable=function(){var t=this;if(this.spot.browsiAd&&this.spot.browsiAd.wrapper){if(this.rootFrames=this.scanAllFrames(this.spot.browsiAd.wrapper),this.rootFrames.forEach((function(i){t.secLevelFrames=t.secLevelFrames.concat(t.scanAllFrames(i))})),0==this.nonFriendlyFound&&!this.adFramesFound())return void this.waitForIframe();if(this.nonFriendlyFound>0&&!this.adFramesFound())return void this.sendEvent("non-friendly iframes");this.promiseAll(this.rootFrames.concat(this.secLevelFrames))}},t.prototype.sendEvent=function(t){this.spot.isMeasurable||(this.spot.isMeasurable=!0,e.EventsService.get().sendAdMeasurableEvent(this.spot,this.adUnit,this.spot.isSaas,t))},t.prototype.adFramesFound=function(){return this.secLevelFrames.length>0||(!this.spot.browsiAd||!this.spot.browsiAd.iframe)&&this.rootFrames.length>0},t.prototype.promiseAll=function(t){var i=this,n=t.map((function(t){return i.waitForIframeLoad(t)}));Promise.all(n).then((function(t){t.filter((function(t){return!t.status||"complete"!=t.status})).length||(i.logger.debug("send measurable event after frames scan for spot ",i.spot.adIndex," iframes scaned ",t," nonFriendly found ",i.nonFriendlyFound),i.sendEvent("all frames loaded"))})).catch((function(t){return i.logger.error("measurable no iframe loaded found ",t)}))},t.prototype.waitForIframeLoad=function(t){var i=this;return new Promise((function(n,r){var e=t.contentDocument||t.contentWindow.document;i.isIframeLoaded(e)?n({status:"complete",frame:t}):t.onload=function(i){n({status:"complete",frame:t})}}))},t.prototype.isIframeLoaded=function(t){return"complete"==t.readyState&&null!=t.querySelector("head")&&t.querySelector("head").childNodes.length>0&&null!=t.querySelector("body")&&t.querySelector("body").childNodes.length>0},t.prototype.scanAllFrames=function(t){var i=s.Utils.querySelectorOnDocument(t,"iframe"),n=i.filter((function(t){return s.Utils.isFriendlyIframe(t.element)}));return this.nonFriendlyFound+=i.length-n.length,n.map((function(t){return t.element}))},t.prototype.waitForIframe=function(){var t=this;this.observer=new MutationObserver((function(i){return t.handleMutationFound(i)})),this.rootFrames.length?this.rootFrames.forEach((function(i){t.observer.observe(i.contentDocument||i.contentWindow.document,o)})):this.spot.browsiAd&&this.spot.browsiAd.wrapper&&this.observer.observe(this.spot.browsiAd.wrapper,o)},t.prototype.handleMutationFound=function(t){var i=this;if(t.forEach((function(t){Array.from(t.addedNodes).forEach((function(t){"IFRAME"==t.nodeName&&i.secLevelFrames.push(t)}))})),this.secLevelFrames.length){this.logger.info("Observer destroyed");var n=this.secLevelFrames.filter((function(t){return s.Utils.isFriendlyIframe(t)}));n.length?this.promiseAll(n):this.sendEvent("non-friendly iframes")}},t}();i.default=u},979:(t,i,n)=>{"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=n(125),e=n(2727),s=n(9235),o=n(7730),u=function(){function t(){this.titleSelectors=["h1","h2","h3","h4","h5","h6","header"],this.oneLineSelectors=["span","div","p"],this.minDistance=60,this.logger=new r.Logger("ContentTitle"),this.excludeElements=this.getExcludeElements(o.Profiler.get().spotEngineConfig.pageLayoutSA.ex),this.titlesOnPage=this.collectTitles(),this.logger.debug("titles",this.titlesOnPage),this.titlesLocations=this.getLocations(this.titlesOnPage),this.oneLinersOnPage=this.collectOneLiners(),this.logger.debug("one liners",this.oneLinersOnPage),this.oneLinersLocations=this.getLocations(this.oneLinersOnPage)}return t.get=function(){return t.instance||(this.instance=new t),t.instance},t.prototype.collectTitles=function(t){var i=this;return Array.from((t||document).querySelectorAll(this.titleSelectors.join(","))).filter((function(t){return e.Utils.isVisible(t)&&s.default.instance.isInMainContent(t)&&!i.isExcluded(t)}))},t.prototype.collectOneLiners=function(){var t,i=this,n=null===(t=o.Profiler.get().domData)||void 0===t?void 0:t.mainContent.inputElements;return(n&&n.length?n:[]).reduce((function(t,n){var r=.4*e.Utils.getElementSize(n).w;return t.concat(Array.from(n.querySelectorAll(i.oneLineSelectors.join(","))).filter((function(t){return i.isOneLine(t,r)})))}),[])},t.prototype.isOneLine=function(t,i){return e.Utils.isVisible(t)&&t.offsetHeight<24&&t.offsetWidth>i&&t.innerText.trim().length>0&&!this.isExcluded(t)},t.prototype.getLocations=function(t){var i=this;return t.map((function(t){return i.getBottomOffset(t)})).filter((function(t){return t>0})).sort((function(t,i){return t-i}))},t.prototype.isTitle=function(t){return-1!=this.titlesOnPage.indexOf(t)},t.prototype.isCollectedOneLine=function(t){return-1!=this.oneLinersOnPage.indexOf(t)},t.prototype.isBetweenTitleAndContent=function(t){var i=e.Utils.getElementPosition(t).top;if(i<1)return!1;if(this.isTitle(t)){var n=this.getBottomOffset(t),r=this.titlesLocations.indexOf(n);if(r&&this.titlesLocations[r-1])return i-this.titlesLocations[r-1]<this.minDistance}for(var s=this.titlesLocations.length;s>=0;s--)if(i>=this.titlesLocations[s])return i-this.titlesLocations[s]<this.minDistance;return!1},t.prototype.isAfterOneLiner=function(t){var i=e.Utils.getElementPosition(t).top;if(i<1)return!1;if(this.isCollectedOneLine(t)){var n=this.getBottomOffset(t),r=this.oneLinersLocations.indexOf(n);if(r&&this.oneLinersLocations[r-1])return i-this.oneLinersLocations[r-1]<this.minDistance}for(var s=this.oneLinersLocations.length;s>=0;s--)if(i>=this.oneLinersLocations[s])return i-this.oneLinersLocations[s]<this.minDistance;return!1},t.prototype.getBottomOffset=function(t){return e.Utils.getElementPosition(t).top+e.Utils.getElementSize(t).h},t.prototype.getExcludeElements=function(t){return t&&t.length?Array.from(document.querySelectorAll(t.join(","))):[]},t.prototype.isExcluded=function(t){var i=-1!=this.excludeElements.indexOf(t);return i&&this.logger.debug("element is excluded from page auto layout stay away by config",t),i},t}();i.default=u},6102:(t,i,n)=>{"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=n(125),e=n(9792),s=n(1128),o=n(2727),u=n(1993),a=n(2362),c=function(){function t(t){this.logger=new r.Logger("PlaceholderService"),this.size=t,this.active=!1}return t.prototype.openPlaceholder=function(t){t.browsiAd.container&&(this.active=!0,this.observer=new e.default(t.browsiAd.container,.25,[1e3],(function(){u.EventsService.get().sendPlaceholderViewed(t)})),this.observer.observe())},t.prototype.stopObserving=function(){var t;null===(t=this.observer)||void 0===t||t.clearObserver(),this.observer=void 0},t.prototype.closePlaceholder=function(t,i){if(i.browsiAd.container&&this.active){var n="none"===i.browsiAd.container.style.display;n||i.type===s.SpotType.STICKY||!this.isChangingViewport(i.browsiAd)?(this.deactivatePlaceholder(),u.EventsService.get().sendPlaceholderClosed(i,n?"other":"browsi"),t&&a.Embedder.removeAdFromDom(i)):this.logger.debug("placeholder changes viewport, keep open")}},t.prototype.isChangingViewport=function(t){var i=t.iframe||t.container;return o.Utils.getElementPosition(i).top<o.Utils.getScrollPosition().bottom},t.prototype.removePlaceholderStyle=function(t){var i=t.container;i.style.removeProperty("width"),i.style.removeProperty("height"),i.style.removeProperty("margin"),i.style.removeProperty("background-color"),this.deactivatePlaceholder()},t.prototype.deactivatePlaceholder=function(){this.active=!1,this.stopObserving()},t}();i.default=c},7730:function(t,i,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(t){for(var i,n=1,r=arguments.length;n<r;n++)for(var e in i=arguments[n])Object.prototype.hasOwnProperty.call(i,e)&&(t[e]=i[e]);return t},r.apply(this,arguments)},e=this&&this.__spreadArrays||function(){for(var t=0,i=0,n=arguments.length;i<n;i++)t+=arguments[i].length;var r=Array(t),e=0;for(i=0;i<n;i++)for(var s=arguments[i],o=0,u=s.length;o<u;o++,e++)r[e]=s[o];return r};Object.defineProperty(i,"__esModule",{value:!0}),i.Profiler=void 0;var s=n(2727),o=n(125),u=n(1128),a=n(3034),c=n(7463),h=n(5701),f=function(){function t(t){this._profile=this.buildProfile(t,this.getRules(t)),window._middyo.pvid=this._profile.identity.pageviewId}return t.rebuild=function(i){return this.instance=new t(i),this.instance._profile},t.prototype.getRules=function(i){var n=i.externalFlowHandler&&i.externalFlowHandler.preEngine||t.preEngineRef;if(n){t.preEngineRef=n;try{t.logger.info("initiating rules"),n(i)}catch(i){t.logger.error("failed to initiating rules",i)}return i.externalFlowHandler}},t.get=function(){return t.instance||(t.instance=new t(s.Utils.getLoaderParams())),t.instance._profile},t.setLoadTime=function(t){this.get().loadTime=t-this.get().identity.timeOffset},t.collectDOMData=function(){var i,n,r,e,o,u,a,c=window._middyo,f=((null===(i=c.sec.mc)||void 0===i?void 0:i.s)?s.Utils.querySelectorAll(c.sec.mc.s,t.errorCallback):[]).filter((function(t){return s.Utils.isVisible(t)})),d=s.Utils.querySelectorAll((null===(r=null===(n=c.sec.ux)||void 0===n?void 0:n.sk)||void 0===r?void 0:r.c)||[],t.errorCallback),l=s.Utils.querySelectorInsideElements(["div[style*=float] + p, img[style*=float]+p, iframe[style*=float] + p"],f,t.errorCallback),v=this.getWidthForEmbed(f[0]),p=c.sec.mc&&c.sec.mc.t?c.sec.mc.t:500,m=!!(t.get().layouts.wrapAroundText&&v>=p),w=t.get().layouts.allowNarrowBreak,b=(null===(o=null===(e=c.ly)||void 0===e?void 0:e.in)||void 0===o?void 0:o.ds)||[],g=(null===(a=null===(u=t.get().layouts.spots)||void 0===u?void 0:u.dynamic)||void 0===a?void 0:a.wrapperStyle)||h.DEFAULT_SPOT_STYLE,_=this.buildAdSizes(v,b,w,m,g);return{mainContent:this.buildMainContent(f,v,p,c),stayAwayElements:[],skippedElements:d,dynamicCompatibleSizes:_,foundFloatElements:l,allowNarrowWrap:m}},t.prototype.getUxFixes=function(t){var i;return{dynamicIframeSize:null===(i=t.uxfx)||void 0===i?void 0:i.dis}},t.buildMainContent=function(t,i,n,r){var e=r.sec.mc,o=e&&e.u,u={start:-1,width:-1,widthThreshold:n,endPosition:-1,inputElements:[],firstElement:null,lastElement:null,borderElement:null};if(t.length){var a=null;e.e&&(a=s.Utils.querySelector(e.e[0],this.errorCallback));var c=s.Utils.querySelector(o,this.errorCallback)||t[0],h=t[t.length-1];u={start:s.Utils.getElementPosition(c).top,width:i,widthThreshold:n,endPosition:a?s.Utils.getElementPosition(a).top:s.Utils.getElementPosition(h).top+h.getBoundingClientRect().height,inputElements:t,firstElement:c,lastElement:h,borderElement:a}}return u},t.buildAdSizes=function(t,i,n,r,e,o){var u=this,a=[],c=s.Utils.getAdMarkingExpectedHeight();return i.forEach((function(i){if(t>=i.w||s.Utils.isFluidSize(i)){var h=u.buildCompatibleSize(t,i,c,n,r,e,o);h&&a.push(h)}})),a},t.buildCompatibleSize=function(t,i,n,r,e,s,o){var u=this.getAdSizeType(i);return{w:i.w,h:i.h,adSizeType:u,minSizeForWrapping:s?this.calculateValidHeights(i,t,n,s):-1,optionalEmbeddings:o&&a.SpotsUtils.getRailsTypes().includes(o)?["break"]:this.getEmbedTypes(u,i.h,r,e)}},t.getAdSizeType=function(t){return s.Utils.isFluidSize(t)?"wide":t.w<=400?"narrow":"wide"},t.getEmbedTypes=function(t,i,n,r){var e=[];return"narrow"==t?(i<=400&&n&&e.push("break"),r&&e.push("wrapped")):e.push("break"),e},t.calculateValidHeights=function(t,i,n,r){var e=s.Utils.getWrapFullSize(t,r);return e.h+=n,e.h-e.h*e.w/i},t.validateProfileForBehavior=function(t,i,n){if(!n)return[];var r=t.mainContent.inputElements,e=n.elements,o=n.allowedCreativeSizes,a=[];if(n.stopInFold&&n.startInFold&&n.startInFold>n.stopInFold&&n.stopInFold>0&&a.push("startIF/stopIF_Violation"),i===u.SpotType.DYNAMIC_MC&&0===r.length)a.push("No_Main_Content_Found");else if(0===e.length&&a.push("No_Elements_For_Scan"),0===o.length&&a.push("No_compatibleSizes"),i===u.SpotType.DYNAMIC_MC){var c=t.skippedElements,h=!0;r.forEach((function(t){h&&!c.some((function(i){return i===t||s.Utils.isDescendantElement([i],t)}))&&(h=!1)})),h&&a.push("Main_Content_Inside_Skipped")}return a},t.prototype.getAdMarkingConfiguration=function(t){if(t){var i={text:t.t,expectedHeight:0};return t.c?i.color=t.c:t.s&&(i.customStyle=t.s),i.expectedHeight=s.Utils.calculateAdMarkingHeight(i),i}},t.getPotentialSpots=function(t,i,n){var r=this.collectTargetElements(t,i);return n&&s.Utils.isDescendantElement(i,n)&&(r=s.Utils.removeElementsPositionedAfter(n,r)),r},t.prototype.getDcsConfig=function(i){if(i&&"script"!==i.t){if(i.t&&i.s&&i.s.length){var n=i.s.reduce((function(t,i){return i&&t.push({type:i.t,elementSelector:i.s1,containerSelector:i.s2,value:i.v}),t}),[]);return{type:i.t,steps:n,urlChange:i.u,delay:i.d,rescanRails:!!i.r}}t.logger.error("bad DCS configuration",i)}},t.prototype.getPubAdsRefreshConfig=function(i,n){if(i){if(i.c&&i.r&&i.l&&i.t)return{active:!0,adIdType:i.t,adIds:i.l,refreshCount:i.c,refreshRate:i.r,dfpOnly:i.d,sendRefreshKV:i.kv,customPbjsName:n,usingMagnite:i.um};t.logger.error("bad PubAdsConfig configuration",i)}},t.collectTargetElements=function(t,i){var n=[];t.length&&(n=i.reduce((function(i,n){return i.concat(Array.from(n.querySelectorAll(""+t.toString())).filter((function(t){return s.Utils.isVisible(t)})))}),[]));var r=i.reduce((function(t,i){return t.concat(Array.from(i.querySelectorAll("p")).filter((function(t){return s.Utils.isVisible(t)&&!s.Utils.isDescendantElement(n,t)})))}),[]),o=e(r,n).sort((function(t,i){return s.Utils.isPositionedAfter(t,i)?1:-1}));return s.Utils.toUnique(o)},t.detectAdBlocker=function(i){t.adBlockerExists?i():new Promise((function(i,n){function r(){"undefined"===window.adblockDetector?i(!1):window.adblockDetector.init({debug:t.get().debugMode,found:function(){i(!0)},notFound:function(){i(!1)}})}var e=document.createElement("script");e.src=t.get().adBlockerDetectionUrl,e.setAttribute("crossorigin","anonymous"),e.onload=r,e.onerror=r,document.body.appendChild(e)})).then((function(n){t.adBlockerExists=n,t.logger.custom("Ad Blocker Detected: "+n,s.Utils.getLogStyle(18,"black","green")),i()}))},t.prototype.buildProfile=function(t,i){var n,r,e,o=s.Utils.getScreenSize();return{debugMode:!!t.debug,runMode:t.m,identity:{siteKey:t.i.sk,publisherKey:t.i.pk,userId:t.i.u,sessionId:t.i.s,pageviewId:t.i.pv,isBenchmarkPageview:t.r.b,bootstrapPageviewId:t.bpvi,supplyConfigId:t.i.sc,url:encodeURIComponent(location.protocol+"//"+location.host+location.pathname),timeOffset:t.to,articleId:t.i.aid},yieldData:{isBenchmarked:t.r.b,countryCode:t.r.cc,trafficSource:t.r.ts,isReturningUser:t.r.ru,version:t.ses.v,eventServerUrl:t.r.es,host:t.yhn},deviceDetails:{browser:t.dt.b,device:t.dt.d,deviceType:t.dt.p,os:t.dt.os,osVersion:t.dt.osv,screenWidth:o.w,screenHeight:o.h,browserType:t.dt.bt,deviceVendor:t.dt.v},spotEngineConfig:{embedType:t.sec.et,adMarking:this.getAdMarkingConfiguration(t.sec.adm),publisherAdsMinDistance:t.sec.dad,railsPublisherAdsMinDistance:t.sec.rdad,isLazySAActive:t.sec.lsa,tryInsideTables:!!t.sec.ti,dcs:this.getDcsConfig(t.sec.dcs),useNewStayAwayCalc:!!t.sec.sapc,stayAwayConfigs:(null===(n=t.sec.ux)||void 0===n?void 0:n.sa)||[],mainContentConfig:t.sec.mc,pageLayoutSA:t.sec.plsa,fixedHeader:t.sec.fh,wrappingAdditionalElements:t.sec.wae||[],blockAdRequestOnOOF:t.sec.barof,targetSelectors:t.sec.ts||[],rails:t.sec.rl},layouts:this.getLayouts(t.ly),siteInfo:{adInViewport:t.si.aiv,activeView:!!t.si.av,blockLineItemIds:t.si.bli,prebidData:t.si.pd,prebidPath:t.si.pd.p,billableEvents:t.si.be,bulkEventsThrottle:t.si.bet,sendBlankAdReport:t.si.bar,sendBrowsiImpressionDOMEvent:t.si.bi,demandHost:t.si.dh},referrer:encodeURIComponent(window.document.referrer),state:"bootstrap_loaded",adBlockerDetectionUrl:t.sec.abd,rules:i,isUserEngaged:!1,logEngagement:t.ses.le,browsiViewability50Key:t.si.v50,pageKeyValues:t.ly.pgkv,pubAdsRefresh:this.getPubAdsRefreshConfig((null===(r=t.pub)||void 0===r?void 0:r.r)||void 0,(null===(e=t.si.pd)||void 0===e?void 0:e.g)||void 0),userAnonymousContinent:t.r.cl,reportResponseTime:{active:t.si.rrt,timers:t.td},dcsState:t.dcss&&this.getDcsState(t.dcss),sendViewabilityCheckpoints:!!t.ly.vc}},t.getWidthForEmbed=function(t){var i=t?t.getBoundingClientRect().width:-1;if(s.Utils.isElement(t)){var n=window.getComputedStyle(t);n.paddingLeft&&n.paddingRight&&(i-=parseFloat(n.paddingLeft)+parseFloat(n.paddingRight))}return i},t.prototype.getLayouts=function(t){var i,n,r;return{potentialSpots:t.ps,analysisMode:!!t.am,lazySpots:this.convertLayoutLazyConfig(t.ll),wrapAroundText:!!(null===(i=t.in)||void 0===i?void 0:i.w),allowNarrowBreak:void 0===(null===(n=t.in)||void 0===n?void 0:n.anb)||!!(null===(r=t.in)||void 0===r?void 0:r.anb),spots:this.getLayoutSpots(t),placeholder:t.ph,eagerFirstFold:t.eff,fixedSpotsFirst:!!t.fsf,uxFixes:this.getUxFixes(t),moatPercentage:t.mp,useWebVitals:t.wv,sendPrebidBillableEvents:!!t.spbe,publisherAdMoat:{browsiIdOnly:!!t.padm.bio,percentage:t.padm.p},inframe:t.inf}},t.prototype.getLayoutSpots=function(t){return{dynamic:this.convertLayoutDynamicConfig(t.in,t.ps),fixedBottom:this.convertLayoutFixedConfig(t.b),fixedMC:this.convertLayoutFixedConfig(t.in),fixedTop:this.convertLayoutFixedConfig(t.t),rails:this.convertRailsLayout(t.r,t.ps),api:this.convertLayoutApiSpot(t),sticky:this.convertLayoutStickySpot(t.s)}},t.prototype.convertLayoutDynamicConfig=function(t,i){var n;if(null==t?void 0:t.dy)return r(r(r({},this.convertInContentSpot(t)),this.convertFoldConfig(t)),{distance:t.d,maxItems:t.dy.dmi,maxSpots:Math.max(t.dy.dmi,i||0),additionalSizes:[],elements:[],targetElements:[],viewabilityThreshold:null===(n=t.ov)||void 0===n?void 0:n.vt,startInFoldSelectors:t.sfs})},t.prototype.convertLayoutFixedConfig=function(t){var i;if(null==t?void 0:t.fi)return r(r(r(r({},this.convertScannedSpot(t)),this.convertFoldConfig(t)),{maxItems:-1,maxSpots:-1,elements:[],targetElementPosition:t.fi.tep,targetElements:t.fi.ds,viewabilityThreshold:null===(i=t.ov)||void 0===i?void 0:i.vt}),t.sfs?{startInFoldSelectors:t.sfs}:{})},t.prototype.convertScannedSpot=function(t){var i,n;return{allowedCreativeSizes:t.ds||[],engagedUsers:(null===(i=t.ov)||void 0===i?void 0:i.eu)||!1,style:t.st,wrapperStyle:new h.default(t.st).getSize(),lazyLoading:(null===(n=t.ov)||void 0===n?void 0:n.ll)?{firstAdIndex:t.ov.ll.fai,firstFold:t.ov.ll.ff}:void 0}},t.prototype.convertFoldConfig=function(t){return{startInFold:t.start||0,stopInFold:t.stop||0}},t.prototype.convertInContentSpot=function(t){return r(r({},this.convertScannedSpot(t)),{startInFold:t.start,stopInFold:t.stop})},t.prototype.convertLayoutStickySpot=function(t){if(t)return{location:t.l,allowedCreativeSizes:t.ds||[],closeButton:!!t.cb,style:t.st,wrapperStyle:new h.default(t.st).getSize(),useOriginalSizes:!!t.uos}},t.prototype.convertLayoutApiSpot=function(t){var i=this;if(t){var n={};return["in","t","b","s","r"].forEach((function(e){var s,o,u=t[e];u&&("r"===e&&(e=(null==u?void 0:u.p)===c.RailsSides.RIGHT?"r":"l"),n[e]=r({sizes:u.ds||[],viewabilityOptimizationBlocklist:(null===(s=u.api)||void 0===s?void 0:s.vob)||[],positionIds:null===(o=u.api)||void 0===o?void 0:o.ids,targetElementPosition:t.atep||"INSIDE",style:u.st,wrapperStyle:new h.default(u.st).getSize()},i.getOptimizationParams(u))),n[e]||(n[e]={sizes:[],targetElementPosition:"INSIDE"})})),n}},t.prototype.convertRailsLayout=function(t,i){var n,e,s,o,u,a;if(t)return r(r(r(r({},this.convertInContentSpot(t)),this.convertFoldConfig(t)),{distance:t.d,maxItems:(null===(n=t.dy)||void 0===n?void 0:n.dmi)||0,maxSpots:Math.max((null===(e=t.dy)||void 0===e?void 0:e.dmi)||0,i||0),additionalSizes:[],elements:[],targetElements:(null===(s=t.fi)||void 0===s?void 0:s.ds)||[],viewabilityThreshold:null===(o=t.ov)||void 0===o?void 0:o.vt,railSide:t.p}),(null===(u=t.fi)||void 0===u?void 0:u.tep)?{targetElementPosition:null===(a=t.fi)||void 0===a?void 0:a.tep}:{})},t.prototype.convertLayoutLazyConfig=function(t){var i={avgFetchTime:t.aft,approvalCount:t.ac,staticUser:t.su,threshold:t.t,collectPotentialViewability:t.cpvd,recalculateThreshold:t.rct};return t.m||(i.autoThreshold=t.d),i},t.prototype.getOptimizationParams=function(t){var i,n=null===(i=t)||void 0===i?void 0:i.ov;if(n)return r({engagedUsers:n.eu,viewabilityThreshold:n.vt},n.ll?{lazyLoading:{firstAdIndex:n.ll.fai,firstFold:n.ll.ff}}:{})},t.prototype.getDcsState=function(t){return{count:t.c,mainContentElement:t.mc,saObjects:t.sao,articleSelectors:t.as,previousSpots:t.pps,parentPageView:t.ppv}},t.logger=new o.Logger("Profiler"),t.errorCallback=function(i){return t.logger.error(i)},t.preEngineRef=null,t}();i.Profiler=f},9394:(t,i,n)=>{"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=n(125),e=n(9790),s=n(2727),o=n(7730),u=n(1993),a=n(2362),c=n(9235),h=n(3271),f=n(2057),d=n(7631),l=n(4029),v=n(5490),p=n(8939),m=n(4647),w=n(4869),b=function(){function t(){var t;this._foundAds=[],this.logger=new r.Logger("ProvidersDetector"),this._foundAds=[],this.profile=o.Profiler.get(),this.profile.siteInfo.billableEvents===v.BillableEventType.AD_REQUEST&&(this.billableEvents=new v.BillableEvents(this.profile.browsiViewability50Key,null===(t=this.profile.siteInfo.prebidData)||void 0===t?void 0:t.g))}return t.get=function(){return this.instance||(this.instance=new t),this.instance},Object.defineProperty(t.prototype,"foundAds",{get:function(){return this._foundAds},enumerable:!1,configurable:!0}),t.prototype.shouldInjectMoat=function(t){return Math.floor(100*Math.random())<t},t.prototype.injectPublisherAdMoat=function(t,i){var n=this.profile.layouts.publisherAdMoat,r=n.percentage,e=n.browsiIdOnly;r&&(e?(null==i?void 0:i.getTargeting("browsiId").length)&&this.shouldInjectMoat(r)&&s.Utils.injectMoat(t,!1):this.shouldInjectMoat(r)&&s.Utils.injectMoat(t,!1))},t.prototype.addIfNew=function(t,i,n,r){var e=t.element;if(!(!r&&this.isDetectedAlready(e)||a.Embedder.isEmbeddedByBrowsi(e))){var o=s.Utils.getElementPosition(e).top,c=this.resolveElementSize(e,n),h=this.getAdPositionType(e),d=-1!=h.indexOf("sticky")||-1!=h.indexOf("interstitial")?-1:s.Utils.getElementFoldNumber(e),v=0;if(r){var p=this._foundAds.find((function(t){return t.element===e}));p&&(v=++p.refreshCount)}var m={providerName:t.providerName,positionType:h,element:e,topPos:o,foldNum:d,width:c.w,height:c.h,placementId:t.placementId,adUnit:t.adUnit,isLazyLoaded:t.isLazyLoaded,refreshCount:v,refreshType:r,gamResponseInfo:s.Utils.getGAMResponseInfo(i)},b=f.default.get().getFoundPublisherAdData(m.providerName,"manual_ad"===m.providerName?e.id:t.placementId,m.refreshCount,i);m=this.updateFoundAdFromBptData(m,b),this.foundAds.push(m),this.logger.info("Found provider on page: "+t.providerName+"("+c.w+"x"+c.h+")",e);var g=this.isBillableEvent(m.providerName,i);g&&this.handleBillableEvent(i,m.placementId,m.adUnit,m.refreshCount),this.profile.siteInfo.sendBlankAdReport&&this.checkBlankAd(i,m),this.injectPublisherAdMoat.apply(this,[m.element,i]);var _=!1;return"browsi"===m.refreshType&&this.profile.siteInfo.sendBrowsiImpressionDOMEvent&&(_=this.sendBrowsiImpressionDOMEvent(m)),u.EventsService.get().sendPublisherAdFound(m,b,g,_),w.ViewabilityService.get().subscribe(this.buildViewabilityServiceObject(m,n,i)),"dfp"===m.providerName&&i&&l.default.get().waitForPublisherAV(i,m),h}},t.prototype.sendBrowsiImpressionDOMEvent=function(t){var i={element:t.element,adUnit:t.adUnit,refreshCount:t.refreshCount};return s.Utils.dispatchDOMEvent(m.BROWSI_IMPRESSION_DOM_EVENT_NAME,i)},t.prototype.checkBlankAd=function(t,i){var n=this,r=new p.BlankAdReportService,e=i.element;r.checkForBlankAd(e).then((function(r){if(r.isBlank){n.logger.info("Publisher blank ad found:",r.reason,e);var o=s.Utils.getGAMResponseInfo(t);u.EventsService.get().sendPublisherBlankAdEvent(i.placementId,i.refreshCount,r.reason,o)}})).catch((function(t){n.logger.info("Publisher blank ad check failure:",t,e)}))},t.prototype.updateFoundAdFromBptData=function(t,i){return t.placementId=i.plid,"manual_ad"===t.providerName&&(t.adUnit=i.plid),t},t.prototype.buildViewabilityServiceObject=function(t,i,n){var r=i&&i.w*i.h>=242500?30:50,e=this.generateInViewActionsMap(),o={type:1,conf:{minViewInitiator:r,duration:1e3,shouldReportOneTime:!0},getCoords:function(){return s.Utils.getElementPosition(t.element)},getHeight:function(){return s.Utils.getElementSize(t.element).h},refreshInfo:{shouldRefresh:function(){return!1},rate:0,doRefresh:function(){}},sendViewedImpression:function(i){return u.EventsService.get().sendViewedPublisherAd(t,i)},root:function(){return t},element:t.element,inViewActionsMap:e},a=d.PubAdsRefreshService.get();if(n&&a){var c=a.getViewabilityRefreshInfo(t,o,n);Object.assign(o,{refreshInfo:c},{inViewActionsMap:this.generateInViewActionsMap(c)})}return o},t.prototype.getAdPositionType=function(t){var i=[],n=s.Utils.getElementSize(t),r=s.Utils.getElementPosition(t);if(s.Utils.isPositionFixed(t)&&n.w>.85*this.profile.deviceDetails.screenWidth&&n.h>.85*this.profile.deviceDetails.screenHeight)return i.push("interstitial"),i;if(s.Utils.isPositionFixed(t)&&i.push("sticky"),this.profile.domData&&this.profile.domData.mainContent.inputElements&&this.profile.domData.mainContent.start>-1){for(var e=this.profile.domData.mainContent,o=e.inputElements[0].getBoundingClientRect().width,u=s.Utils.getElementPosition(e.inputElements[0]).left,a=0,c=r.left,h=c+n.w,f=r.top,d=0;d<e.inputElements.length;d++)u=Math.min(u,s.Utils.getElementPosition(e.inputElements[d]).left),a=Math.max(a,u+o);this.logger.debug("MC start: "+e.start+",MC end: "+e.endPosition+",\n\t\t\tarticle offset left: "+u+", article offset right "+a+",ad offset right "+h+",\n\t\t\tad offset left "+c+", ad offset top "+f+", MC elements:",e.inputElements),c>=u&&h<=a?i.push("in-line"):(c<u&&h<=u&&i.push("left rail"),c>=a&&i.push("right rail")),-1==i.indexOf("sticky")&&(f<e.start&&i.push("top"),f>e.endPosition&&i.push("bottom")),-1!=i.indexOf("in-line")&&-1==i.indexOf("sticky")&&-1==i.indexOf("bottom")&&-1==i.indexOf("top")&&i.push("within main content"),0===i.length&&f>=e.start&&f<=e.endPosition&&i.push("within main content")}else i.push("out of main content");return i},t.prototype.scan=function(t){return t&&e.default.start(),this.foundAds},t.prototype.addFoundProvider=function(t,i,n,r){var e=this.addIfNew(t,i,n,r);if(e){var s=this.buildSaObject(t,e);c.default.instance.upsertStayAwayElement(t.element,s,t.isLazyLoaded)}return!!e},t.prototype.buildSaObject=function(t,i){var n,r="dfp"===t.providerName?this.getMinDistance(i):(null===(n=o.Profiler.get().layouts.spots.dynamic)||void 0===n?void 0:n.distance)||0,e="pubAd";return{config:{d:r,v:[e],t:this.buildStayAwayTargetByAdPosition(i)},sa:{element:t.element,distance:r,selector:e}}},t.prototype.getMinDistance=function(t){var i=t.includes("right rail")||t.includes("left rail"),n=o.Profiler.get().spotEngineConfig.railsPublisherAdsMinDistance;return i&&"number"==typeof n?n:o.Profiler.get().spotEngineConfig.publisherAdsMinDistance},t.prototype.buildStayAwayTargetByAdPosition=function(t){var i=[],n=["bottom","top","within main content"];return t.some((function(t){return n.includes(t)}))&&i.push(h.SATargets.TOP,h.SATargets.BOTTOM,h.SATargets.MC),t.includes("right rail")&&i.push(h.SATargets.RIGHT),t.includes("left rail")&&i.push(h.SATargets.LEFT),i},t.prototype.isDetectedAlready=function(t){return!!this.foundAds.some((function(i){return i.element===t}))||!!s.Utils.isDescendantElement(this.foundAds.map((function(t){return t.element})),t)||this.foundAds.some((function(i){return s.Utils.isDescendantElement([t],i.element)}))},t.prototype.resolveElementSize=function(t,i){if(i)return i;var n=t.getBoundingClientRect();return{w:n.width,h:n.height}},t.prototype.isBillableEvent=function(t,i){return!!(i&&this.billableEvents&&["dfp","header_bidding"].includes(t)&&this.billableEvents.isSlotInjectedPrediction(i))},t.prototype.handleBillableEvent=function(t,i,n,r){if(this.billableEvents){var e={placement_id:i,site_key:this.profile.identity.siteKey,publisher_key:this.profile.identity.publisherKey,bill_type:v.BillableEventType.AD_REQUEST,ad_unit:n,page_view_id:this.profile.identity.pageviewId,refresh_count:r};this.billableEvents.dispatchBillableEvent(e),this.billableEvents.removePredictionFromSlot(t)}},t.prototype.generateInViewActionsMap=function(t){var i={};return i=w.ViewabilityService.get().addActionToMap(["event"],[1e3],i),(null==t?void 0:t.rate)&&(i=w.ViewabilityService.get().addActionToMap(["refresh"],[t.rate],i)),i},t}();i.default=b},7631:function(t,i,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(t){for(var i,n=1,r=arguments.length;n<r;n++)for(var e in i=arguments[n])Object.prototype.hasOwnProperty.call(i,e)&&(t[e]=i[e]);return t},r.apply(this,arguments)};Object.defineProperty(i,"__esModule",{value:!0}),i.PubAdsRefreshService=void 0;var e=n(125),s=n(7730),o=n(2727),u=n(1993),a=n(6319),c=n(2057),h=function(){function t(t){this.googletag=o.Utils.getExistsOrNewGoogletag(),this.apstag=window.apstag,this.pubAdsData=[],this.logger=new e.Logger("PubadsRefresh"),this.profile=s.Profiler.get(),this.config=t,this.pbjsInstanceName=this.config.customPbjsName||"pbjs",this.pbjsInstance=this.getPbjs();var i=a.DcsUtils.getCurrentPvsObject();this.pubAdsData=i&&i.data.pad||[],this.vendor=t.usingMagnite?"magnite":"prebid"}return t.get=function(){if(t.instance)return t.instance;var i=s.Profiler.get().pubAdsRefresh;return i&&(t.instance=new t(i))},t.prototype.findMatchAd=function(t,i,n){var r=this;"magnite"===this.vendor?this.pbjsInstance&&this.pbjsInstance.rp&&(this.pbjsInstance.rp.adUnitPatterns.find((function(n){return r.isMatchAdUnitPattern(n,t,i)}))?n.isValidMagnite=!0:(n.isValidMagnite=!1,this.logger.info("Couldn't find valid magnite match"))):this.pbjsInstance&&this.pbjsInstance.adUnits&&(n.adUnit=this.pbjsInstance.adUnits.find((function(n){return[i,t].includes(n.code)})))},t.prototype.isMatchAdUnitPattern=function(t,i,n){return!(t.divPattern&&!i.match(t.divPattern)||t.slotPattern&&!n.match(t.slotPattern))},t.prototype.preparePubadsRefresh=function(t,i){var n=this,r=this.findExistingAdData(i);r&&r.refreshInfo.active&&this.isAllowedLineItemId(i).then((function(){n.runPreRefresh(i,r).then((function(){r.refreshInfo.requested=!0,n.logger.info("preparing refresh for adData",r),n.pbjsInstance=n.getPbjs();var t=i.getAdUnitPath(),e=i.getSlotElementId();n.findMatchAd(e,t,r),n.refreshBid(r)}))})).catch((function(i){n.logger.error("pubadsRefresh rejected slot refresh:",i),"liIdBl"===i&&(r.refreshInfo.active=!1,u.EventsService.get().sendPubAdRefreshBlockedEvent(t.placementId,r.refreshInfo.count,t.positionType,i))}))},t.prototype.runPreRefresh=function(t,i){var n=this;return new Promise((function(r,e){var s="prePubadsRefresh",u=o.Utils.getExternalFlowHandler(s);if(u){n.logger.info("invoking "+s);try{t.getSlotElementId(),i.refreshInfo.count,u(t,i,r,e)}catch(t){n.logger.error(s+" failed",t),r()}}else r()}))},t.prototype.refreshBid=function(t){var i=this;if(!t.slot||!t.element)return!1;var n=this.getAdSize(t.element);return this.attachSizeMapping(n,t.slot),this.handleKVs(t),t.refreshInfo.count++,this.sendRefreshRequestEvent(t),this.googletag.cmd=this.googletag.cmd||[],this.googletag.cmd.push((function(){var r=i.createHbPromise(t),e=i.createAmazonPromise(t.slot,n);Promise.all([r,e]).then((function(n){i.logger.debug("refreshing dfp "+n),t.slot.setCollapseEmptyDiv(!1),googletag.pubads().refresh([t.slot])}))})),!0},t.prototype.handleKVs=function(t){var i=this.getTargeting(t.slot);t.slot.clearTargeting(),Object.keys(i).forEach((function(n){n.indexOf("hb_")+n.indexOf("amzn")===-2&&t.slot&&t.slot.setTargeting(n,i[n])})),this.config.sendRefreshKV&&t.slot.setTargeting("browsiRefresh","pubtrue")},t.prototype.createHbPromise=function(t){var i=this;return new Promise((function(n,r){var e=i.getPbjs();!function(n){return!(!n||!t.adUnit&&!t.isValidMagnite||i.config.dfpOnly)}(e)?n():(i.logger.debug("refreshing with pbjs"),e.que=e.que||[],e.que.push((function(){"magnite"==i.vendor?e.rp?e.rp.requestBids({callback:function(){n("magnite")},gptSlotObjects:[t.slot]}):n():t.adUnit&&e.requestBids({adUnitCodes:[t.adUnit.code],bidsBackHandler:function(){t.slot&&(e.setTargetingForGPTAsync([t.adUnit.code]),n("pbjs"))}})})))}))},t.prototype.createAmazonPromise=function(t,i){var n=this;return new Promise((function(r){if(!n.apstag||"function"!=typeof n.apstag.fetchBids||n.config.dfpOnly)return r();var e=t.getSlotElementId(),s={slotID:e,slotName:t.getAdUnitPath(),sizes:[[i.w,i.h]]};n.apstag.fetchBids({slots:[s]},(function(t){var i=t.find((function(t){return t.slotID===e}));return n.logger.info("amazon bid: ",i),n.logger.apsLog(e,i),n.apstag.setDisplayBids(),r("amazon")}))}))},t.prototype.handleRenderEnded=function(t){if(this.config.active){var i=this.findExistingAdData(t.slot);if(i)if(t.isEmpty)this.logger.debug("refresh for adData:",i,"returned empty. disabling refresh for this slot."),i.refreshInfo.active=!1;else{if(i.refreshInfo.requested)return this.logger.debug("refresh for adData:",i,"ended successfully"),i.refreshInfo.requested=!1,!0;this.logger.debug("adData:",i,"was forced refresh. disabling refresh for this slot."),i.refreshInfo.active=!1}}return!1},t.prototype.sendRefreshRequestEvent=function(t){t.viewabilityObject&&u.EventsService.get().sendPubAdRefreshRequest(t.viewabilityObject.root(),t.refreshInfo.count,"browsi")},t.prototype.findExistingAdData=function(t){return this.pubAdsData.find((function(i){return i.slot===t}))},t.prototype.getOrCreateAdData=function(t,i,n){var r=this.findExistingAdData(t);return r||(r=this.createAdData(t,i)),r},t.prototype.getAdData=function(t,i,n){var r=this.findExistingAdData(t);if(this.checkConditions(t,r))return r||(r=this.createAdData(t,i)),r.viewabilityObject=n,r},t.prototype.createAdData=function(t,i){var n={slot:t,element:i,refreshInfo:{active:!0,requested:!1,count:0}};return this.pubAdsData.push(n),n},t.prototype.checkConditions=function(t,i){if(i&&!i.refreshInfo.active)return!1;var n=[];!this.isWhitelisted(t)&&n.push("not in whitelist"),i&&i.refreshInfo.count===this.config.refreshCount&&n.push("refresh count "+i.refreshInfo.count+" passed limit "+this.config.refreshCount);var r=!n.length;return this.logger.debug("checkConditions for",t.getSlotElementId(),"result ? ",r||n),r},t.prototype.isAllowedLineItemId=function(t){var i=s.Profiler.get();if(i.siteInfo.blockLineItemIds){var n=o.Utils.getRefreshAPIParams(t);if(0===Object.keys(n).length)return Promise.resolve();var e=r(r({},n),{sk:i.identity.siteKey,dt:"desktop"}),u="//"+i.yieldData.host+"/bli?"+o.Utils.toUrlParams(e);return o.Utils.xhrPromise(u,"GET").then((function(t){return 202===t.status?Promise.reject("liIdBl"):Promise.resolve()}))}return Promise.resolve()},t.prototype.getViewabilityRefreshInfo=function(t,i,n){var r=this;if(this.config&&this.config.active){var e=this.getAdData(n,t.element,i);return{shouldRefresh:function(){return!(!e||!e.refreshInfo.active)},rate:this.config.refreshRate,doRefresh:function(){r.preparePubadsRefresh(t,n)}}}return i.refreshInfo},t.prototype.isWhitelisted=function(t){switch(this.config.adIdType){case"AD_UNIT":var i=t.getAdUnitPath();return this.config.adIds.includes(i);case"PLACEMENT":var n=t.getSlotElementId();return this.config.adIds.includes(n);case"MACRO":var r=c.default.get().getFoundPublisherAdData("dfp",t.getSlotElementId(),0,t);if(r&&r.plid)return this.config.adIds.includes(r.plid)}return!1},t.prototype.deactivate=function(){this.config.active=!1},t.prototype.getAdSize=function(t){var i=o.Utils.getDfpAdSize(t);return i||(i={size:o.Utils.getElementSize(t),element:t}),i.size},t.prototype.attachSizeMapping=function(t,i){var n=googletag.sizeMapping().addSize([0,0],[t.w,t.h]).build();i.defineSizeMapping(n),this.logger.debug("attachedSizeMapping",n)},t.prototype.getTargeting=function(t){return t.getTargetingMap?t.getTargetingMap():t.getTargeting()},t.prototype.getPbjs=function(){return window[this.pbjsInstanceName]},t.prototype.getSlotWinner=function(t){var i=t.getHtml();return i.indexOf("renderAd")>-1?"prebid":i.indexOf("renderImp")>-1?"amazon":"dfp"},t}();i.PubAdsRefreshService=h},4269:(t,i,n)=>{"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=n(125),e=n(514),s=function(){function t(t){this.resizeRAF=null,this.resizeListeners=[],this.isIE=null!=navigator.userAgent.match(/Trident/),this.resizeElement=t,this.obj=document.createElement("object"),this.logger=new r.Logger("ResizeListener"),this.logger.debug("set resize listener for",t)}return t.prototype.resizeListener=function(t){var i=this;this.resizeRAF&&window.cancelAnimationFrame(this.resizeRAF),this.resizeRAF=window.requestAnimationFrame((function(){i.resizeListeners.forEach((function(n){n.call(i.obj,t)}))}))},t.prototype.objectLoad=function(){var t,i=(null===(t=this.obj.contentDocument)||void 0===t?void 0:t.defaultView)||null;i&&(e.default.get().listen("resize",i,this.resizeListener.bind(this)),this.resizeListener.bind(this))},t.prototype.addResizeListener=function(t){this.resizeListeners.length||("static"==getComputedStyle(this.resizeElement).position&&(this.resizeElement.style.position="relative"),this.obj.setAttribute("style","display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; pointer-events: none; z-index: -999;"),this.obj.onload=this.objectLoad.bind(this),this.obj.type="text/html",this.isIE&&this.resizeElement.appendChild(this.obj),this.obj.data="about:blank",this.isIE||this.resizeElement.appendChild(this.obj)),this.resizeListeners.push(t)},t.prototype.removeResizeListener=function(t){var i,n;t?null===(i=this.resizeListeners)||void 0===i||i.splice(this.resizeListeners.indexOf(t),1):this.resizeListeners=[],!this.resizeListeners.length&&(null===(n=this.obj.contentDocument)||void 0===n?void 0:n.defaultView)&&(this.obj.contentDocument.defaultView.removeEventListener("resize",this.resizeListener),this.resizeElement.removeChild(this.obj))},t}();i.default=s},9235:(t,i,n)=>{"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=n(125),e=n(3271),s=n(2727),o=n(9394),u=n(1128),a=n(7730),c=n(6319),h=n(3034),f=n(4603),d=function(){function t(){var t=this;this.profile=a.Profiler.get(),this.logger=new r.Logger("SAService"),this.spots=[],this.errorCallback=function(i){return t.logger.error(i)},this.mainContentElements=this.profile.spotEngineConfig.mainContentConfig&&this.profile.spotEngineConfig.mainContentConfig.s?s.Utils.querySelectorAll(this.profile.spotEngineConfig.mainContentConfig.s,this.errorCallback):[],this.mainContentEndElement=this.profile.spotEngineConfig.mainContentConfig&&this.profile.spotEngineConfig.mainContentConfig.e?s.Utils.querySelector(this.profile.spotEngineConfig.mainContentConfig.e[0],this.errorCallback):null,this.stayAwayConfigs=this.profile.spotEngineConfig.stayAwayConfigs||[],this.maxSaDistance=this.stayAwayConfigs.reduce((function(t,i){return t.d<i.d?i:t}),{v:[""],d:0}).d,this.stayAwayElements=[],this.scanDomForSA()}return Object.defineProperty(t,"instance",{get:function(){return this._instance||(this._instance=new t),this._instance},enumerable:!1,configurable:!0}),t.prototype.setSpots=function(t){this.spots=t},t.prototype.getStayAwayElementsList=function(){return this.stayAwayElements.map((function(t){return{element:t.element,distance:t.distance,selector:t.selector,inMainContent:t.inMainContent,target:t.target}}))},t.prototype.scanDomForSA=function(){var t=this;this.logger.info("scanDomForSA"),this.upsertSaFromDcs(),this.stayAwayConfigs.forEach((function(i){i.v.forEach((function(n){var r=s.Utils.querySelectorAll([n],t.errorCallback);t.handleStayAwayConfig(r,i,n)}))}));var i=a.Profiler.get().domData;i&&(i.stayAwayElements=this.getStayAwayElementsList())},t.prototype.upsertSaFromDcs=function(){var t,i=this,n=null===(t=a.Profiler.get().dcsState)||void 0===t?void 0:t.saObjects,r=c.DcsUtils.getIfEndless();(n=n||(null==r?void 0:r.pvs[r.count-1].data.sAE))&&n.forEach((function(t){var n="__FROM LAST PV DCS__",r={sa:{element:t.element,distance:t.distance,selector:n},config:{d:0,v:[n],t:t.target}};i.upsertStayAwayElement(t.element,r,!1)}))},t.prototype.scanDomForLazySA=function(t,i,n){var r=this;this.logger.info("re-scanning dom for SA");var e=s.Utils.getPositionFallback(t);this.stayAwayConfigs.forEach((function(t){t.v.forEach((function(o){var u=s.Utils.querySelectorAll([o],r.errorCallback).filter((function(s){return r.shouldStayAwayFrom(s,e,i,n,t.t)}));r.handleStayAwayConfig(u,t,o,!0)}))}))},t.prototype.handleStayAwayConfig=function(t,i,n,r){var e=this;t.map((function(t){return{sa:{element:t,distance:i.d,selector:n},config:i}})).forEach((function(t){e.upsertStayAwayElement(t.sa.element,t,!!r)}))},t.prototype.shouldStayAwayFrom=function(t,i,n,r,e){return-1!==this.mapSATarget(e).indexOf(r)&&Math.abs(s.Utils.getPositionFallback(t)-i)<=this.maxSaDistance&&(!n||s.Utils.isDescendantElement(this.mainContentElements,t))},t.prototype.upsertStayAwayElement=function(t,i,n){if(!["__FROM LAST PV DCS__","pubAd"].includes(i.config.v[0])&&!h.SpotsUtils.isValidHeightForSkipSa(t))return this.logger.debug(t,"is over 80% of page height, ignore it"),null;var r=this.isInMainContent(t),e=this.stayAwayElements.find((function(i){return i.element===t}));if(e)return this.updateSaElement(t,e,r),null;var s=this.insertSaElement(t,i,n,r);return this.handleIfManualAd(i,s,n),void 0!==i.config.v?this.logger.debug(n?"Lazy ":"","Added",s,"By Config: ",i):this.logger.debug(n?"Lazy ":"","Added",s),s},t.prototype.updateSaElement=function(t,i,n){var r=Object.assign({},i),e=this.isSaValid(t);!i.isValid&&e&&(i.isLazy=!0),i.top=this.getPositionFromTop(t),i.height=t.getBoundingClientRect().height,i.isValid=e,i.inMainContent=n,r.top===i.top&&r.height===i.height&&t.style.display===i.element.style.display||this.logger.debug("Updated: ",r," TO: ",i)},t.prototype.insertSaElement=function(t,i,n,r){var e=t.getBoundingClientRect(),s={element:t,top:this.getPositionFromTop(t),height:e.height,distance:i.sa.distance,isLazy:n,inMainContent:r,isValid:this.isSaValid(t),isPubAd:"pubAd"===i.config.v[0],target:i.config.t,selector:i.sa.selector};return this.stayAwayElements.push(s),s},t.prototype.mapSATarget=function(t){var i=[];return t.includes(e.SATargets.MC)&&i.push(u.SpotType.FIXED_MC,u.SpotType.DYNAMIC_MC),t.includes(e.SATargets.TOP)&&i.push(u.SpotType.FIXED_TOP),t.includes(e.SATargets.BOTTOM)&&i.push(u.SpotType.FIXED_BOTTOM),t.includes(e.SATargets.RIGHT)&&i.push(u.SpotType.DYNAMIC_RIGHT_RAIL,u.SpotType.FIXED_RIGHT_RAIL),t.includes(e.SATargets.LEFT)&&i.push(u.SpotType.DYNAMIC_LEFT_RAIL,u.SpotType.FIXED_LEFT_RAIL),i},t.prototype.getPositionFromTop=function(t){return this.profile.spotEngineConfig.useNewStayAwayCalc?s.Utils.getPositionFallback(t):s.Utils.getElementPosition(t).top},t.prototype.isSaValid=function(t){return s.Utils.isVisible(t)&&!s.Utils.isPositionFixed(t)},t.prototype.validateSa=function(t){return!this.profile.spotEngineConfig.useNewStayAwayCalc||t.isValid},t.prototype.isElementContainedInSa=function(t,i){return!!this.profile.spotEngineConfig.useNewStayAwayCalc&&s.Utils.isPositionContained(t,i)},t.prototype.checkStayAwayViolation=function(t){if(t.tags.typeTag===f.TypeTag.FIXED&&this.profile.layouts.fixedSpotsFirst)return null;a.Profiler.get().spotEngineConfig.isLazySAActive&&(this.logger.debug("Checking SA from newly added elements (lazy)"),this.scanDomForLazySA(t.ref,t.type===u.SpotType.DYNAMIC_MC,t.type));var i=this.isStayAwayForAllEmbedTypes(t.ref,t.getCompatibleSizes(),t.type===u.SpotType.DYNAMIC_MC,t.type);return"invalid"===i.status?{reason:"stay_away",message:i.message}:null},t.prototype.isStayAwayForAllEmbedTypes=function(t,i,n,r){var e=s.Utils.getEmbedTypesFromSizes(i),o=e.includes("break"),u=e.includes("wrapped");if(o){var a=this.isStayAwayElement(t,n,r);if("invalid"===a.status)return a;if(u)return this.checkWrapSA(t,i,n,r)}else if(u)return this.checkWrapSA(t,i,n,r);return{status:"valid"}},t.prototype.checkWrapSA=function(t,i,n,r){for(var e,s=i.length;s--;)if("invalid"===(e=this.removeViolatingWrappedEmbeddings(t,i[s],n,r)).status&&i.splice(s,1),0===i.length)return e;return{status:"valid"}},t.prototype.removeViolatingWrappedEmbeddings=function(t,i,n,r){var e=i.optionalEmbeddings.indexOf("wrapped");if(e>-1){var s=this.isStayAwayElement(t,n,r,i);if("invalid"===s.status)return i.optionalEmbeddings.splice(e,1),i.selectedEmbedding&&(i.selectedEmbedding="break"),i.optionalEmbeddings.length>0?{status:"valid"}:s}return{status:"valid"}},t.prototype.isStayAwayElement=function(t,i,n,r){var e=this,o=this.stayAwayElements.find((function(o){if(o.isPubAd&&h.SpotsUtils.isFixedSpot(n)||-1===e.mapSATarget(o.target).indexOf(n))return!1;if(!e.validateSa(o)||!s.Utils.isElement(o.element))return!1;if(i&&!o.inMainContent)return!1;if(e.isElementContainedInSa(o.element,t))return!0;var a=s.Utils.calculateDistanceBetween(t,o.element);s.Utils.isPositionedAfter(t,o.element)&&(a+=s.Utils.getAdMarkingExpectedHeight());var c=0;return s.Utils.isPositionedAfter(o.element,t)&&(c+=s.Utils.getWrappingOffset(t,o.element,u.SPOT_TAGS_MAP[n],r),c+=s.Utils.isPositionContained(t,o.element)?0:t.getBoundingClientRect().height),a+c<=o.distance}));return this.getViolationStatus(o)},t.prototype.getViolationStatus=function(t){return t&&t.element?{status:"invalid",message:t.isPubAd?"pub_ad":"stay_away",element:t.element}:{status:"valid"}},t.prototype.isInMainContent=function(t){return s.Utils.isDescendantElement(this.mainContentElements,t)},t.prototype.handleIfManualAd=function(t,i,n){if(t.config.adn){if(s.Utils.getElementSize(t.sa.element).h<=25)return void this.logger.info("ignoring sa ad element, height <= 25",t.sa.element);var r=this.getManualAdId(t);i.isPubAd=!0;var e={element:t.sa.element,providerName:t.config.adn,placementId:r,adUnit:r,isLazyLoaded:n,isManualAd:!0};o.default.get().addIfNew(e)}},t.prototype.getManualAdId=function(t){return t.sa.element.id||t.sa.selector},t}();i.default=d},5879:(t,i,n)=>{"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.SRAResponseManager=void 0;var r=n(1128),e=n(125),s=n(5310),o=n(2727),u=function(){function t(t,i){this.logger=new e.Logger("SRAResponseManager"),this.response=t,this.allowedIndexesByType={}}return t.prototype.updateResponse=function(t){o.Utils.mergeDeep(this.response,t)},t.prototype.pop=function(t,i){var n=t.selector,r=this.getAllowedIndexes(t.type,n);return r.adIndex<=t.adIndex?(t.demandIndex=r.demandIndex,s.default.get().unsubscribe([t]),r.demandIndex++,r.adIndex=t.adIndex,this.logger.info(t.type+" spot "+t.typeIndex+" matched demand "+t.demandIndex,i),i):(this.logger.info("Couldn't match "+t.type+" spot "+t.typeIndex+" to response",i),null)},t.prototype.peek=function(t){var i,n=this.getResponseGroupByType(t.type),r=t.selector,e=this.getAllowedIndexes(t.type,r).demandIndex,s=this.isFixedResponseGroup(n,r)?n[r][e]:n[e];return s?(s.od=this.getPrediction(t),t.adUnit=this.isHBDemandConfig(s.c)?null===(i=s.c.d)||void 0===i?void 0:i.aup:s.c.aup||"NA",s):(this.logger.debug("No available demand response for "+t.type+" spot "+t.typeIndex),null)},t.prototype.isHBDemandConfig=function(t){return!!t.d},t.prototype.getAllowedIndexes=function(t,i){return this.allowedIndexesByType[t]=this.allowedIndexesByType[t]||{},i=i||"dynamic",this.allowedIndexesByType[t][i]=this.allowedIndexesByType[t][i]||{demandIndex:0,adIndex:0},this.allowedIndexesByType[t][i]},t.prototype.getResponseGroupByType=function(t){switch(t){case r.SpotType.FIXED_BOTTOM:return this.response.fb;case r.SpotType.FIXED_TOP:return this.response.ft;case r.SpotType.API:return this.response.ac;case r.SpotType.DYNAMIC_LEFT_RAIL:case r.SpotType.DYNAMIC_RIGHT_RAIL:return this.response.dr;case r.SpotType.FIXED_LEFT_RAIL:case r.SpotType.FIXED_RIGHT_RAIL:return this.response.fr;case r.SpotType.DYNAMIC_MC:return this.response.c;case r.SpotType.FIXED_MC:return this.response.fc;default:return{}}},t.prototype.isFixedResponseGroup=function(t,i){return!!i},t.prototype.getPrediction=function(t){return this.response.ods&&this.response.ods[t.adIndex]},t}();i.SRAResponseManager=u},4869:(t,i,n)=>{"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.ViewabilityService=void 0;var r=n(125),e=n(2727),s=n(9792),o=function(){function t(){this.logger=new r.Logger("Viewability"),this.isHidden=!1,this.ads=[]}return t.get=function(){return t._instance||(this._instance=new t),t._instance},t.prototype.subscribe=function(t){this.removePublisherAdDuplicate(t),this.insert(t)},t.prototype.insert=function(t){this.ads.push(t),this.initViewabilityCheck(t)},t.prototype.removePublisherAdDuplicate=function(t){var i,n;if(1===t.type){var r=t.root(),e=this.ads.findIndex((function(t){return r&&r.placementId===t.root().placementId}));if(-1!=e){var s=this.ads.splice(e,1)[0];null===(i=s.observer)||void 0===i||i.clearObserver(),null===(n=s.observer)||void 0===n||n.clearAllTimeouts()}}},t.prototype.initViewabilityCheck=function(t){var i=this,n=t.inViewActionsMap,r=Object.keys(n).map(Number);t.observer=new s.default(t.element,t.conf.minViewInitiator/100,r,(function(n){i.onAdIsInView(t,n)})),t.observer.observe().then((function(){i.removeFromAdsArray(t)}))},t.prototype.onAdIsInView=function(t,i){var n=t.inViewActionsMap[i];n.includes("refresh")&&this.handleRefresh(t,i),n.includes("event")&&(this.logger.info(t.element,"with threshold "+t.conf.minViewInitiator+"% is in view for "+i+' perform "event" action'),t.sendViewedImpression(e.Utils.getPercentageInView(t.element)))},t.prototype.handleRefresh=function(t,i){var n,r;t.refreshInfo.shouldRefresh()&&i>=t.refreshInfo.rate&&(this.logger.info(t.element+" has been in view for "+i+" ms. Starting to refresh"),this.removeFromAdsArray(t),null===(n=t.observer)||void 0===n||n.clearObserver(),null===(r=t.observer)||void 0===r||r.clearAllTimeouts(),t.refreshInfo.doRefresh())},t.prototype.removeFromAdsArray=function(t){var i=this.ads.indexOf(t);i>-1&&this.ads.splice(i,1)},t.prototype.inViewPercentage=function(t,i){var n=i||e.Utils.getScrollPosition(),r=t.getCoords().top,s=t.getHeight();if(n.top<=r&&n.bottom>r){var o=n.bottom-r;return 100*Math.min(Number(o/s),1)}return n.top>r&&n.top<r+s?(o=r+s-n.top,100*Math.min(Number(o/s),1)):0},t.prototype.unsubscribe=function(t){var i=this.ads.find((function(i){return i.root()===t}));i&&(this.unObserveAd(i),this.removeFromAdsArray(i))},t.prototype.addActionToMap=function(t,i,n){return i.forEach((function(i){var r;n[i]=n[i]||[],(r=n[i]).push.apply(r,t)})),n},t.prototype.unObserveAd=function(t){var i;null===(i=t.observer)||void 0===i||i.clearObserver()},t}();i.ViewabilityService=o},6393:function(t,i,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(t){for(var i,n=1,r=arguments.length;n<r;n++)for(var e in i=arguments[n])Object.prototype.hasOwnProperty.call(i,e)&&(t[e]=i[e]);return t},r.apply(this,arguments)};Object.defineProperty(i,"__esModule",{value:!0}),i.YieldClient=void 0;var e=n(125),s=n(7730),o=n(2727),u=n(1128),a=n(1528),c=n(8712),h=n(514),f=n(9235),d=n(1993),l=n(6319),v=n(6258),p=n(1345),m=function(){function t(){this.logger=new e.Logger("YieldClient"),this.profile=s.Profiler.get()}return t.get=function(){return t.instance||(t.instance=new t),t.instance},t.prototype.handleSpots=function(t){f.default.instance.setSpots(t);var i=this.profile.layouts.analysisMode;t.length&&!i&&(this.runPreDemand(t),this.processSpots(t))},t.prototype.runPreDemand=function(t){var i=o.Utils.getExternalFlowHandler("onPreDemand");i&&i(t)},t.prototype.runPostDemand=function(t,i){var n=o.Utils.getExternalFlowHandler("onPostDemand");if(n){this.logger.info("invoking onPostDemand");try{n(t,i)}catch(t){this.logger.error("failed to execute onPostDemand",t)}}},t.prototype.processSpots=function(t){if(t.length){var i=p.Inframe.get();i.isInframeConfigured()&&(i.addPotentialSpots(t),i.sendPotentialSpots()),this.getDemand(t,a.DemandRequestType.SRA)}},t.prototype.processSingleSpot=function(t){this.logger.info("attemptIndex",t.attemptIndex),this.getDemand([t],a.DemandRequestType.SINGLE)},t.prototype.getDemandCallback=function(t,i){var n=this;t&&this.runPostDemand(t,i),t&&"SRA"===t.rt&&this.logger.info("getDemand returned  SRA response ",t),i.forEach((function(r){if(!t&&!(t=r.handleEmptyResponse()))return n.logger.info("getDemand returned empty, waterfall ended for spot "+r.adIndex),void r.closePlaceholderAndRemove();r.attemptIndex>=2&&v.ProviderFactory.setSpotProviderName(t,r),r.shouldWaitForUserEngagement()?n.waitForUserEngagement().then((function(){return c.DemandManager.get().processResponse(r,t,i)})):c.DemandManager.get().processResponse(r,t,i)}))},t.prototype.nextWaterfallStep=function(t){if(t.isRefreshing())t.handleRefreshFailed();else{if(t.attemptIndex++,t.attemptIndex>2)return this.getDemandCallback(null,[t]);this.processSingleSpot(t)}},t.prototype.waitForUserEngagement=function(){var t=this;return new Promise((function(i){var n=function(){t.logger.info("detected scroll, fetching"),h.default.get().removeListener("scroll",o.Utils.getScrollElement(),n),t.profile.isUserEngaged=!0,i()};h.default.get().listen("scroll",o.Utils.getScrollElement(),n)}))},t.prototype.getDemand=function(t,i){var n="";switch(i){case a.DemandRequestType.SRA:n=this.buildGetSRADemandUrl(t);break;case a.DemandRequestType.SINGLE:if(1===t.length){var r=t[0];n=this.buildGetDemandUrl(r)}else this.logger.error("Error while creating getDemand script tag: Invalid spots list",t)}n?this.getDemandXhrRequest(n,t):this.logger.error("error building demand url",t)},t.prototype.getDemandXhrRequest=function(t,i){var n=this;this.profile.layouts.analysisMode||o.Utils.xhrPromise(t,"GET").then((function(r){if(204===r.status)n.getDemandCallback(null,i);else if(202===r.status)n.handleRefreshBlocked(i[0]);else if(200===r.status){var e=JSON.parse(r.responseText),s=n.convertDemand(e);p.Inframe.get().isInframeConfigured()&&"SRA"===e.rt&&p.Inframe.get().setTotalVideosToEmbedCount(s),n.getDemandCallback(s,i)}else d.EventsService.get().sendErrorEvent("xhr_promise_error",t,"get demand failed"),n.logger.error("Error on get demand. url:"+t+",spots "+i)})).catch((function(i){d.EventsService.get().sendErrorEvent("xhr_promise_error",t,(null==i?void 0:i.message)||"get demand failed"),n.logger.error("get demand failed",i)}))},t.prototype.convertDemand=function(t){return function(t){return"SRA"===t.rt}(t)?this.convertSRADemand(t):this.convertSingleDemand(t)},t.prototype.convertSRADemand=function(t){var i=this,n=function(t){var n={};for(var r in t)n[r]=i.convertSingleDemand(t[r]);return n},r=function(t){var n={};for(var r in t)for(var e in n[r]={},t[r])n[r][e]=i.convertSingleDemand(t[r][e]);return n};return{rt:"SRA",ods:function(t){var i={};for(var n in t)i[n]={50:t[n]};return i}(t.ps),c:t.c.c?n(t.c.c):{},fc:t.c.fc?r(t.c.fc):{},ft:t.c.ft?r(t.c.ft):{},fb:t.c.fb?r(t.c.fb):{},fr:t.c.fr?r(t.c.fr):{},dr:t.c.dr?n(t.c.dr):{},ac:t.c.ac?n(t.c.ac):{}}},t.prototype.convertSingleDemand=function(t){var i,n=r(r({rt:"header_bidding"===t.rt?"header_bidding":"provider",plk:t.plk},t.p?{od:{50:t.p}}:{}),{szs:t.c.szs});return"header_bidding"===t.rt?(n.c=r({if:t.c.if,t:t.c.hb?t.c.hb.t:(null===(i=t.c.tam)||void 0===i?void 0:i.t)||0,ri:{kv:!0,do:!1,r:t.c.rr||-1}},t.c.hb?{b:t.c.hb.b.map((function(t){return r(r({},t.a?{a:t.a}:{}),{bc:{bidder:t.c,params:t.p}})}))}:{}),t.c.gam&&(n.c.d=e())):n.c=e(),n;function e(){var i="generic_js"===t.rt;return r(r({a:r(r({upc:"true",do:"true",autoSize:"true"},i?{url:t.c.u,withCallback:t.c.c?"true":"false",isJS:t.c.js?"true":"false",expectedWidth:t.c.es.w,expectedHeight:t.c.es.h,template:t.c.tm}:{}),{inIFrame:t.c.if?"true":"false"})},t.c.tam?{tam:{adServer:t.c.tam.a,pubID:t.c.tam.p,slotName:t.c.tam.s,timeout:t.c.tam.t}}:{}),i?{p:"generic_js",aup:t.c.au||"",ri:{kv:!0,do:!1,r:t.c.rr||-1},t:t.c.t,pgkv:t.c.slt?s(t.c.slt):{}}:{aup:t.c.gam.au,ri:{kv:!0,do:!1,r:t.c.rr||-1},p:"dfp",pgkv:t.c.gam?s(t.c.gam.t):{}})}function s(t){var i={};return t.forEach((function(t){i[t.k]={v:t.v,j:t.j}})),i}},t.prototype.buildGetSRADemandUrl=function(t){var i=s.Profiler.get(),n=r(r(r({},this.getRequestGenericData(t[0].isDcs,i)),this.buildPotentialSpotsParams(t)),{ac:l.DcsUtils.getDcsActionCounter()});return"//"+i.siteInfo.demandHost+"/sra/desktop?"+o.Utils.toUrlParams(n)},t.prototype.buildGetDemandUrl=function(t){var i=s.Profiler.get(),n=r(r(r({},this.buildAdData(t)),this.getRequestGenericData(t.isDcs,i)),{ac:l.DcsUtils.getDcsActionCounter()});return"//"+i.siteInfo.demandHost+"/single/desktop?"+o.Utils.toUrlParams(n)},t.prototype.getRequestGenericData=function(t,i){var n=r({sk:i.identity.siteKey,pk:i.identity.publisherKey,pvid:i.identity.pageviewId,aid:i.identity.articleId,sid:i.identity.sessionId,mch:o.Utils.getMainContentSize(i.domData),uid:o.Utils.getUserID(),pu:o.Utils.getPageUrl(),pl:o.Utils.getPageHeight(),d:t,sh:o.Utils.getScreenSize().h,lid:i.identity.supplyConfigId,ts:i.yieldData.trafficSource,cc:i.yieldData.countryCode,ir:i.yieldData.isReturningUser,ul:o.Utils.getScrollingDistance(),do:i.deviceDetails.os,dd:i.deviceDetails.device,dp:i.deviceDetails.deviceType,dt:i.deviceDetails.deviceType,db:i.deviceDetails.browser},"number"==typeof i.layouts.lazySpots.threshold?{lt:i.layouts.lazySpots.threshold}:{}),e=o.Utils.getUrlQueryParams();return e.length>0&&(n.qp=e),n},t.prototype.buildAdData=function(t){var i,n=r({if:t.attemptIndex>1,ai:t.adIndex,f:o.Utils.getElementFoldNumber(t.ref),rc:t.refresh.count,ll:t.isLazyLoading,st:t.type,et:t.getExpectedEmbedding(),al:o.Utils.getElementPosition(t.ref).top,di:t.demandIndex,pt:t.positionTypeToString()},o.Utils.getRefreshAPIParams(t.slot));return t.type===u.SpotType.API&&(n.div=t.ref.id,n.au=null===(i=t.options)||void 0===i?void 0:i.adUnit),t.selector&&(n.s=t.selector),n},t.prototype.buildPotentialSpotsParams=function(t){var i=this,n={};return t.map((function(r,e){var s=i.buildSRAPotentialSpot(r);for(var o in s)n[o]=n[o]||[],n[o].push(s[o]),e+1===t.length&&(n[o]=n[o].join("||"))})),n},t.prototype.buildSRAPotentialSpot=function(t){return{ais:t.adIndex,fs:o.Utils.getElementFoldNumber(t.ref),lls:t.isLazyLoading,sts:t.type,ets:t.getExpectedEmbedding(),als:o.Utils.getElementPosition(t.ref).top,pts:t.positionTypeToString(),ss:t.selector,dis:t.demandIndex}},t.prototype.handleRefreshBlocked=function(t){t.refresh.active=!1,d.EventsService.get().sendAdBlockedEvent(t,[{reason:"liIdBl"}])},t}();i.YieldClient=m},125:function(t,i){"use strict";var n=this&&this.__spreadArrays||function(){for(var t=0,i=0,n=arguments.length;i<n;i++)t+=arguments[i].length;var r=Array(t),e=0;for(i=0;i<n;i++)for(var s=arguments[i],o=0,u=s.length;o<u;o++,e++)r[e]=s[o];return r};Object.defineProperty(i,"__esModule",{value:!0}),i.Logger=i.LogTypes=void 0,function(t){t.DEBUG="debug",t.INFO="info",t.WARN="warn",t.ERROR="error",t.TABLE="table",t.CUSTOM="custom"}(i.LogTypes||(i.LogTypes={}));var r=function(){function t(t){var i,n;this.loggerSubject=t,this.isActive=!!(null===(i=window._middyo)||void 0===i?void 0:i.debug),this.logsToHide=(null===(n=window._middyo)||void 0===n?void 0:n.hideLogs)||[]}return t.prototype.debug=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];this.logMessage("debug",t)},t.prototype.info=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];this.logMessage("info",t)},t.prototype.error=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];this.logMessage("error",t)},t.prototype.warn=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];this.logMessage("warn",t)},t.prototype.table=function(t){if(this.isActive)try{console.table(t)}catch(i){this.info("Table fallback: ",t)}},t.prototype.custom=function(t,i){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var e=[{msg:t,style:i,args:n}];this.logMessage("custom",e)},t.prototype.logMessage=function(t,i){this.isActive&&(this.hideLog()||("custom"!==t?console[t].apply(console,n(["["+this.loggerSubject+"]"],i)):console.info("%c["+this.loggerSubject+"] "+i[0].msg,i[0].style,i[0].args)))},t.prototype.logWaterfallDetails=function(t,i,n){t.waterfall=t.waterfall||[];var r="x:"+t.ref.getBoundingClientRect().left+", y:"+t.offsetTop,e=t.selectedSize?t.selectedSize.w+"x"+t.selectedSize.h:"null";"header_bidding"===i.rt?t.waterfall.push({provider:i.rt,adIndex:t.adIndex,adUnit:"-",size:e,position:r,isLazy:t.isLazyLoading,status:n}):(i.c=i.c,t.waterfall.push({provider:t.providerDisplayName||t.providerName||i.c.p,adIndex:t.adIndex,adUnit:i.c.aup,size:e,position:r,isLazy:t.isLazyLoading,status:n})),this.info("Waterfall Table:"),this.table(t.waterfall)},t.prototype.hbLog=function(t,i,n,r){if(this.isActive){this.info("auction result "+i+", winner: %c"+(r&&r.bidder||"None"),"color:green;font-size:20px");var e=(t&&t.bids||[]).map((function(t){return{bidder:t.bidder,cpm:t.cpm,size:t.width+"x"+t.height,currency:t.currency}})),s=n.map((function(t){return{bidder:t.bidder,cpm:-1,size:"NA",currency:"NA"}}));this.table(e.concat(s))}},t.prototype.apsLog=function(t,i){this.isActive&&(console.group(t+" result %c[aps]","color:green;font-size:20px"),this.table([i]),console.groupEnd())},t.prototype.hideLog=function(){return this.logsToHide.indexOf(this.loggerSubject)>-1||this.logsToHide.indexOf("*")>-1},t}();i.Logger=r},3034:function(t,i,n){"use strict";var r=this&&this.__spreadArrays||function(){for(var t=0,i=0,n=arguments.length;i<n;i++)t+=arguments[i].length;var r=Array(t),e=0;for(i=0;i<n;i++)for(var s=arguments[i],o=0,u=s.length;o<u;o++,e++)r[e]=s[o];return r};Object.defineProperty(i,"__esModule",{value:!0}),i.SpotsUtils=i.FIXED_TYPES=i.FIXED_RAIL_TYPES=i.DYNAMIC_RAIL_TYPES=void 0;var e=n(2727),s=n(1128),o=n(7730),u=n(125),a=n(7463),c=n(5310);i.DYNAMIC_RAIL_TYPES=[s.SpotType.DYNAMIC_LEFT_RAIL,s.SpotType.DYNAMIC_RIGHT_RAIL],i.FIXED_RAIL_TYPES=[s.SpotType.FIXED_LEFT_RAIL,s.SpotType.FIXED_RIGHT_RAIL],i.FIXED_TYPES=r([s.SpotType.FIXED_MC,s.SpotType.FIXED_TOP,s.SpotType.FIXED_BOTTOM],i.FIXED_RAIL_TYPES);var h=function(){function t(){}return t.getConf=function(t){if(this.allSpotsConfigs||(this.allSpotsConfigs=this.buildTypesConf()),t.oldType===s.SpotType.API){var i=this.allSpotsConfigs[s.SpotType.API];return i?i[t.positionTag]:void 0}return this.allSpotsConfigs[t.oldType]},t.rebuild=function(){this.allSpotsConfigs=this.buildTypesConf()},t.isActive=function(t){switch(t.oldType){case s.SpotType.DYNAMIC_MC:case s.SpotType.FIXED_MC:case s.SpotType.FIXED_BOTTOM:case s.SpotType.FIXED_TOP:case s.SpotType.DYNAMIC_LEFT_RAIL:case s.SpotType.DYNAMIC_RIGHT_RAIL:case s.SpotType.FIXED_LEFT_RAIL:case s.SpotType.FIXED_RIGHT_RAIL:var i=this.getConf(t);return!!i&&0!==i.maxSpots;default:return!!this.getConf(t)}},t.isFixedSpot=function(t){return i.FIXED_TYPES.includes(t)},t.getElementsByType=function(n,r){var u,a,c;if(n===s.SpotType.DYNAMIC_MC){var h=o.Profiler.get().domData;return h?o.Profiler.getPotentialSpots(o.Profiler.get().spotEngineConfig.targetSelectors,h.mainContent.inputElements,h.mainContent.borderElement):[]}var f=e.Utils.sortElementsByPosition.apply(e.Utils,e.Utils.querySelectorAll(r,t.errorCallback,this.isRailSpot(n)));return i.DYNAMIC_RAIL_TYPES.includes(n)?o.Profiler.collectTargetElements((null===(c=null===(a=null===(u=o.Profiler.get().spotEngineConfig.rails)||void 0===u?void 0:u.ts)||void 0===a?void 0:a.ts)||void 0===c?void 0:c.e)||[],f):f},t.updateMCSpotsElements=function(){var t=this;[s.SPOT_TAGS_MAP[s.SpotType.DYNAMIC_MC],s.SPOT_TAGS_MAP[s.SpotType.FIXED_MC]].forEach((function(i){var n=t.getConf(i);n&&(n.elements=t.getElementsByType(i.oldType,n.targetElements))}))},t.isRailSpot=function(t){return this.getRailsTypes().includes(t)},t.getRailsTypes=function(){return r(i.DYNAMIC_RAIL_TYPES,i.FIXED_RAIL_TYPES)},t.getAllScanTypes=function(){return r([s.SpotType.DYNAMIC_MC],i.FIXED_TYPES,i.DYNAMIC_RAIL_TYPES)},t.getAllTypes=function(){return r([s.SpotType.DYNAMIC_MC,s.SpotType.STICKY,s.SpotType.API],i.FIXED_TYPES,i.DYNAMIC_RAIL_TYPES)},t.getTagsToScanBeforeDcs=function(){var t=this;return r([s.SPOT_TAGS_MAP[s.SpotType.STICKY],s.SPOT_TAGS_MAP[s.SpotType.FIXED_TOP]],s.RAILS_TAGS).filter((function(i){return t.isActive(i)}))},t.getTypesToDisableOnDcs=function(t){var i;return"end_less"===t&&(null===(i=o.Profiler.get().spotEngineConfig.dcs)||void 0===i?void 0:i.rescanRails)?[s.SpotType.STICKY]:r([s.SpotType.STICKY],this.getRailsTypes())},t.getOptimizeViewabilityTypes=function(){return r([s.SpotType.DYNAMIC_MC,s.SpotType.API],i.FIXED_TYPES,i.DYNAMIC_RAIL_TYPES)},t.getCompatibleSizesByType=function(t,i,n,r){var e,u,a=[];switch(t){case s.SpotType.FIXED_MC:a=n&&n.length?n:(null===(e=o.Profiler.get().domData)||void 0===e?void 0:e.dynamicCompatibleSizes)||[];break;case s.SpotType.DYNAMIC_MC:return(null===(u=o.Profiler.get().domData)||void 0===u?void 0:u.dynamicCompatibleSizes)||[];default:a=n}return this.buildAdSizes(i,a,t,r)},t.buildAdSizes=function(t,i,n,r){var e=[];return t.forEach((function(t){if(0!==i.length){var s=o.Profiler.getWidthForEmbed(t),u=o.Profiler.buildAdSizes(s,i,!0,!1,r,n);i=i.filter((function(t){return!u.find((function(i){return i.h===t.h&&i.w===t.w}))})),e=e.concat(u)}})),e},t.getBrowsiAdsStayAwayDistance=function(t){var i;return(null===(i=this.getConf(t))||void 0===i?void 0:i.distance)||0},t.buildTypesConf=function(){return{fixed_mc:this.generateFixedConfig(s.SpotType.FIXED_MC),fixed_top:this.generateFixedConfig(s.SpotType.FIXED_TOP),fixed_bottom:this.generateFixedConfig(s.SpotType.FIXED_BOTTOM),dynamic_mc:this.generateDynamicInContentConfig(),sticky:this.generateStickyConfig(),fixed_right_rail:this.generateFixedRailsConfig(s.SpotType.FIXED_RIGHT_RAIL),fixed_left_rail:this.generateFixedRailsConfig(s.SpotType.FIXED_LEFT_RAIL),dynamic_right_rail:this.generateRailsConfig(s.SpotType.DYNAMIC_RIGHT_RAIL),dynamic_left_rail:this.generateRailsConfig(s.SpotType.DYNAMIC_LEFT_RAIL),api:o.Profiler.get().layouts.spots.api}},t.generateDynamicInContentConfig=function(){var t=o.Profiler.get(),i=t.layouts.spots.dynamic;if(i){var n=this.getTargetElements(s.SpotType.DYNAMIC_MC),r=this.getElementsByType(s.SpotType.DYNAMIC_MC,n),e=i.maxItems||0;return{targetElements:n,elements:r,allowedCreativeSizes:this.getCompatibleSizesByType(s.SpotType.DYNAMIC_MC,r,i.allowedCreativeSizes,i.wrapperStyle),maxItems:e||0,maxSpots:Math.max(e,t.layouts.potentialSpots||0),lazyLoading:i.lazyLoading,startInFold:i.startInFold,stopInFold:i.stopInFold,engagedUsers:i.engagedUsers,distance:i.distance||0,viewabilityThreshold:i.viewabilityThreshold,style:i.style,wrapperStyle:i.wrapperStyle,startInFoldSelectors:i.startInFoldSelectors}}},t.generateFixedConfig=function(t){var i,n=o.Profiler.get();switch(t){case s.SpotType.FIXED_MC:i=n.layouts.spots.fixedMC;break;case s.SpotType.FIXED_BOTTOM:i=n.layouts.spots.fixedBottom;break;case s.SpotType.FIXED_TOP:i=n.layouts.spots.fixedTop}if(i){var r=this.getTargetElements(t),e=this.getElementsByType(t,r),u=e.length;return{targetElements:r,elements:e,wrapperStyle:i.wrapperStyle,allowedCreativeSizes:this.getCompatibleSizesByType(t,e,i.allowedCreativeSizes,i.wrapperStyle),maxSpots:u,maxItems:u,lazyLoading:i.lazyLoading,startInFold:i.startInFold,stopInFold:i.stopInFold,engagedUsers:i.engagedUsers,viewabilityThreshold:i.viewabilityThreshold,targetElementPosition:i.targetElementPosition,style:i.style,startInFoldSelectors:i.startInFoldSelectors}}},t.generateFixedRailsConfig=function(t){var i=o.Profiler.get().layouts.spots.rails,n=this.generateRailsConfig(t,!0);if(n)return Object.assign({},n,{targetElementPosition:i.targetElementPosition})},t.generateRailsConfig=function(t,i){var n=o.Profiler.get(),r=n.layouts.spots.rails;if(r&&this.isValidRailsConf(t)){var e=this.getTargetElements(t),s=this.getElementsByType(t,e),u=i?s.length:r.maxItems||0;return{targetElements:e,elements:s,allowedCreativeSizes:this.getCompatibleSizesByType(t,s,r.allowedCreativeSizes,r.wrapperStyle),maxSpots:Math.max(u,n.layouts.potentialSpots||0),maxItems:u,lazyLoading:r.lazyLoading,startInFold:r.startInFold,stopInFold:r.stopInFold,engagedUsers:r.engagedUsers,distance:r.distance,viewabilityThreshold:r.viewabilityThreshold,railSide:r.railSide,style:r.style,wrapperStyle:r.wrapperStyle}}},t.generateStickyConfig=function(){var t=o.Profiler.get().layouts.spots.sticky;if(t)return{location:t.location,allowedCreativeSizes:t.allowedCreativeSizes,closeButton:t.closeButton,style:t.style,wrapperStyle:t.wrapperStyle,useOriginalSizes:t.useOriginalSizes}},t.getTargetElements=function(t){var i,n,r,e,u,c,h,f,d,l,v,p,m=o.Profiler.get().spotEngineConfig,w=m.rails,b=m.mainContentConfig,g=o.Profiler.get().layouts;switch(t){case s.SpotType.FIXED_BOTTOM:p=null===(i=g.spots.fixedBottom)||void 0===i?void 0:i.targetElements;break;case s.SpotType.FIXED_TOP:p=null===(n=g.spots.fixedTop)||void 0===n?void 0:n.targetElements;break;case s.SpotType.FIXED_MC:p=null===(r=g.spots.fixedMC)||void 0===r?void 0:r.targetElements;break;case s.SpotType.DYNAMIC_LEFT_RAIL:p=null===(u=null===(e=null==w?void 0:w.ts)||void 0===e?void 0:e.ts)||void 0===u?void 0:u.l;break;case s.SpotType.DYNAMIC_RIGHT_RAIL:p=null===(h=null===(c=null==w?void 0:w.ts)||void 0===c?void 0:c.ts)||void 0===h?void 0:h.r;break;case s.SpotType.FIXED_LEFT_RAIL:(null===(f=g.spots.rails)||void 0===f?void 0:f.railSide.includes(a.RailsSides.LEFT))&&(p=null===(d=g.spots.rails)||void 0===d?void 0:d.targetElements);break;case s.SpotType.FIXED_RIGHT_RAIL:(null===(l=g.spots.rails)||void 0===l?void 0:l.railSide.includes(a.RailsSides.RIGHT))&&(p=null===(v=g.spots.rails)||void 0===v?void 0:v.targetElements);break;case s.SpotType.DYNAMIC_MC:p=null==b?void 0:b.s}return p||[]},t.getViewabilityThreshold=function(i){var n;return(null===(n=t.getConf(i))||void 0===n?void 0:n.viewabilityThreshold)||null},t.isValidRailsConf=function(t){var i=o.Profiler.get(),n=i.layouts.spots.rails,r=i.spotEngineConfig.rails;switch(t){case s.SpotType.DYNAMIC_LEFT_RAIL:return!!(n&&(null==r?void 0:r.sd)&&(null==n?void 0:n.railSide.includes(a.RailsSides.LEFT)));case s.SpotType.DYNAMIC_RIGHT_RAIL:return!!(n&&(null==r?void 0:r.sd)&&(null==n?void 0:n.railSide.includes(a.RailsSides.RIGHT)));case s.SpotType.FIXED_LEFT_RAIL:return!!(n&&n.railSide.includes(a.RailsSides.LEFT)&&n.targetElements);case s.SpotType.FIXED_RIGHT_RAIL:return!!(n&&n.railSide.includes(a.RailsSides.RIGHT)&&n.targetElements);default:return!1}},t.shouldLazyLoad=function(t){return t.optimizeViewability&&c.default.get().isLazy(t)},t.getTargetElementPosition=function(i){var n;return(null===(n=t.getConf(i))||void 0===n?void 0:n.targetElementPosition)||"ABOVE"},t.isValidHeightForSkipSa=function(t){var i=e.Utils.getPageHeight();return e.Utils.getElementSize(t).h<.8*i},t.logger=new u.Logger("SpotsUtils"),t.errorCallback=function(i){return t.logger.error(i)},t}();i.SpotsUtils=h},2727:function(t,i,n){"use strict";var r=this&&this.__spreadArrays||function(){for(var t=0,i=0,n=arguments.length;i<n;i++)t+=arguments[i].length;var r=Array(t),e=0;for(i=0;i<n;i++)for(var s=arguments[i],o=0,u=s.length;o<u;o++,e++)r[e]=s[o];return r};Object.defineProperty(i,"__esModule",{value:!0}),i.Utils=void 0;var e=n(1993),s=n(9527),o=n(7730),u=n(9235),a=n(6319),c=n(1128),h=n(3034),f=n(3006),d=n(7590),l=function(){function t(){}return t.getBrowsiTag=function(){return window.browsitag||null},t.buildBrowsiOutput=function(i){var n,r;if(i.debugMode){var s=i.identity.pageviewId,o=Object.assign(i||{},{getFiredEvents:e.EventsService.getFiredEvents,f:t,getStayAwayElements:u.default.instance.getStayAwayElementsList});(null===(n=o.domData)||void 0===n?void 0:n.mainContent)&&(o.domData.mainContent.elements=(null===(r=h.SpotsUtils.getConf(c.SPOT_TAGS_MAP[c.SpotType.DYNAMIC_MC]))||void 0===r?void 0:r.elements)||[]),window.browsiOutput=window.browsiOutput?window.browsiOutput:{},window.browsiOutput[s]=window.browsiOutput[s]?Object.assign(window.browsiOutput[s],o):o,window.browsiOutput.state=i.state}},t.getBrowsiOutput=function(t){return t?window.browsiOutput[t]:window.browsiOutput[o.Profiler.get().identity.pageviewId]},t.querySelector=function(i,n){if(i)try{return t.getCurrentContextElement().querySelector(i)}catch(t){n("Invalid selector ["+i+"]")}return null},t.getLoaderParams=function(){return window._middyo},t.isEmptyObj=function(t){return 0===Object.keys(t).length},t.querySelectorAll=function(i,n,r){return i&&i.length?i.reduce((function(i,e){var s=[];try{s=Array.from((r?document:t.getCurrentContextElement()).querySelectorAll(e))}catch(t){n("Invalid selector ["+e+"]")}return i.concat(s)}),new Array):[]},t.querySelectorInsideElements=function(i,n,r){return t.querySelectorAll(i,r).filter((function(i){return n.includes(i)||t.isDescendantElement(n,i)}))},t.isElement=function(t){return t&&t instanceof Element},t.getPositionFallback=function(i){if(!i)return 0;var n=t.getElementPosition(i).top;if("none"!==i.style.display&&n>0)return n;for(var r,e=i.previousElementSibling;e;){if(r=t.getElementPosition(e).top,"none"!==e.style.display&&r>0)return e.getBoundingClientRect().height+r;e=e.previousElementSibling}return this.getPositionFallback(i.parentElement)},t.getElementPosition=function(t,i){var n={top:-1,left:-1};return t&&this.isElement(t)?((n=this.getElementCoordinates(t)).top=this.getOffsetIfEndless(n.top,t,i),n):n},t.getOffsetIfEndless=function(t,i,n){var r=a.DcsUtils.getIfEndless();if(r){n=n||o.Profiler.get().identity.pageviewId;var e=r.pvs.find((function(t){return t.pv===n}));e&&e.e&&(!i||e.e===i||e.e.contains(i))&&(t-=this.getElementCoordinates(e&&e.e||document.body).top)}return t},t.getPercentageInView=function(t){var i=t.getBoundingClientRect(),n=this.getViewportHeight();return(n-i.top)/n*100},t.isDescendantElement=function(t,i){for(var n=0,r=t;n<r.length;n++){var e=r[n];if(this.isContainedElement(e,i))return!0}return!1},t.isContainedElement=function(t,i){return!!(t&&i&&t.compareDocumentPosition(i)&Node.DOCUMENT_POSITION_CONTAINED_BY)},t.getElementSize=function(t){var i=t.getBoundingClientRect();return{h:i.height,w:i.width}},t.getDfpAdSize=function(t){var i=t.getElementsByTagName("iframe")[0];if(i)try{return{size:{w:+i.width,h:+i.height},element:i}}catch(t){}return{size:this.getElementSize(t),element:t}},t.getViewportHeight=function(){return window.innerHeight||0},t.getViewportWidth=function(){return Math.max(document.documentElement.clientWidth,window.innerWidth||0)},t.getElementFoldNumber=function(i){var n=(t.getElementPosition(i).top+s.FixedHeaderService.get().getNoneFixedHeaderSize())/t.getViewportHeight()+1;return Number(n.toFixed(2))},t.getScreenSize=function(){return{w:window.screen.availWidth||window.screen.width,h:window.screen.availHeight||window.screen.height}},t.getPageWidth=function(){var t=window.document.body,i=window.document.documentElement;return Math.floor(Math.max(t.scrollWidth,t.offsetWidth,i.clientWidth,i.scrollWidth,i.offsetWidth))},t.getPageHeight=function(){var i=window.document.body,n=window.document.documentElement,r=Math.floor(Math.max(i.scrollHeight,i.offsetHeight,n.clientHeight,n.scrollHeight,n.offsetHeight));return a.DcsUtils.getIfEndless()?r-t.getElementPosition(a.DcsUtils.dcsElement).top:r},t.getElementCoordinates=function(t){var i=t.getBoundingClientRect(),n=document.body,r=document.documentElement,e=this.getPageYOffset(),o=window.pageXOffset||r.scrollLeft||n.scrollLeft,u=r.clientTop||n.clientTop||0,a=r.clientLeft||n.clientLeft||0,c=i.top+e-u+s.FixedHeaderService.get().getNoneFixedHeaderSize(),h=i.left+o-a;return{top:Math.round(c),left:Math.round(h)}},t.isVisible=function(i){var n=i;return t.isElement(n)&&null!==n.offsetParent&&n.getBoundingClientRect().height>1&&"0"!==window.getComputedStyle(n).opacity},t.calculateDistanceBetween=function(i,n){var r=0;if(i&&n&&i!==n){var e=t.sortElementsByDomOrder(i,n);r=t.getElementPosition(e.lower).top-t.getElementPosition(e.upper).top,t.isDescendantElement([e.upper],e.lower)||(r-=t.getElementSize(e.upper).h)}return r},t.calculateTextNodeHeight=function(i){var n=t.nextVisibleSibling(i),r=t.nextVisibleSibling(i,!0);if(n){if(i.nodeValue&&r)return t.calculateDistanceBetween(r,n)}else if(i.parentElement&&r){var e=i.parentElement.getBoundingClientRect(),s=r.getBoundingClientRect();return e.top+e.height-(s.top+s.height)}return 0},t.nextVisibleSibling=function(i,n){for(var r=n?i.previousElementSibling:i.nextElementSibling;r&&!t.isVisible(r);)r=n?r.previousElementSibling:r.nextElementSibling;return r},t.sortElementsByDomOrder=function(i,n){return t.getElementPosition(i).top<t.getElementPosition(n).top?{upper:i,lower:n}:{upper:n,lower:i}},t.sortedString=function(t){return t.sort().join(",")},t.getHighestElement=function(t,i){return this.sortElementsByDomOrder(t,i).upper},t.getMaxWrapSize=function(t){var i=t.filter((function(t){return t.optionalEmbeddings.includes("wrapped")}));return i.length?i.reduce((function(t,i){return t.h>i.h?t:i})):void 0},t.getWrappingOffset=function(t,i,n,r){return r&&!this.isContainedElement(t,i)?this.getMaxWrappingOffsetDistance(t,r,n):0},t.isFloatImage=function(t){if("IMG"!==t.nodeName)return!1;var i=window.getComputedStyle(t);return"right"===i.getPropertyValue("float")||"left"===i.getPropertyValue("float")},t.isParagraphElement=function(t){return"P"===t.nodeName},t.isEmptyParagraph=function(t){return!(!this.isParagraphElement(t)||this.isNullOrUndefined(t.textContent))&&0===t.textContent.replace(/\s*/,"").length},t.isPositionContained=function(t,i){return!!(t.compareDocumentPosition(i)&Node.DOCUMENT_POSITION_CONTAINED_BY)},t.isPositionOrderAs=function(t,i){return!!i&&!!(t.compareDocumentPosition(i)&Node.DOCUMENT_POSITION_FOLLOWING)},t.isPositionFixed=function(t){return"fixed"===window.getComputedStyle(t).position||!!t.parentElement&&this.isPositionFixed(t.parentElement)},t.removeElementsPositionedAfter=function(i,n){return this.isNullOrUndefined(i)?n:n.filter((function(n){return t.isPositionOrderAs(n,i)}))},t.toUrlParams=function(t){return Object.keys(t).map((function(i){return i+"="+("object"==typeof t[i]?encodeURIComponent(JSON.stringify(t[i])):encodeURIComponent(t[i]))})).join("&")},t.onIframeLoad=function(t,i){if(t.contentWindow&&"complete"===t.contentWindow.document.readyState)i();else var n=window.setInterval((function(){t.contentWindow&&"complete"===t.contentWindow.document.readyState&&(window.clearInterval(n),i())}),100)},t.getMarginTopBySpotStyle=function(t,i,n){n=n.previousElementSibling&&"break"===i?n.previousElementSibling:t.ref;var r=window.getComputedStyle(n),e=16,s=r.margin.split(" ");if(r.margin){var o=Number(s[0].replace("px",""));e="break"===i?e-o:o}else r.marginTop&&(o=Number(r.marginTop.replace("px","")),e="break"===i?e-o:o);return(isNaN(e)||e<0)&&(e=16),e},t.getDfpEventSize=function(t){return t.size?{w:t.size[0],h:t.size[1]}:{w:-1,h:-1}},t.appendScript=function(t,i,n){return new Promise((function(r,e){var s,o=document.createElement("script");o.async=!0,o.setAttribute("src",t),o.addEventListener("load",(function(){r("success")})),o.addEventListener("error",(function(){e("error")})),n?null===(s=i.contentDocument)||void 0===s||s.body.appendChild(o):i.appendChild(o)}))},t.createClass=function(t,i,n){var r=n.createElement("style");r.type="text/css",n.getElementsByTagName("head")[0].appendChild(r),(r.sheet||{}).insertRule?r.sheet.insertRule(t+"{"+i+"}",0):(r.styleSheet||r.sheet).addRule(t,i)},t.buildAdMarking=function(i,n){var r=document.createElement("div");r.innerText=n.text,r.id="browsi_adv_"+i.adIndex;var e=n.color?"height: 16px !important;\npadding: 0 !important;\nfont-family: Arial, sans-serif !important;\nmargin: auto !important;\nmargin-bottom: 10px !important;\ntext-align: center !important;\nline-height: 16px !important;\nfont-weight: normal !important;\ncolor:  "+n.color+" !important;\nfont-size: 11px !important;":n.customStyle?n.customStyle:"";return t.createClass(".browsi_adv_"+i.adIndex,e,document),r.setAttribute("class","browsi_adv_"+i.adIndex),r},t.getAdMarkingExpectedHeight=function(){var t=o.Profiler.get().spotEngineConfig.adMarking;if(t){if(t.expectedHeight)return t.expectedHeight;var i=this.calculateAdMarkingHeight(t);return t.expectedHeight=i,i}return 0},t.calculateAdMarkingHeight=function(t){var i=document.createElement("div");i.innerText=t.text;var n=t.color?"height: 16px !important;\npadding: 0 !important;\nfont-family: Arial, sans-serif !important;\nmargin: auto !important;\nmargin-bottom: 10px !important;\ntext-align: center !important;\nline-height: 16px !important;\nfont-weight: normal !important;\ncolor:  "+t.color+" !important;\nfont-size: 11px !important;":t.customStyle?t.customStyle:"";i.setAttribute("style",n),i.style.visibility="hidden",document.body.appendChild(i);var r=i.style.marginTop&&parseInt(i.style.marginTop)||0,e=i.style.marginBottom&&parseInt(i.style.marginBottom)||0,s=i.clientHeight+r+e;return document.body.removeChild(i),s},t.getScrollPosition=function(){var i=s.FixedHeaderService.get(),n={top:t.getPageYOffset()+i.getNoneFixedHeaderSize()+i.getFixedHeaderSize(),bottom:t.getPageYOffset()+window.innerHeight};return n.top=this.getOffsetIfEndless(n.top),n.bottom=this.getOffsetIfEndless(n.bottom),n},t.getLogStyle=function(t,i,n){return"font-size:"+t+"px;color:"+i+";background:"+n+";"},t.sortSpotsByOffsetTop=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return t.sort((function(t,i){return t.offsetTop-i.offsetTop}))},t.sortSpotsByPosition=function(){for(var i=[],n=0;n<arguments.length;n++)i[n]=arguments[n];return i.sort((function(i,n){return t.getPositionFallback(i.ref)-t.getPositionFallback(n.ref)}))},t.sortElementsByPosition=function(){for(var i=[],n=0;n<arguments.length;n++)i[n]=arguments[n];return i.sort((function(i,n){return t.getPositionFallback(i)-t.getPositionFallback(n)}))},t.sortByHeight=function(t){return t.sort((function(t,i){return t.h>i.h?1:-1}))},t.getCurrentTime=function(t){var i=Date.now();return t?Math.floor(i/1e3):i},t.isInCurrentArticle=function(t){var i=a.DcsUtils.getCurrentDcsElement();return!(i&&i instanceof Element)||this.isPositionContained(i,t)},t.isFixed=function(t){return!(!t||t===document.body)&&("fixed"===window.getComputedStyle(t).position||!!t.parentElement&&this.isFixed(t.parentElement))},t.is1x1=function(t){return 1===t.w&&1===t.h},t.isFluidSize=function(t){return 0===t.w&&0===t.h},t.merge=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return Object.assign.apply(Object,r([{}],t))},t.getSpotCoords=function(i){return i.isImpression&&i.browsiAd.container?i.browsiAd.iframe?t.getElementPosition(i.browsiAd.iframe):t.getElementPosition(i.browsiAd.container):t.getElementPosition(i.ref)},t.getPageUrl=function(){return window.document.location.protocol+"//"+window.document.location.host+window.document.location.pathname},t.getUrlQueryParams=function(){var t=window.document.location.search.substring(1).split("&");return 0===t.length?"":(t.length>10&&(t.length=10),t.join("&"))},t.findParentElementByType=function(t,i){for(var n=null,r=0,e=Array.from(document.querySelectorAll(t));r<e.length;r++){var s=e[r];this.isContainedElement(s,i)&&(n=s)}return n},t.isObject=function(t){return t&&"object"==typeof t&&!Array.isArray(t)&&null!==t},t.mergeDeep=function(t,i){var n=this;return this.isObject(t)&&this.isObject(i)&&Object.keys(i).forEach((function(r){var e,s;n.isObject(i[r])?(t[r]||Object.assign(t,((e={})[r]={},e)),n.mergeDeep(t[r],i[r])):Object.assign(t,((s={})[r]=i[r],s))})),t},t.removeSpaces=function(t){return t.replace(/(\n|\r|\s+)/gm,"")},t.getMaxWrappingOffsetDistance=function(i,n,r){var e=i.parentElement?i.parentElement:i,s=getComputedStyle(e),o=e.getBoundingClientRect().width;o-=parseFloat(s.paddingLeft||"0")+parseFloat(s.paddingRight||"0");var u=h.SpotsUtils.getConf(r).wrapperStyle,a=t.getWrapFullSize(n,u),c=a.h+this.getAdMarkingExpectedHeight();return a.w*c/o-c},t.isPositionedAfter=function(t,i){return!!i&&!!(t.compareDocumentPosition(i)&Node.DOCUMENT_POSITION_PRECEDING)},t.isPositionedDisconnected=function(t,i){return!!i&&!!(t.compareDocumentPosition(i)&Node.DOCUMENT_POSITION_DISCONNECTED)},t.isPositionedBefore=function(t,i){return!!i&&!!(t.compareDocumentPosition(i)&Node.DOCUMENT_POSITION_PRECEDING)},t.getEmbedTypesFromSizes=function(t){for(var i=[],n=!1,r=!1,e=0,s=t;e<s.length;e++)for(var o=0,u=s[e].optionalEmbeddings;o<u.length;o++){var a=u[o];if("break"!==a||r?"wrapped"!==a&&"left"!==a&&"right"!==a||n||(i.push("wrapped"),n=!0):(i.push(a),r=!0),r&&n)return i}return i},t.sizeToString=function(t){return t.w+"x"+t.h},t.toSize=function(t){void 0===t&&(t="");var i=/^(\d+)x(\d+)$/.exec(t);return i&&3===i.length?{w:Number(i[1]),h:Number(i[2])}:{w:-1,h:-1}},t.isEngagedUser=function(i){var n;if(!h.SpotsUtils.getOptimizeViewabilityTypes().includes(i.type))return!1;var r=o.Profiler.get();return!((null===(n=h.SpotsUtils.getConf(i.tags))||void 0===n?void 0:n.engagedUsers)&&i.optimizeViewability)||t.getScrollPosition().top>0||r.isUserEngaged},t.removeElement=function(t){return!(!t||!t.parentElement||(t.parentElement.removeChild(t),0))},t.throttle=function(t,i){var n=!1;return function(r){n||(t(r),n=!0,setTimeout((function(){n=!1,t(r)}),i))}},t.getCurrentFoldDecimal=function(){var t=this.getScreenSize();return this.getScrollPosition().top/t.h+1},t.getScrollDepthPercentages=function(){var t=this.getScrollingDistance();return this.getDepthPercentages(t)},t.getScrollingDistance=function(){return this.getPageYOffset()+this.getWindowHeight()},t.getDepthPercentages=function(t){var i=this.getPageHeight()||1;return t=t||0,Math.round(t/i*100)},t.getWindowHeight=function(){return window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight},t.getPageYOffset=function(){var t=this.getExternalFlowHandler("getPageYOffset");return t?t():window.pageYOffset||("CSS1Compat"===document.compatMode?document.documentElement.scrollTop:document.body.scrollTop)},t.getScrollElement=function(){var t=this.getExternalFlowHandler("getScrollListenElement");return t?t():window},t.getNowInSeconds=function(){return Math.floor(Date.now()/1e3)},t.getTimeOffset=function(){return Date.now()-o.Profiler.get().identity.timeOffset},t.getCookie=function(t){var i=encodeURIComponent(t).replace(/[\-\.\+\*]/g,"\\$&"),n=new RegExp("(?:(?:^|.*;)\\s*"+i+"\\s*\\=\\s*([^;]*).*$)|^.*$"),r=document.cookie.replace(n,"$1");return decodeURIComponent(r)||""},t.compareObjectKeys=function(t,i){return JSON.stringify(Object.keys(t))===JSON.stringify(Object.keys(i))},t.getExternalFlowHandler=function(t){var i=o.Profiler.get().rules;if(i&&i[t]&&"function"==typeof i[t])return i[t]},t.toSet=function(t){var i=new Set;return t.forEach((function(t){return i.add(t)})),i},t.toUnique=function(t){var i=[];return this.toSet(t).forEach((function(t){return i.push(t)})),i},t.getMainContentSize=function(i){if(!i||!i.mainContent.lastElement||!i.mainContent.firstElement)return-1;var n=t.getElementPosition(i.mainContent.firstElement).top,r=i.mainContent.borderElement?t.getElementPosition(i.mainContent.borderElement).top:t.getElementPosition(i.mainContent.lastElement).top+i.mainContent.lastElement.getBoundingClientRect().height;return Math.round(r-n)},t.reportNewBrowsiAd=function(i){t.dispatchDOMEvent("ban",i)},t.reportBrowsiAdRemoved=function(i){t.dispatchDOMEvent("bar",i)},t.dispatchDOMEvent=function(t,i){var n=new CustomEvent(t,{detail:i});return window.dispatchEvent(n),!0},t.clone=function(t){return JSON.parse(JSON.stringify(t))},t.getWrapFullSize=function(t,i){var n=i.l.p.r+i.l.p.l>i.r.p.r+i.r.p.l?i.l.p:i.r.p,r=i.l.m.r+i.l.m.l>i.r.m.r+i.r.m.l?i.l.m:i.r.m;return{w:t.w+n.l+r.l+n.r+r.r,h:t.h+n.b+r.b+n.t+r.t}},t.xhrPromise=function(t,i,n){return new Promise((function(r,e){var s=new XMLHttpRequest;s.open(i||"GET",t,!0),s.onreadystatechange=function(){s.readyState==XMLHttpRequest.DONE&&(s.status>=200&&s.status<300?r(s):e(null))},"POST"===i&&n?s.send(n):s.send()}))},t.findAllChildrenScripts=function(t){return Array.from(t.querySelectorAll("SCRIPT"))},t.isNullOrUndefined=function(t){return null==t},t.cloneAndEmbedBoostrap=function(){var t=document.querySelector("#browsi-tag"),i=document.createElement("script");return t?(Array.from(t.attributes).forEach((function(t){t.nodeName&&t.nodeValue&&i.setAttribute(t.nodeName,t.nodeValue)})),i.setAttribute("async",""),document.body.appendChild(i),t):null},t.getArticlesList=function(){var t=a.DcsUtils.getWindowObject();if(t)switch(t.dcsType){case"end_less":case"slides":return[]}return[]},t.isBetweenArticles=function(t){var i=this.getArticlesList();if(!i.length)return!1;var n=a.DcsUtils.getCurrentPvsObject();if(n instanceof HTMLElement&&i){var r=i.indexOf(n),e=i[r+1];if(e instanceof HTMLElement){var s=this.getElementPosition(t).top,o=this.getElementPosition(n).top,u=this.getElementPosition(e).top;return o<s&&s<u}}return!1},t.getCurrentContextElement=function(){var t,i=a.DcsUtils.getIfEndless()&&a.DcsUtils.dcsElement,n=null===(t=o.Profiler.get().dcsState)||void 0===t?void 0:t.mainContentElement;return i||n||document},t.getSlotTargeting=function(t){return t&&"function"==typeof t.getTargetingMap?t.getTargetingMap():{}},t.isStickyActive=function(){return!!h.SpotsUtils.getConf(c.SPOT_TAGS_MAP[c.SpotType.STICKY])},t.isValidStickyHeight=function(t){return t<=.3*this.getViewportHeight()},t.isValidStickySize=function(t){return this.isValidStickyHeight(t.h)&&t.w<=this.getViewportWidth()},t.isValidObject=function(t,i){try{for(var n=t.split("."),r=i||window[n[0]],e=1;e<n.length;e++)r=r[n[e]];return!this.isNullOrUndefined(r)}catch(t){return!1}},t.querySelectorOnDocument=function(t,i){var n=null;if(t instanceof HTMLIFrameElement){var r=this.getIframeWindow(t);r&&(n=r.document)}else t instanceof HTMLElement&&t.shadowRoot?n=t.shadowRoot:(t instanceof Document||t instanceof HTMLElement)&&(n=t);return n?Array.prototype.slice.call(n.querySelectorAll(i)).map((function(i){return{element:i,referer:t}})):[]},t.getIframeWindow=function(t){var i;try{i=t.contentWindow&&t.contentWindow.document?t.contentWindow:void 0}catch(t){}return i},t.isFriendlyIframe=function(t){var i=+new Date+""+Math.random();try{var n=t.contentWindow;return!!n&&(n[i]="asd","asd"===n[i])}catch(t){return!1}},t.getGAMResponseInfo=function(t){if(t){var i=t.getResponseInformation();if(i){var n=i.sourceAgnosticLineItemId;return{oid:(null==i?void 0:i.campaignId)?Number(i.campaignId):void 0,lid:i.lineItemId||n}}}},t.getRefreshAPIParams=function(t){var i={};if(t){var n=this.getGAMResponseInfo(t);(null==n?void 0:n.oid)&&(i.oi=null==n?void 0:n.oid),(null==n?void 0:n.lid)&&(i.li=null==n?void 0:n.lid)}return i},t.isBlacklistedForApiOptimization=function(t,i){var n,r,e=(null===(r=null===(n=o.Profiler.get().layouts.spots.api)||void 0===n?void 0:n.s)||void 0===r?void 0:r.viewabilityOptimizationBlocklist)||[];return!!i&&(e.includes(i)||e.includes(t))},t.getUserID=function(){return f.default.hasUserConsent?o.Profiler.get().identity.userId:"anonymous"},t.isBrowsiLoggerActive=function(){return!!this.getLoaderParams().lp},t.getExistsOrNewGoogletag=function(t){var i=t||window,n=i.googletag||(i.googletag={cmd:[]});return n.cmd=n.cmd||[],n},t.getDemandConfig=function(t){var i;return"header_bidding"===t.rt?null===(i=t.c)||void 0===i?void 0:i.d:t.c},t.isHbDemand=function(t){var i;return!!(null===(i=t.c)||void 0===i?void 0:i.d)},t.isSraResponse=function(t){return"SRA"===t.rt},t.SplitAdUnit=function(t){var i=t.split("/");return{pubID:i[1],au:i.slice(2).join("/")}},t.convertToOldStyleAdUnit=function(t){var i=this.getDemandConfig(t);if(!i)return t;var n=this.SplitAdUnit(i.aup);return i.a.pubID=n.pubID,i.au=n.au,t},t.convertToNewStyleAdUnit=function(t,i){var n=this.getDemandConfig(t);return n&&i===n.aup&&(n.aup="/"+n.a.pubID+"/"+n.au),t},t.isSaas=function(t){var i=this.getDemandConfig(t);if(!i)return!1;if("generic_js"===i.p)return!0;var n=this.SplitAdUnit(i.aup);return"57778053"!==(null==n?void 0:n.pubID)},t.injectMoat=function(t,i){if(t){var n=new d.Moat({site_key:o.Profiler.get().identity.siteKey,devicePlatform:o.Profiler.get().deviceDetails.deviceType,layout_id:o.Profiler.get().identity.supplyConfigId,publisher_key:o.Profiler.get().identity.publisherKey}).getURL();this.appendScript(n,t,i).catch((function(t){e.EventsService.get().sendErrorEvent("script_load_error",n,"moat")}))}},t.startsWith=function(t,i){return 0===i.indexOf(t)},t}();i.Utils=l},2378:(t,i)=>{"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.CollectorPipeStatus=void 0,function(t){t.PENDING="pending",t.COMPLETE="complete"}(i.CollectorPipeStatus||(i.CollectorPipeStatus={}))},4647:(t,i)=>{"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.BROWSI_IMPRESSION_DOM_EVENT_NAME=void 0,i.BROWSI_IMPRESSION_DOM_EVENT_NAME="browsiImpression"},1528:(t,i)=>{"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.DemandRequestType=void 0,function(t){t.SRA="sra",t.SINGLE="single"}(i.DemandRequestType||(i.DemandRequestType={}))},4817:function(t,i,n){"use strict";var r,e=this&&this.__assign||function(){return e=Object.assign||function(t){for(var i,n=1,r=arguments.length;n<r;n++)for(var e in i=arguments[n])Object.prototype.hasOwnProperty.call(i,e)&&(t[e]=i[e]);return t},e.apply(this,arguments)};Object.defineProperty(i,"__esModule",{value:!0}),i.DemandTool=void 0;var s=n(125),o=n(2727),u=n(2970),a=n(6393),c=n(7730),h=n(3034),f=n(1128),d=n(4569),l=n(1993),v=n(4603),p=((r={})["in-content"]="in",r.top="t",r.bottom="b",r.adhesive="s",r["right-rail"]="r",r["left-rail"]="l",r),m=function(){function t(){var t=this;this.logger=new s.Logger("BrowsiDemandTool");var i=o.Utils.getBrowsiTag();if(i){if(i.display=this.display.bind(this),i.insertPlacement=this.insertPlacement.bind(this),i.cmd)for(;i.cmd.length;){var n=i.cmd.shift();"function"==typeof n&&this.execute(n)}else i.cmd=[];i.cmd.push=function(i){return t.execute(i)}}}return t.prototype.execute=function(t){try{t()}catch(t){this.reportFailure(t,"")}},t.prototype.insertPlacement=function(t,i){this.display(t,{sizes:i})},t.prototype.display=function(t,i){var n=this;this.runApiDisplayHook(t,i),this.logger.info("display('"+t+"')",i),this.buildSpot(t,i).then((function(t){return a.YieldClient.get().processSingleSpot(t)})).catch((function(i){return n.reportFailure(i,t)}))},t.prototype.buildSpot=function(t,i){var n=this;return t&&"string"==typeof t?this.buildOptionsPromise(t,i).then((function(i){return n.validateElement(t).then((function(t){return n.validateSpot(t,i)}))})):Promise.reject("container ID is null or not a string - "+t)},t.prototype.buildOptionsPromise=function(t,i){return i?Promise.all([this.validateSizeArray(i.sizes),this.validateRefresh(i.refresh),this.validateKeyValuesArray(i.keyValues),this.validateAdUnit(i.adUnit),this.validateViewability(i.disableViewabilityOptimization),this.validatePositionType(t,i.positionTag)]).then((function(t){var i={sizes:t[0],refresh:t[1],keyValues:t[2],adUnit:t[3],disableViewabilityOptimization:t[4],positionTag:t[5]};return Object.keys(i).forEach((function(t){void 0===i[t]&&delete i[t]})),i})):Promise.resolve({})},t.prototype.validateSpot=function(t,i){var n=this;return new Promise((function(r,e){if(n.noSizesDefinedForSpot(i))return e("No sizes defined for this spot - "+t.id);n.logger.info("Processed element and options:",t,i);var s=u.default.instance.getApiSpots(),o=new d.ApiSpot(t,s.length,i);s.push(o),n.logger.info("Found api spot",o.ref),l.EventsService.get().sendSpotFoundEvent(o),n.attachParamsToRef(t,i),r(o)}))},t.prototype.noSizesDefinedForSpot=function(t){var i,n={typeTag:v.TypeTag.API,positionTag:t.positionTag||"in",oldType:f.SpotType.API},r=(null===(i=h.SpotsUtils.getConf(n))||void 0===i?void 0:i.sizes)||[];return(!t.sizes||0===t.sizes.length)&&0===r.length},t.prototype.validateElement=function(t){return new Promise((function(i,n){var r=document.getElementById(t);r||n("no element with such id exists - "+t),i(r)}))},t.prototype.validateSizeArray=function(t){var i=this;return new Promise((function(n,r){t||n(),Array.isArray(t)||r("sizes is not a valid sizes array. Please supply an array of objects: {w: adWidth, h: adHeight}"),(t=i.validateSizes(t)).length||n(),n(t.map((function(t){return{w:t.w,h:t.h,adSizeType:c.Profiler.getAdSizeType(t),minSizeForWrapping:-1,optionalEmbeddings:["break"],selectedEmbedding:"break"}})))}))},t.prototype.validateRefresh=function(t){return new Promise((function(i,n){void 0===t&&i(),"boolean"==typeof t?i({active:!!t}):"object"==typeof t&&"boolean"==typeof t.active?(void 0!==t.refreshSecond&&("number"!=typeof t.refreshSecond||t.refreshSecond<=0)&&n("refresh.refresh.refreshSecond should be positive number"),i(e({active:!!t.active},t.refreshSecond?{refreshSecond:t.refreshSecond}:{}))):n("refresh is not a valid object. Please supply an object: {active: true/false}")}))},t.prototype.validateKeyValuesArray=function(t){var i=this;return new Promise((function(n,r){t||n(),!(t=i.removeUnsupportedKeyValues(t))||t.length&&!i.isInvalidKeyValuesArray(t)||r("keyValues is not a valid key-value array. Please supply an array of objects: {key: key, value: value}"),n(i.processKeyValuesArray(t))}))},t.prototype.processKeyValuesArray=function(t){var i=function(t){return"string"!=typeof t?t.toString():t};return t.forEach((function(t){Array.isArray(t.value)?t.value.forEach((function(n,r){t.value[r]=i(n)})):t.value=i(t.value)})),t},t.prototype.validateAdUnit=function(t){var i=this;return new Promise((function(n,r){t||n(),t&&i.isInvalidAdUnit(t)&&r('adUnit is not in the valid format. Please make sure to send a string in the format: "/pubId/adUnit"'),o.Utils.startsWith("/",t)||(t="/"+t),n(t)}))},t.prototype.validateViewability=function(t){return new Promise((function(i,n){if(t&&"boolean"!=typeof t)return n("optimizeViewability is not in the valid format. Please make sure to send a boolean value (true/false)");i(!!t)}))},t.prototype.validatePositionType=function(t,i){var n=this;return new Promise((function(r){if(!i){var e=c.Profiler.get().layouts.spots.api||{};return Object.keys(e).forEach((function(i){var s,o=null===(s=e[i])||void 0===s?void 0:s.positionIds;if(n.matchRegexOrString(t,o))return r(i)})),r("in")}return r(p[i])}))},t.prototype.matchRegexOrString=function(t,i){return!!(null==i?void 0:i.some((function(i){return new RegExp("^/.*/$").test(i)?(i=i.substring(1,i.length-1),new RegExp(i).test(t)):t===i})))},t.prototype.isInvalidSizeArray=function(t){return!Array.isArray(t)||0===t.length||t.some((function(t){return isNaN(t.w)||isNaN(t.h)}))},t.prototype.validateSizes=function(t){return(t=t.map((function(t){return"string"==typeof t&&"fluid"===t.toLowerCase()?{h:0,w:0}:{h:Number(t.h),w:Number(t.w)}}))).filter((function(t){return!function(t){return(isNaN(t.w)||isNaN(t.h))&&!("string"==typeof t&&"fluid"!==t.toLowerCase())}(t)}))},t.prototype.isInvalidKeyValuesArray=function(t){return!Array.isArray(t)||0===t.length},t.prototype.isSupportedKeyValType=function(t){return["string","number","boolean"].includes(typeof t)},t.prototype.removeUnsupportedKeyValues=function(t){var i=this;return t.filter((function(t){return!function(t){return"string"!=typeof t.key||!i.isSupportedKeyValType(t.value)&&(!Array.isArray(t.value)||t.value.some((function(t){return!i.isSupportedKeyValType(t)})))}(t)}))},t.prototype.isInvalidAdUnit=function(t){return"string"!=typeof t||1===t.split("/").length},t.prototype.reportFailure=function(t,i){this.logger.error("browsitag execution failed:",t),i="string"==typeof i?i:"",l.EventsService.get().sendApiRequestBlockedEvent("api_failed",t,i)},t.prototype.runApiDisplayHook=function(t,i){var n="apiDisplay",r=o.Utils.getExternalFlowHandler(n);if(r){this.logger.info("invoking "+n,t,i);try{r(t,i)}catch(t){this.logger.error("failed to execute "+n,t)}}},t.prototype.attachParamsToRef=function(t,i){o.Utils.isBrowsiLoggerActive()&&(t.spotOptions=i)},t}();i.DemandTool=m},635:(t,i)=>{"use strict";var n;Object.defineProperty(i,"__esModule",{value:!0}),i.EmbedTypeMap=i.EmbedType=void 0,function(t){t.WRAPPED="wrapped",t.WRAPPED_LEFT="left",t.WRAPPED_RIGHT="right",t.BREAK="break",t.RANDOM="random"}(n=i.EmbedType||(i.EmbedType={}));var r={};Object.keys(n).map((function(t){r[t]=n[t]})),i.EmbedTypeMap=r},9490:(t,i,n)=>{"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.PotentialViewabilityHandler=void 0;var r=n(9301),e=n(7730),s=function(){function t(){var t=e.Profiler.get(),i=t.identity.pageviewId,n=t.identity.url,s=!!t.spotEngineConfig.adMarking;this.potentialViewabilityService=new r.PotentialViewabilityService(i,n,s)}return t.get=function(){return this.instance||(this.instance=new t),this.instance},t.prototype.reportPotentialViewability=function(t,i){var n={spotRef:t.ref,spotIndex:t.adIndex,adDistanceFromTop:t.offsetTop,size:t.getPlaceholderSize(),positionTag:t.tags.positionTag},r=i.map((function(t){return t.reason}));this.potentialViewabilityService.handlePotentialSpot(n,r)},t}();i.PotentialViewabilityHandler=s},1128:function(t,i,n){"use strict";var r,e=this&&this.__spreadArrays||function(){for(var t=0,i=0,n=arguments.length;i<n;i++)t+=arguments[i].length;var r=Array(t),e=0;for(i=0;i<n;i++)for(var s=arguments[i],o=0,u=s.length;o<u;o++,e++)r[e]=s[o];return r};Object.defineProperty(i,"__esModule",{value:!0}),i.SCAN_SPOT_TAGS=i.RAILS_TAGS=i.FIXED_TAGS=i.FIXED_RAILS_TAGS=i.DYNAMIC_RAILS_TAGS=i.SPOT_TAGS_MAP=i.SpotType=void 0;var s,o=n(4603);!function(t){t.FIXED_MC="fixed_mc",t.FIXED_TOP="fixed_top",t.FIXED_BOTTOM="fixed_bottom",t.DYNAMIC_MC="dynamic_mc",t.STICKY="sticky",t.FIXED_RIGHT_RAIL="fixed_right_rail",t.FIXED_LEFT_RAIL="fixed_left_rail",t.DYNAMIC_RIGHT_RAIL="dynamic_right_rail",t.DYNAMIC_LEFT_RAIL="dynamic_left_rail",t.API="api"}(s=i.SpotType||(i.SpotType={})),i.SPOT_TAGS_MAP=((r={})[s.FIXED_MC]={oldType:s.FIXED_MC,typeTag:o.TypeTag.FIXED,positionTag:"in"},r[s.FIXED_TOP]={oldType:s.FIXED_TOP,typeTag:o.TypeTag.FIXED,positionTag:"t"},r[s.FIXED_BOTTOM]={oldType:s.FIXED_BOTTOM,typeTag:o.TypeTag.FIXED,positionTag:"b"},r[s.DYNAMIC_MC]={oldType:s.DYNAMIC_MC,typeTag:o.TypeTag.DYNAMIC,positionTag:"in"},r[s.STICKY]={oldType:s.STICKY,typeTag:o.TypeTag.STICKY,positionTag:"s"},r[s.FIXED_RIGHT_RAIL]={oldType:s.FIXED_RIGHT_RAIL,typeTag:o.TypeTag.FIXED,positionTag:"r"},r[s.FIXED_LEFT_RAIL]={oldType:s.FIXED_LEFT_RAIL,typeTag:o.TypeTag.FIXED,positionTag:"l"},r[s.DYNAMIC_RIGHT_RAIL]={oldType:s.DYNAMIC_RIGHT_RAIL,typeTag:o.TypeTag.DYNAMIC,positionTag:"r"},r[s.DYNAMIC_LEFT_RAIL]={oldType:s.DYNAMIC_LEFT_RAIL,typeTag:o.TypeTag.DYNAMIC,positionTag:"l"},r),i.DYNAMIC_RAILS_TAGS=[i.SPOT_TAGS_MAP[s.DYNAMIC_LEFT_RAIL],i.SPOT_TAGS_MAP[s.DYNAMIC_RIGHT_RAIL]],i.FIXED_RAILS_TAGS=[i.SPOT_TAGS_MAP[s.FIXED_LEFT_RAIL],i.SPOT_TAGS_MAP[s.FIXED_RIGHT_RAIL]],i.FIXED_TAGS=e([i.SPOT_TAGS_MAP[s.FIXED_MC],i.SPOT_TAGS_MAP[s.FIXED_TOP],i.SPOT_TAGS_MAP[s.FIXED_BOTTOM]],i.FIXED_RAILS_TAGS),i.RAILS_TAGS=e(i.DYNAMIC_RAILS_TAGS,i.FIXED_RAILS_TAGS),i.SCAN_SPOT_TAGS=e([i.SPOT_TAGS_MAP[s.DYNAMIC_MC]],i.FIXED_TAGS,i.DYNAMIC_RAILS_TAGS)},8104:(t,i)=>{"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.StickyConstants=i.StickyLocation=void 0,function(t){t.TOP="TOP",t.BOTTOM="BOTTOM"}(i.StickyLocation||(i.StickyLocation={})),function(t){t.dcsVar="sticky"}(i.StickyConstants||(i.StickyConstants={}))},5701:(t,i,n)=>{"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.DEFAULT_SPOT_STYLE=void 0;var r=n(2727),e=function(){function t(t){this.externalStyle=t,this.defaultWrapStyle="margin-right:"+i.DEFAULT_SPOT_STYLE.l.m.r+"px;margin-left:"+i.DEFAULT_SPOT_STYLE.l.m.l+"px;\n        margin-top:"+i.DEFAULT_SPOT_STYLE.l.m.t+"px;margin-bottom:"+i.DEFAULT_SPOT_STYLE.l.m.b+"px;\n        padding-right:"+i.DEFAULT_SPOT_STYLE.l.p.r+"px;padding-left:"+i.DEFAULT_SPOT_STYLE.l.p.l+"px;\n        padding-top:"+i.DEFAULT_SPOT_STYLE.l.p.t+"px;padding-bottom:"+i.DEFAULT_SPOT_STYLE.l.p.b+"px;",this.defaultBreakStyle="margin-top:"+i.DEFAULT_SPOT_STYLE.b.m.t+"px;margin-bottom:"+i.DEFAULT_SPOT_STYLE.b.m.b+"px;",this.wrapperSize=r.Utils.clone(i.DEFAULT_SPOT_STYLE),this.tempElement=document.createElement("div"),this.initTempElement()}return t.prototype.removeTempElement=function(){document.body.removeChild(this.tempElement)},t.prototype.initTempElement=function(){this.tempElement.style.display="none",this.tempElement.id="tempStyleElement",document.body.appendChild(this.tempElement)},t.prototype.getWrapComputedStyle=function(){var t=getComputedStyle(this.tempElement);return{m:{t:parseInt(t.marginTop),b:parseInt(t.marginBottom),l:parseInt(t.marginLeft),r:parseInt(t.marginRight)},p:{t:parseInt(t.paddingTop),b:parseInt(t.paddingBottom),l:parseInt(t.paddingLeft),r:parseInt(t.paddingRight)}}},t.prototype.getBreakComputedStyle=function(){return{m:{t:parseInt(getComputedStyle(this.tempElement).marginTop),b:parseInt(getComputedStyle(this.tempElement).marginBottom)}}},t.prototype.getSize=function(){var t,i,n,r,e,s;if(null===(i=null===(t=this.externalStyle)||void 0===t?void 0:t.l)||void 0===i?void 0:i.w){var o=this.defaultWrapStyle+this.externalStyle.l.w+"; display: none !important";this.tempElement.setAttribute("style",o),this.wrapperSize.l=this.getWrapComputedStyle()}return(null===(r=null===(n=this.externalStyle)||void 0===n?void 0:n.r)||void 0===r?void 0:r.w)&&(o=this.defaultWrapStyle+this.externalStyle.r.w+"; display: none !important",this.tempElement.setAttribute("style",o),this.wrapperSize.r=this.getWrapComputedStyle()),(null===(s=null===(e=this.externalStyle)||void 0===e?void 0:e.b)||void 0===s?void 0:s.w)&&(o=this.defaultWrapStyle+this.externalStyle.b.w+"; display: none !important",this.tempElement.setAttribute("style",o),this.wrapperSize.b=this.getBreakComputedStyle()),this.removeTempElement(),this.wrapperSize},t}();i.default=e,i.DEFAULT_SPOT_STYLE={b:{m:{b:16,t:16}},l:{m:{t:-1,r:16,b:16,l:0},p:{t:-1,r:0,b:0,l:0}},r:{m:{t:-1,r:0,b:16,l:16},p:{t:-1,r:0,b:0,l:0}}}},7463:(t,i)=>{"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.RailsSides=void 0,function(t){t.RIGHT="RIGHT",t.LEFT="LEFT"}(i.RailsSides||(i.RailsSides={}))},4603:(t,i)=>{"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.TypeTag=i.PositionTagLong=i.PositionTag=i.LayoutPositionTag=void 0,function(t){t.TOP="t",t.IN_CONTENT="in",t.BOTTOM="b",t.STICKY="s",t.RAILS="r"}(i.LayoutPositionTag||(i.LayoutPositionTag={})),function(t){t.TOP="t",t.IN_CONTENT="in",t.BOTTOM="b",t.STICKY="s",t.RIGHT_RAIL="r",t.LEFT_RAIL="l"}(i.PositionTag||(i.PositionTag={})),function(t){t.TOP="top",t.BOTTOM="bottom",t.IN_CONTENT="in-content",t.STICKY="adhesive",t.RIGHT_RAIL="right-rail",t.LEFT_RAIL="left-rail"}(i.PositionTagLong||(i.PositionTagLong={})),function(t){t.DYNAMIC="dy",t.FIXED="fi",t.API="api",t.STICKY="s"}(i.TypeTag||(i.TypeTag={}))},3271:(t,i)=>{"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.SATargets=void 0,function(t){t.MC="MAIN_CONTENT",t.TOP="TOP",t.BOTTOM="BOTTOM",t.RIGHT="RIGHT_RAILS",t.LEFT="LEFT_RAILS"}(i.SATargets||(i.SATargets={}))},4901:function(t,i,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(t){for(var i,n=1,r=arguments.length;n<r;n++)for(var e in i=arguments[n])Object.prototype.hasOwnProperty.call(i,e)&&(t[e]=i[e]);return t},r.apply(this,arguments)};Object.defineProperty(i,"__esModule",{value:!0}),i.AuctionDataCollector=void 0;var e=n(2378),s=n(125),o=n(1993),u=n(2970),a=function(){function t(){this.logger=new s.Logger("AuctionDataCollector"),this.requests={},this.matches={},this.requestPipes={},this.matchesPipes={}}return t.get=function(){return t.instance||(this.instance=new t),t.instance},t.prototype.collectBidRequest=function(t,i,n){this.requests[i]=Object.assign(this.requests[i]||{},n),this.requestPipes[i]||this.resetRequestPipe(i),this.requestPipes[i][t]=e.CollectorPipeStatus.COMPLETE,this.shouldSendRequest(i)&&(this.logger.debug("bid request collect done for ad unit",i,this.requests[i]),this.sendBidRequestEvent(this.getSpotFromAdUnitCode(i),this.requests[i]))},t.prototype.collectBidMatch=function(t,i,n,r){this.matches[t]=this.matches[t]||{},this.matches[t][i]=this.matches[t][i]||[],this.matches[t][i][+n.im]=this.matches[t][i][+n.im]||[],this.matches[t][i][+n.im].push(n),r&&this.sendBidMatches(t)},t.prototype.sendBidMatches=function(t){var i=this.getSpotFromAdUnitCode(t),n=this.bidMatchedParamsToEvent(this.matches[t]);n&&n.length&&o.EventsService.get().sendBidMatched(i,n),this.matches[t]={}},t.prototype.bidMatchedParamsToEvent=function(t){var i=[],n=function(n){t.hasOwnProperty(n)&&t[n].forEach((function(t){var e={n,im:t[0].im,s:[]};t[0].reqt&&t[0].rest&&(e.reqt=t[0].reqt,e.rest=t[0].rest),t[0].brc&&(e.brc=t[0].brc),t[0].au&&(e.au=t[0].au),t.forEach((function(t){t.s.forEach((function(i){e.s.push(r(r(r({},i),t.rsn?{rsn:t.rsn}:{}),t.br?{br:t.br}:{}))}))})),i.push(e)}))};for(var e in t)n(e);return i},t.prototype.getSpotFromAdUnitCode=function(t){var i=t.split("_")[3];return u.default.instance.getAvailableSpots().concat(u.default.instance.getApiSpots()).find((function(t){return t.adIndex===+i}))},t.prototype.collectDFPBidRequest=function(t,i){this.sendBidRequestEvent(t,i)},t.prototype.sendBidRequestEvent=function(t,i){var n=this.buildRequestParamsToEvent(i);n&&n.length&&o.EventsService.get().sendBidRequest(t,n)},t.prototype.buildRequestParamsToEvent=function(t){var i=[];for(var n in t)t.hasOwnProperty(n)&&i.push({n,s:t[n]});return i},t.prototype.shouldSendRequest=function(t){return this.requestPipes[t]&&this.requestPipes[t].prebid===e.CollectorPipeStatus.COMPLETE&&this.requestPipes[t].aps===e.CollectorPipeStatus.COMPLETE},t.prototype.resetRequestPipe=function(t){this.requestPipes[t]={aps:e.CollectorPipeStatus.PENDING,prebid:e.CollectorPipeStatus.PENDING}},t.prototype.buildSizesFromArray=function(t){return t.map((function(t){return{w:t[0],h:t[1]}}))},t}();i.AuctionDataCollector=a},2247:function(t,i,n){"use strict";var r,e=this&&this.__extends||(r=function(t,i){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])},r(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)});Object.defineProperty(i,"__esModule",{value:!0}),i.DFP=i.MIN_AD_SIZE=void 0;var s=n(1727),o=n(1993),u=n(125),a=n(2727),c=n(8614),h=n(4949),f=n(4029);i.MIN_AD_SIZE=5;var d=function(t){function n(i){var n=t.call(this,i,"dfp")||this;return n.logger=new u.Logger("DFP"),n.hasFluidSizeSupport=!0,n}return e(n,t),n.isValidSize=function(t){return Array.isArray(t)?t[0]>i.MIN_AD_SIZE&&t[1]>i.MIN_AD_SIZE:t.w>i.MIN_AD_SIZE&&t.h>i.MIN_AD_SIZE},n.prototype.fetch=function(t,i){var n=this;return new Promise((function(r){n.logger.info("fetching spot "+n.spot.adIndex,n.spot),i.appendAndGetWrapper(n.spot).then((function(t){return n.addGPTScriptTag(t)})).then((function(i){return n.pushGoogleTagCommands(i,t)})).then((function(t){return r(t)})).catch((function(t){n.logger.error("fetching failed: ",t),r({status:"error"})}))}))},n.prototype.pushGoogleTagCommands=function(t,i){var n=this;return new Promise((function(r){c.Focus.get().waitForUserFocusWithAdBlock(n.spot).then((function(){var e=n.buildSizes(!0,n.spot),s=a.Utils.getExistsOrNewGoogletag(t.win);s.cmd.push((function(){var u=n.getAdSelector(),a=s.defineSlot(i.c.aup,e,u).addService(s.pubads());n.spot.slot=a,n.setGoogleTagPrivacy(s),n.assignKeyValues(a,n.getAllKeyValues(i)),n.logger.info("spot "+n.spot.adIndex+", definedSlot: "+a.getAdUnitPath()+", sizes:"+JSON.stringify(e)+", keyValue: "+JSON.stringify(a.getTargetingMap())),s.pubads().addEventListener("slotRenderEnded",(function(t){return n.slotRenderEndedEvent(t,r,a,i)})),s.pubads().addEventListener("slotOnload",(function(t){return n.slotOnLoadEvent(t,i)})),n.display(s,u,a,i,!!t.iframe),o.EventsService.get().sendAdRequest(n.spot,n.providerName,e,i.plk)}))}))}))},n.prototype.handleAdMatchFalse=function(t,i,n){o.EventsService.get().sendAdMatchedEvent(this.spot,"dfp",!1,n.plk),this.spot.isRefreshing()||(this.spot.isImpression=!1),i({status:"failure"})},n.prototype.display=function(t,i,n,r,e){var s="false"===r.c.a.upc||!r.c.a.upc;e?(t.enableServices(),t.display(i)):(t.enableServices(),t.pubads().isInitialLoadDisabled()?(t.display(i),t.pubads().refresh([n],{changeCorrelator:s})):(s&&t.pubads().updateCorrelator(),t.display(i)))},n.prototype.slotRenderEndedEvent=function(t,i,n,r){n==t.slot&&this.getAdSelector()===t.slot.getSlotElementId()&&(this.handleBillableEvent(this.spot.adIndex,n.getAdUnitPath(),this.spot.refresh.count),this.spot.spotRenderEnded++,this.isForcedRefresh()?this.handleForcedRefreshRenderEnded(t,r):this.handleRenderEnded(t,i,r))},n.prototype.handleForcedRefreshRenderEnded=function(t,i){if(o.EventsService.get().sendAdMatchedEvent(this.spot,"dfp",!t.isEmpty,i.plk,"forced_refresh"),!t.isEmpty){var n=!1;this.profile.siteInfo.sendBrowsiImpressionDOMEvent&&(n=this.sendBrowsiImpressionDOMEvent()),o.EventsService.get().sendAdImpression(this.spot,this.providerName,n,i.plk),this.checkBlankAd(this.spot,this.spot.adUnit),this.spot.updateInSpotEngineTest()}},n.prototype.handleRenderEnded=function(t,i,n){var r=a.Utils.getDfpEventSize(t);if(this.logger.info("dfp "+(t.isEmpty?"empty":JSON.stringify(r))+" for "+this.getAdSelector()+", au: "+t.slot.getAdUnitPath(),a.Utils.getSlotTargeting(t.slot)),t.isEmpty)this.handleAdMatchFalse(t.slot,i,n);else{if(this.spot.setSelectedSize(r),!this.spot.selectedSize)return i({status:"error"});this.spot.providerName=this.providerName,o.EventsService.get().sendAdMatchedEvent(this.spot,"dfp",!0,n.plk),a.Utils.isNullOrUndefined(this.spot.selectedSize)?(this.logger.warn("No size match for spot: ",this.spot,t),i({status:"error"})):this.expandAd(this.spot,i,n)}f.default.get().waitForBrowsiAV(t.slot,this.spot)},n.prototype.isForcedRefresh=function(){return this.spot.spotRenderEnded>this.spot.attemptIndex&&!this.spot.isRefreshing()},n.prototype.slotOnLoadEvent=function(t,i){this.spot.slot==t.slot&&new h.default(this.spot,i.c.aup).sendEvent("DFP slot loaded")},n}(s.Provider);i.DFP=d},8008:function(t,i,n){"use strict";var r,e=this&&this.__extends||(r=function(t,i){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])},r(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),s=this&&this.__assign||function(){return s=Object.assign||function(t){for(var i,n=1,r=arguments.length;n<r;n++)for(var e in i=arguments[n])Object.prototype.hasOwnProperty.call(i,e)&&(t[e]=i[e]);return t},s.apply(this,arguments)};Object.defineProperty(i,"__esModule",{value:!0}),i.GenericJS=void 0;var o=n(1727),u=n(125),a=n(1993),c=n(2727),h=n(2247),f=n(7730),d=n(1345),l=n(4869),v=function(t){function i(i,n){var r,e=t.call(this,i,"generic_js")||this;e.logger=new u.Logger("GenericJS");var s=n.c.a;e.isJs="true"===s.isJS,e.snippetUrl=s.url,e.isCallback="true"===s.withCallback,e.template=s.template,e.callbackInvoked=!1;var o={w:Number(s.expectedWidth),h:Number(s.expectedHeight)};return e.expectedSize=i.findSize(o),e.providerDisplayName=(null===(r=e.template)||void 0===r?void 0:r.p)||"generic_js",e.spot.providerDisplayName=e.providerDisplayName,e.placementKey=n.plk,e}return e(i,t),i.prototype.fetch=function(t,i){var n=this;return new Promise((function(r,e){return a.EventsService.get().sendAdRequest(n.spot,n.providerDisplayName,[],n.placementKey),i.appendAndGetWrapper(n.spot).then((function(i){return c.Utils.xhrPromise(n.snippetUrl).then((function(t){return t.status&&200===t.status?t.responseText:Promise.reject({status:"generic_snippet_error",msg:"no response. status - "+t.status})})).then((function(e){if(n.isJSONPTemplate()&&n.expectedSize)return n.runJSONPSnippet(i,t,r);var s=n.prepareSnippet(i,e,t,r);if(e&&n.expectedSize)return n.isCallback?n.runSnippetWithCallback(i,s):n.runSnippetNoCallback(i,s,n.expectedSize);var o=n.expectedSize?"generic_snippet_error":"unexpected_size";return Promise.reject({status:o})})).then((function(e){return n.handleResult(e,i,t,r)})).catch((function(i){n.handleBillableEvent(n.spot.adIndex,n.spot.adUnit||"NA",n.spot.refresh.count),a.EventsService.get().sendAdMatchedEvent(n.spot,n.providerDisplayName,!1,t.plk,"generic_js_size_mismatch",void 0,i.msg),r({status:(null==i?void 0:i.status)||"generic_snippet_error",args:{provider:"generic_js",adUnit:"NA"}})}))})).catch((function(i){a.EventsService.get().sendErrorEvent("script_load_error",n.snippetUrl,"generic",i),n.logger.error(i),n.handleBillableEvent(n.spot.adIndex,n.spot.adUnit||"NA",n.spot.refresh.count),a.EventsService.get().sendAdMatchedEvent(n.spot,n.providerDisplayName,!1,t.plk),r({status:"generic_snippet_error",args:{provider:"generic_js",adUnit:"NA"}})}))}))},i.prototype.isJSONPTemplate=function(){var t;return!!(null===(t=this.template)||void 0===t?void 0:t.n)},i.prototype.runJSONPSnippet=function(t,i,n){var r=this;return new Promise((function(n,e){var s,o=null===(s=r.template)||void 0===s?void 0:s.n,u=t.win,a=r.buildTemplateArguments(t,i,n);"function"==typeof u[o]?r.runTemplateFunction(o,u,a,n,e):c.Utils.appendScript(r.snippetUrl,u.document.body,!!t.iframe).then((function(){r.runTemplateFunction(o,u,a,n,e)}))}))},i.prototype.runTemplateFunction=function(t,i,n,r,e){var s;try{this.templateReturnValues=i[t](n),"function"==typeof(null===(s=this.templateReturnValues)||void 0===s?void 0:s.refresh)&&(this.spot.invokeRefreshCallback=this.invokeRefreshCallback.bind(this,this.templateReturnValues.refresh)),r({status:"success"})}catch(t){this.logger.error("Error while running template function",t),e({status:"generic_snippet_error",msg:t.message})}},i.prototype.buildTemplateArguments=function(t,i,n){var r,e,o,u=this,a=this.isCallback?function(r,e){return u.browsiCallback(t,i,n,r,e)}:void 0;return s(s({divId:null===(r=t.container)||void 0===r?void 0:r.id,spotIndex:this.spot.adIndex,demandIndex:this.spot.demandIndex,viewabilityPrediction:this.getPredictionReplaceValue(i),pageviewID:f.Profiler.get().identity.pageviewId,layoutID:f.Profiler.get().identity.supplyConfigId,spotsSizes:this.buildSizes(!0,this.spot),targeting:this.getAllKeyValues(i),adUnit:i.c.aup,refreshRate:(null===(e=i.c.ri)||void 0===e?void 0:e.r)||-1,templateParams:null===(o=this.template)||void 0===o?void 0:o.pr},i.c.tam?{amznBidConf:{pubID:i.c.tam.pubID,adServer:i.c.tam.adServer,slotName:i.c.tam.slotName,timeout:i.c.tam.timeout}}:{}),{sendActiveViewEvent:function(){return u.sendActiveViewEvent()},sendGeneralDataEvent:this.sendGeneralDataEvent,reportManualFailureEvent:function(t){u.reportManualFailureEvent(i,n,t)},callback:a,inframeVideoIdx:d.Inframe.get().getVideoIndex(this.spot.adIndex)})},i.prototype.sendActiveViewEvent=function(){a.EventsService.get().sendViewedImpressionAV(this.spot)},i.prototype.sendGeneralDataEvent=function(t,i){a.EventsService.get().sendGeneralDataEvent(t,i)},i.prototype.reportManualFailureEvent=function(t,i,n){this.handleBillableEvent(this.spot.adIndex,this.spot.adUnit||"NA",this.spot.refresh.count),a.EventsService.get().sendAdMatchedEvent(this.spot,this.providerDisplayName,!1,this.placementKey,n),i({status:"failure"})},i.prototype.browsiCallback=function(t,i,n,r,e){this.callbackInvoked=!0;var s=d.Inframe.get().isProviderInframe(this.spot);this.logger.info("spot: ",this.spot),r?(this.handleBillableEvent(this.spot.adIndex,this.spot.adUnit||"NA",this.spot.refresh.count),a.EventsService.get().sendAdMatchedEvent(this.spot,this.providerDisplayName,!1,i.plk,e),s&&d.Inframe.get().handleVideoWithoutDemand(),n({status:"failure"})):this.handleAd(t,n,i)},i.prototype.prepareSnippet=function(t,i,n,r){if(this.isCallback&&this.assignBrowsiCallbackToWindow(t,r,n),t.container){t.container.className=t.container.id;var e=i.replace(/<DIV_ID>/g,""+t.container.id).replace(/<SPOT_INDEX>/g,this.spot.adIndex.toString()).replace(/<DEMAND_INDEX>/g,this.spot.demandIndex.toString()).replace(/<BROWSI_VIEWABILITY_PREDICTION>/g,this.getPredictionReplaceValue(n)).replace(/<PAGEVIEW_ID>/g,this.profile.identity.pageviewId).replace(/<LAYOUT_ID>/g,this.profile.identity.supplyConfigId).replace(/"<SPOT_SIZES>"/g,JSON.stringify(this.buildSizes(!0,this.spot))).replace(/"<TARGETING>"/g,JSON.stringify(this.getAllKeyValues(n))).replace(/<VIDEO_IDX>/g,JSON.stringify(d.Inframe.get().getVideoIndex(this.spot.adIndex)));if(this.template)for(var s in this.template.pr){var o=new RegExp(s,"g");e=e.replace(o,this.template.pr[s])}if(this.logger.debug("running snippet",e),this.assignFunctionsToBrowsiTag(n,r),e)return e}return""},i.prototype.assignFunctionsToBrowsiTag=function(t,i){var n=this,r=window.browsitag;r.__gs=r.__gs||{},r.__gs[this.spot.adIndex]={av:function(){return n.sendActiveViewEvent()},gd:this.sendGeneralDataEvent,rmf:function(r){n.reportManualFailureEvent(t,i,r)}}},i.prototype.runSnippetNoCallback=function(t,i,n){var r=this;return new Promise((function(e,s){r.spot.expand(n).then((function(){if(!r.isJs)return r.injectNoJs(t,i,e,s);t.win.eval(i),e({status:"success"})})).catch((function(t){r.logger.error(t),s({status:"generic_snippet_error",msg:t.message})}))}))},i.prototype.injectNoJs=function(t,i,n,r){if(t.container){t.container.innerHTML=i;var e=c.Utils.findAllChildrenScripts(t.container);this.copyAndAppendScriptTag(t.container,e,n,r)}},i.prototype.runSnippetWithCallback=function(t,i){var n=this;return new Promise((function(r,e){if(n.isJs)try{return t.win.eval(i),r({status:"success"})}catch(t){return e({status:"generic_snippet_error",msg:t.message})}else n.injectNoJs(t,i,r,e)}))},i.prototype.getPredictionReplaceValue=function(t){var i=this.getPredictionToSend(t);return i?this.getBrowsiViewability(i):""},i.prototype.copyAndAppendScriptTag=function(t,i,n,r){Array.from(i).forEach((function(i){var n=document.createElement("script");Array.from(i.attributes).forEach((function(t){n.setAttribute(t.name,t.value)})),i.parentElement&&i.parentElement.removeChild(i),n.text=i.text,t.appendChild(n)})),n({status:"success"})},i.prototype.assignBrowsiCallbackToWindow=function(t,i,n){var r=this;window.top["browsiCallback_"+this.spot.adIndex]=function(e,s){return r.browsiCallback(t,n,i,e,s)}},i.prototype.handleResult=function(t,i,n,r){var e=this;if(i.container&&"success"===t.status&&(this.isAdInViewport().then((function(t){t&&e.sendAdInViewEvent(e.spot)})),!this.isCallback)){var s=!1;i.container.style.display="block",this.logger.debug("starting valid size interval");var o=setInterval((function(){e.isValidAdSize(i)&&(clearInterval(o),s=!0,e.onCallbackTriggered(i,r,n))}),200);setTimeout((function(){s||(clearInterval(o),e.handleBillableEvent(e.spot.adIndex,e.spot.adUnit||"NA",e.spot.refresh.count),a.EventsService.get().sendAdMatchedEvent(e.spot,e.providerDisplayName,!1,n.plk),r({status:"failure"}))}),n.c.t)}},i.prototype.onCallbackTriggered=function(t,i,n){this.callbackInvoked||this.handleAd(t,i,n)},i.prototype.handleAd=function(t,i,n){var r=c.Utils.getElementSize(t.container);this.handleBillableEvent(this.spot.adIndex,this.spot.adUnit||"NA",this.spot.refresh.count),!this.isCallback||this.isValidAdSize(t)?this.handleSuccess(r,i,n):this.handleFailure(i,n)},i.prototype.handleSuccess=function(t,i,n){if(a.EventsService.get().sendAdMatchedEvent(this.spot,this.providerDisplayName,!0,n.plk),this.spot.refresh.requested){var r=this.handleDOMEventDispatch();a.EventsService.get().sendAdImpression(this.spot,this.providerDisplayName,r,this.placementKey),l.ViewabilityService.get().subscribe(this.spot.buildViewabilityServiceObject(this.spot.vConf)),this.spot.updateRefreshedSuccessStatus()}else this.expectedSize&&(this.spot.selectedSize=Object.assign({},this.expectedSize,t),this.spot.browsiAd.h=this.spot.selectedSize.h,this.spot.browsiAd.w=this.spot.selectedSize.w,this.expandAd(this.spot,i,n));d.Inframe.get().isProviderInframe(this.spot)&&d.Inframe.get().handleVideoWithDemand(this.spot.adIndex),i({status:"success",args:{adUnit:"NA",provider:"generic_js"}})},i.prototype.handleFailure=function(t,i){this.logger.info("spot "+this.spot.adIndex+" has height < 1"),d.Inframe.get().isProviderInframe(this.spot)&&d.Inframe.get().handleVideoWithDemand(this.spot.adIndex),a.EventsService.get().sendAdMatchedEvent(this.spot,this.providerDisplayName,!1,i.plk),t({status:"failure"})},i.prototype.getAdSize=function(t){if(!t.container)return{w:0,h:0};if(!this.spot.placeholder)return c.Utils.getElementSize(t.container);var i={w:0,h:0};return t.container.childNodes.forEach((function(t){if(c.Utils.isElement(t)){var n=c.Utils.getElementSize(t);i.w=Math.max(i.w,n.w),i.h+=n.h}})),i},i.prototype.isValidAdSize=function(t){var i=c.Utils.getExternalFlowHandler("isValidGenericSize");if(!i){var n=this.getAdSize(t);return n.w>h.MIN_AD_SIZE&&n.h>h.MIN_AD_SIZE}this.logger.debug("invoking isValidGenericSize hook");try{return i(t,this.spot)}catch(t){return this.logger.error("isValidGenericSize failed",t),!1}},i.prototype.invokeRefreshCallback=function(t){t&&(a.EventsService.get().sendAdRequest(this.spot,this.spot.providerDisplayName||this.spot.providerName||"NA",[],this.placementKey),t())},i}(o.Provider);i.GenericJS=v},8895:function(t,i,n){"use strict";var r,e=this&&this.__extends||(r=function(t,i){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])},r(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),s=this&&this.__assign||function(){return s=Object.assign||function(t){for(var i,n=1,r=arguments.length;n<r;n++)for(var e in i=arguments[n])Object.prototype.hasOwnProperty.call(i,e)&&(t[e]=i[e]);return t},s.apply(this,arguments)};Object.defineProperty(i,"__esModule",{value:!0}),i.HBProvider=void 0;var o=n(1727),u=n(8614),a=n(4901),c=n(1993),h=n(2727),f=n(3006),d=function(t){function i(i,n,r,e){var s=t.call(this,i,n)||this;return s.apsSize=null,s}return e(i,t),i.prototype.runHBCommands=function(t,i,n){var r=this;return new Promise((function(e,s){u.Focus.get().waitForUserFocusWithAdBlock(r.spot).then((function(){n(t,i,e,s)}))}))},i.prototype.buildAmazonPromise=function(t,i,n){var r=this;return this.hasAmazonBidder(t)&&!this.isRefreshDfpOnly()&&f.default.hasUserConsent?new Promise((function(e,o){var u=t.c.d;r.appendApsToHead(n,u.tam).then((function(t){var n,o,c=t.win.apstag,f=r.buildSizes(!1,r.spot),d=(null===(n=u.tam)||void 0===n?void 0:n.slotName)||"";c.fetchBids(s({slots:[{slotID:i,slotName:d,sizes:f}]},(null===(o=u.tam)||void 0===o?void 0:o.timeout)?{timeout:u.tam.timeout}:{}),(function(t){var n=t.find((function(t){return t.slotID===i}));r.logger.info("amazon bid: ",n),r.logger.apsLog(i,n);var s=h.Utils.toSize(n&&n.size);s.w>0&&s.h>0&&(r.apsSize=s);var o={im:!!n&&!!n.amzniid,s:[s],br:-1,au:d};return a.AuctionDataCollector.get().collectBidMatch(i,"aps",o),e()})),a.AuctionDataCollector.get().collectBidRequest("aps",i,{aps:a.AuctionDataCollector.get().buildSizesFromArray(f)})}))})):(a.AuctionDataCollector.get().collectBidRequest("aps",i,{}),Promise.resolve())},i.prototype.hasDfpBidder=function(t){return!!t.c.d},i.prototype.hasAmazonBidder=function(t){return!(!t.c.d||!t.c.d.tam)},i.prototype.appendApsToHead=function(t,n){var r=this;if(!n)return Promise.reject("No Config");var e=t.win;if(t.iframe)return this.injectApsTag(e,n,t);if(e.apstag&&"function"==typeof e.apstag.fetchBids){try{e.apstag.init(n)}catch(t){this.logger.error("could not init publisher apstag",t)}return Promise.resolve(t)}return i.apsInjectPromise||(i.apsInjectPromise=this.injectApsTag(e,n,t)),i.apsInjectPromise.then((function(){return r.logger.info("Using browsi injected apstag"),t}))},i.prototype.injectApsTag=function(t,i,n){return this.logger.info("Injecting apstag"),new Promise((function(r,e){var s=t.document.createElement("script");s.async=!0;var o="//c.amazon-adsystem.com/aax2/apstag.js";s.setAttribute("src",o),s.addEventListener("load",(function(){"function"==typeof t.apstag.init&&t.apstag.init(i),r(n)})),s.addEventListener("error",(function(){c.EventsService.get().sendErrorEvent("script_load_error",o,"apstag"),e(n)})),t.document.head.appendChild(s)}))},i.prototype.isRefreshDfpOnly=function(){return this.spot.isRefreshing()&&this.spot.refresh.do},i.prototype.isForcedRefresh=function(){return this.spot.spotRenderEnded>this.spot.attemptIndex&&!this.spot.isRefreshing()},i.prototype.checkApsWin=function(t){try{var i=t.slot.getHtml();if(i.includes("apstag.renderImp")||i.includes("amzn_win")){if(this.apsSize&&this.spot.setSelectedSize(this.apsSize),h.Utils.isBrowsiLoggerActive()){var n={winner:"aps",size:this.apsSize,adUnit:t.slot.getSlotElementId()};window.dispatchEvent(new CustomEvent("amw",{detail:n}))}c.EventsService.get().sendAPSWinner(this.spot)}}catch(t){}},i.prototype.runPreDfpHB=function(t,i){var n,r=h.Utils.getExternalFlowHandler("preDfpHB");if(r){this.logger.info("Invoking preDfpHB");try{var e=null===(n=h.Utils.getDemandConfig(t))||void 0===n?void 0:n.aup;t=h.Utils.convertToOldStyleAdUnit(t),r(this.spot,t,i),t=e?h.Utils.convertToNewStyleAdUnit(t,e):t}catch(t){this.logger.error("preDfpHB failed",t)}}},i}(o.Provider);i.HBProvider=d},6418:function(t,i,n){"use strict";var r,e=this&&this.__extends||(r=function(t,i){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])},r(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),s=this&&this.__assign||function(){return s=Object.assign||function(t){for(var i,n=1,r=arguments.length;n<r;n++)for(var e in i=arguments[n])Object.prototype.hasOwnProperty.call(i,e)&&(t[e]=i[e]);return t},s.apply(this,arguments)};Object.defineProperty(i,"__esModule",{value:!0}),i.HeaderBiddingDA=void 0;var o=n(3881),u=n(125),a=n(1993),c=n(2727),h=n(514),f=n(4949),d=n(4901),l=n(4029),v=function(t){function i(i,n,r){var e=t.call(this,i,"header_bidding",n,r)||this;return e.logger=new u.Logger("HB"),e}return e(i,t),i.prototype.handleHBCommands=function(t,i,n,r){var e=this,s=i.container&&i.container.id||"";this.isRefreshDfpOnly()||(this.adUnit=this.buildAdUnit(s,t)),this.runPreAuction(this.spot,this.adUnit,t);var o=this.usingBrowsiPbjs?0:1,u=null;this.pbjsInstance?(this.pbjsInstance.que.push((function(){a.EventsService.get().sendAdRequest(e.spot,e.providerName,e.buildSizes(!0,e.spot),t.plk,o)})),u=this.buildHBPromise(this.pbjsInstance,t,this.adUnit,i,n)):(a.EventsService.get().sendAdRequest(this.spot,this.providerName,this.buildSizes(!0,this.spot),t.plk,o),d.AuctionDataCollector.get().collectBidRequest("prebid",this.spot.browsiAd.container.id,{}));var c=this.buildAmazonPromise(t,s,i);Promise.all([u,c]).then((function(){if(e.hasDfpBidder(t))e.requestDfpBid(i,t,n);else{e.spot.adUnit="NA";var r=e.hasBidders(t)?e.getPrebidWinner(i):null;e.handleBillableEvent(e.spot.adIndex,e.spot.adUnit,e.spot.refresh.count),a.EventsService.get().sendAdMatchedEvent(e.spot,"header_bidding",!!r,t.plk,void 0,e.getHighestBidCpm(e.adUnit&&e.adUnit.code)),r?(e.spot.setSelectedSize({w:r.width,h:r.height}),e.renderAd(i,r,n,t)):n({status:"failure"})}})).catch((function(t){e.logger.error(t),r("failure")}))},i.prototype.buildHBPromise=function(t,n,r,e,o){var u=this;return this.isRefreshDfpOnly()||!this.hasBidders(n)?(d.AuctionDataCollector.get().collectBidRequest("prebid",r&&r.code||this.spot.browsiAd.container.id,{}),Promise.resolve()):new Promise((function(a,c){t.que=t.que||[],t.que.push((function(){t.setConfig(u.getConfig(n.c.t)),u.addCustomConfigByProvider(n.c.b),h.default.get().listenToPbjs("bidWon",t,(function(t){return t&&u.winnerHandler(t,u.spot,o)})),t.addAdUnits(r),(u.spot.browsiAd.iframe||!i.isBidTimeoutListenerActive)&&(u.spot.browsiAd.iframe||(i.isBidTimeoutListenerActive=!0),t.onEvent("bidTimeout",function(t){t&&(t=Array.isArray(t)?t:[t]).forEach((function(t){u.isBrowsiAuction(t.auctionId,t.adUnitCode)&&d.AuctionDataCollector.get().collectBidMatch(r.code,t.bidder,{im:!1,rsn:"timeout",s:[{w:-1,h:-1}]})}))}.bind(u))),t.requestBids(s({adUnitCodes:[r.code],auctionId:r.code,bidsBackHandler:function(t){u.collectBidMatched(r.code,t),t?u.logger.hbLog(t[r.code],r.code,u.getNoBids(r.code),u.getPrebidWinner(e)):(u.logger.info("bidsBackHandler - Empty BidResponses"),d.AuctionDataCollector.get().collectBidRequest("prebid",r.code,{})),a()}},n.c.t?{timeout:n.c.t}:{}))}))}))},i.prototype.requestDfpBid=function(t,i,n){var r=this;this.addGPTScriptTag(t).then((function(){var e=t.container?t.container.id:"",s=r.buildSizes(!0,r.spot);r.pushGPTCommands(s,t,i,e),t.win.googletag.cmd.push((function(){t.win.googletag.pubads().addEventListener("slotRenderEnded",(function(s){return r.slotRenderEndedHandler(i,e,t,s,n)})),t.win.googletag.pubads().addEventListener("slotOnload",(function(t){return r.slotOnLoadHandler(t,i)}))}))}))},i.prototype.slotRenderEndedHandler=function(t,i,n,r,e){if(this.isBrowsiSlot(r,i)){if(this.handleBillableEvent(this.spot.adIndex,"NA",this.spot.refresh.count),this.spot.spotRenderEnded++,this.spot.adUnit=r.slot.getAdUnitPath(),this.isForcedRefresh())return this.handleForcedRefreshSlotRenderEnded(t,r,e);var s=c.Utils.getDfpEventSize(r);return this.sendDfpBidMatched(t,!r.isEmpty,s),this.logger.info("dfp(da) "+(r.isEmpty?"empty":JSON.stringify(s))+", au: "+r.slot.getAdUnitPath(),c.Utils.getSlotTargeting(r.slot)),r.isEmpty?(a.EventsService.get().sendAdMatchedEvent(this.spot,"header_bidding",!1,t.plk,void 0,this.getHighestBidCpm(this.adUnit&&this.adUnit.code||r.slot.getSlotElementId())),e({status:"failure"})):(this.spot.selectedSize||this.spot.setSelectedSize(s),a.EventsService.get().sendAdMatchedEvent(this.spot,"header_bidding",!0,t.plk,void 0,this.getHighestBidCpm(this.adUnit&&this.adUnit.code||r.slot.getSlotElementId())),this.checkApsWin(r),l.default.get().waitForBrowsiAV(r.slot,this.spot),this.expandAd(this.spot,e,t,{adUnit:"NA",provider:"header_bidding"}))}},i.prototype.winnerHandler=function(t,i,n){this.adUnit&&this.adUnit.code===t.adUnitCode&&(i.setSelectedSize({w:t.width,h:t.height}),i.selectedSize&&this.spot.expand(i.selectedSize).then((function(){if(a.EventsService.get().sendHBWinner(i,t),c.Utils.isBrowsiLoggerActive()){var r={adUnit:t.adUnitCode,winner:t.bidder,size:{w:t.width,h:t.height}};window.dispatchEvent(new CustomEvent("hbw",{detail:r}))}n({status:"success",highestBidName:t.bidder})})))},i.prototype.sendDfpBidMatched=function(t,i,n){var r,e={im:i,s:[n],br:-1,au:null===(r=t.c.d)||void 0===r?void 0:r.aup};d.AuctionDataCollector.get().collectBidMatch(this.spot.browsiAd.container.id,"dfp",e,!0)},i.prototype.pushGPTCommands=function(t,i,n,r){var e=this,s=n.c.d,o=s.a,u="false"===o.upc||!o.upc,a=i.win.googletag||{};a.cmd=a.cmd||[],this.runPreDfpHB(n,this.adUnit),a.cmd.push((function(){var o=a.defineSlot(s.aup,t,r);e.logger.info("spot "+e.spot.adIndex+", definedSlot: "+o.getAdUnitPath()+", sizes:"+JSON.stringify(t)+", keyValue: "+JSON.stringify(o.getTargetingMap())),o.addService(a.pubads()),e.setGoogleTagPrivacy(a),a.pubads().enableSingleRequest(),a.enableServices(),e.pbjsInstance?(e.pbjsInstance.que.push((function(){e.pbjsInstance.setTargetingForGPTAsync([r]),e.pushNonHBCommands(o,n,i,a,r,u)})),e.spot.slot=o):e.pushNonHBCommands(o,n,i,a,r,u)}))},i.prototype.pushNonHBCommands=function(t,i,n,r,e,s){var o=this.spot.selectedSize&&this.spot.selectedSize.h&&this.spot.selectedSize.w?{w:this.spot.selectedSize.w,h:this.spot.selectedSize.h}:{w:-1,h:-1};d.AuctionDataCollector.get().collectDFPBidRequest(this.spot,{dfp:[o]}),this.assignKeyValues(t,this.getAllKeyValues(i)),this.hasAmazonBidder(i)&&n.win.apstag&&n.win.apstag.setDisplayBids(),n.iframe?r.display(e):(googletag.enableServices(),googletag.display(e),googletag.pubads().isInitialLoadDisabled()&&googletag.pubads().refresh([t],{changeCorrelator:s}))},i.prototype.onAuctionInit=function(t){var i={},n=t.adUnitCodes[0];n&&this.isBrowsiAuction(t.auctionId,n)&&(t.bidderRequests.forEach((function(t){t.bids.forEach((function(n){i[t.bidderCode]=d.AuctionDataCollector.get().buildSizesFromArray(n.sizes)}))})),d.AuctionDataCollector.get().collectBidRequest("prebid",n,i))},i.prototype.handleForcedRefreshSlotRenderEnded=function(t,i,n){var r,e,s={im:!i.isEmpty,s:[c.Utils.getDfpEventSize(i)],br:-1,rsn:"forced_refresh",au:null===(r=t.c.d)||void 0===r?void 0:r.aup};if(d.AuctionDataCollector.get().collectBidMatch(this.spot.browsiAd.container.id,"dfp",s,!0),a.EventsService.get().sendAdMatchedEvent(this.spot,"header_bidding",!i.isEmpty,t.plk,"forced_refresh",this.getHighestBidCpm(this.adUnit&&this.adUnit.code||i.slot.getSlotElementId())),!i.isEmpty){var o=this.spot.selectedSize?this.spot.selectedSize.selectedEmbedding:void 0,u=!1;this.profile.siteInfo.sendBrowsiImpressionDOMEvent&&(u=this.sendBrowsiImpressionDOMEvent()),a.EventsService.get().sendAdImpression(this.spot,this.spot.providerName||"header_bidding",u,t.plk,o),this.checkBlankAd(this.spot,null===(e=t.c.d)||void 0===e?void 0:e.aup),this.spot.updateInSpotEngineTest()}n({status:"success",args:{adUnit:"NA",provider:"header_bidding"}})},i.prototype.getHighestBidCpm=function(t){if(t&&this.pbjsInstance){var i=this.getHighestBidById(this.pbjsInstance.getBidResponses(),t);return i?i.cpm:void 0}},i.prototype.slotOnLoadHandler=function(t,i){var n;this.spot.slot==t.slot&&new f.default(this.spot,(null===(n=i.c.d)||void 0===n?void 0:n.aup)||"").sendEvent("DFP DA slot loaded")},i.prototype.isBrowsiAuction=function(t,i){return t===i},i.isBidTimeoutListenerActive=!1,i}(o.PrebidJs);i.HeaderBiddingDA=v},1345:function(t,i,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(t){for(var i,n=1,r=arguments.length;n<r;n++)for(var e in i=arguments[n])Object.prototype.hasOwnProperty.call(i,e)&&(t[e]=i[e]);return t},r.apply(this,arguments)};Object.defineProperty(i,"__esModule",{value:!0}),i.Inframe=void 0;var e=n(7730),s=n(1993),o="video",u=function(){function t(){this.potentialSpots={},this.totalVideosToEmbedCount=0,this.videosHandledCount=0,this.spotToVideoIdxMap={}}return t.get=function(){return t.instance||(this.instance=new t),t.instance},Object.defineProperty(t.prototype,"inframeConf",{get:function(){var t;return r({},null===(t=e.Profiler.get().layouts)||void 0===t?void 0:t.inframe)},enumerable:!1,configurable:!0}),t.prototype.addPotentialSpots=function(t){var i=this;t.forEach((function(t){var n=document.createElement("div"),r=document.createElement("div");n.setAttribute("style","display:none"),r.setAttribute("style","display:none"),n.setAttribute("pp",t.adIndex.toString()),r.setAttribute("pp",t.adIndex.toString()),r.appendChild(n),t.ref.insertAdjacentElement("beforebegin",r),i.potentialSpots[t.adIndex.toString()]={adContainer:n,adWrapper:r}}))},t.prototype.sendPotentialSpots=function(t){var i=this,n=window;n.avnts=n.avnts||{hasDemand:function(){return!1},placements:[],activation:[]};var r=[];for(var e in this.potentialSpots)r.push({element:this.potentialSpots[e].adContainer,adIndex:e});var o={placements:r};t?(t.slice(1).forEach((function(t,r){n.avnts.placements.push({index:r+1,data:o}),i.addVideoIndex(r+1,t)})),s.EventsService.get().sendInframePlacementEvent(r.length)):(n.avnts.placements.push({index:0,data:o}),this.addVideoIndex(0),s.EventsService.get().sendInframePlacementEvent(r.length))},t.prototype.handleVideoWithDemand=function(t){delete this.potentialSpots[t.toString()],this.increaseVideosHandledCount()},t.prototype.handleVideoWithoutDemand=function(){this.increaseVideosHandledCount()},t.prototype.getSpotContainer=function(t){return this.potentialSpots[t.adIndex.toString()]},t.prototype.setTotalVideosToEmbedCount=function(t){var i=t.c,n=Object.keys(i).filter((function(t){var n,r=null===(n=i[+t].c.a)||void 0===n?void 0:n.template;return!!r&&r.p===o}));this.totalVideosToEmbedCount=n.length,n.length>1&&this.sendPotentialSpots(n)},t.prototype.increaseVideosHandledCount=function(){this.videosHandledCount++,this.totalVideosToEmbedCount===this.videosHandledCount&&this.removeAllPotentialSpotsContainers()},t.prototype.removeAllPotentialSpotsContainers=function(){var t=this;Object.keys(this.potentialSpots).forEach((function(i){var n,r=t.potentialSpots[i];null===(n=r.adWrapper.parentElement)||void 0===n||n.removeChild(r.adWrapper)}))},t.prototype.getVideoIndex=function(t){var i=this.spotToVideoIdxMap[t.toString()];return void 0===i?0:i},t.prototype.addVideoIndex=function(t,i){void 0!==i&&(this.spotToVideoIdxMap[i]=t)},t.prototype.isProviderInframe=function(t){return t.providerDisplayName===o},t.prototype.isInframeConfigured=function(){return!!this.inframeConf.id},t}();i.Inframe=u},3881:function(t,i,n){"use strict";var r,e=this&&this.__extends||(r=function(t,i){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])},r(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),s=this&&this.__assign||function(){return s=Object.assign||function(t){for(var i,n=1,r=arguments.length;n<r;n++)for(var e in i=arguments[n])Object.prototype.hasOwnProperty.call(i,e)&&(t[e]=i[e]);return t},s.apply(this,arguments)};Object.defineProperty(i,"__esModule",{value:!0}),i.PrebidJs=void 0;var o=n(125),u=n(7730),a=n(2727),c=n(1993),h=n(514),f=n(4901),d=n(8895),l=n(3006),v=function(t){function i(i,n,r,e){var s=t.call(this,i,n)||this;return s.bidConfigs=s.getBidConfig(i,r,e),s.iframeDoc=null,s.usingBrowsiPbjs=!1,s.adUnit=null,s.logger=new o.Logger("PrebidJs"),s.profile=u.Profiler.get(),s}return e(i,t),i.prototype.hasBidders=function(t){return!(!t.c.b||!t.c.b.length)},i.prototype.fetch=function(t,n){var r=this;return new Promise((function(e){r.logger.info("fetching spot "+r.spot.adIndex,r.spot),n.appendAndGetWrapper(r.spot).then((function(n){return r.hasBidders(t)&&r.addPrebidScriptTag(n).then((function(t){return!t.iframe&&i.isListenersActive||(r.listenToAuctionInit(),t.iframe||(i.isListenersActive=!0)),t})),n})).then((function(i){return r.runHBCommands(t,i,r.handleHBCommands.bind(r))})).then((function(t){return e(t)})).catch((function(t){"not_supported"===t?(r.logger.error("fetching failed: Prebid version "+(r.pbjsInstance?r.pbjsInstance.version:"")+" is not supported",r.pbjsInstance),c.EventsService.get().sendAdBlockedEvent(r.spot,[{reason:"prebid_version_unsupported",message:""+(r.pbjsInstance?r.pbjsInstance.version:"")}]),e({status:"not_supported"})):(r.logger.error("fetching failed: ",t),e("error"))}))}))},i.prototype.buildIframe=function(t,i,n){var r=t.document.createElement("iframe");return r.id=i,r.width=""+n.width,r.height=""+n.height,r.scrolling="no",r.frameBorder="0",r},i.prototype.getHighestBidById=function(t,i){var n=t[i]&&t[i].bids;return n?n.reduce((function(t,i){return t.cpm>i.cpm?t:i})):null},i.prototype.addPrebidScriptTag=function(t){var n=this;if(!t.win)return Promise.reject("error");if(!this.profile.siteInfo.prebidPath)return Promise.reject("no_url");if(t.iframe)return this.injectPbjs(t),Promise.resolve(t);var r=this.getInstanceName(t);return this.pbjsInstance=t.win[r],this.isUnsupportedVersion(this.pbjsInstance)&&Promise.reject("not_supported"),this.pbjsInstance&&(i.isBrowsiPbjs||this.pbjsInstance.version)?i.isBrowsiPbjs?(this.logger.info("using browsi existing "+r),this.usingBrowsiPbjs=!0,Promise.resolve(t)):new Promise((function(i,e){n.pbjsInstance.que=n.pbjsInstance.que||[],n.pbjsInstance.que.push((function(){n.isUnsupportedVersion(n.pbjsInstance)?e("not_supported"):(n.logger.info("Using publisher "+r),i(t))}))})):(this.injectPbjs(t),i.isBrowsiPbjs=!0,Promise.resolve(t))},i.prototype.listenToAuctionInit=function(){var t=this;this.pbjsInstance&&this.pbjsInstance.que.push((function(){h.default.get().listenToPbjs("auctionInit",t.pbjsInstance,t.onAuctionInit.bind(t))}))},i.listenToBillableEvents=function(){var t=u.Profiler.get(),i=t.siteInfo.prebidData&&t.siteInfo.prebidData.g||"pbjs",n=window[i];n&&n.que.push((function(){n.getEvents().filter((function(t){return"billableEvent"===t.eventType})).forEach((function(t){c.EventsService.get().sendBillableEvent(t.args)})),n.onEvent("billableEvent",(function(t){c.EventsService.get().sendBillableEvent(t)}))}))},i.prototype.isUnsupportedVersion=function(t){return!!t&&!!t.version&&0===t.version.indexOf("v0")},i.prototype.getInstanceName=function(t){var i="pbjs";return t.iframe?i:this.profile.siteInfo.prebidData&&this.profile.siteInfo.prebidData.g||i},i.prototype.buildAdUnit=function(t,i){var n=this,r=i.od;r&&r[50]&&r[50].sp&&this.bidConfigs.forEach((function(t){t.params[n.browsiViewability50Key]=r[50].p}));var e={};return this.bidConfigs.forEach((function(t){"unruly"===t.bidder&&(e=n.buildVideoMediaType(t)),t.browsiSpot=n.spot.adIndex})),{code:t,mediaTypes:s({banner:{sizes:this.buildSizes(!1,this.spot)}},e),ortb2Imp:{ext:{data:{adserver:{adslot:this.getGPID(t,i.c.d)}}}},bids:this.bidConfigs}},i.prototype.injectPbjs=function(t){if(t.win){this.logger.info("Injecting Browsi Pbjs"),this.usingBrowsiPbjs=!0,t.win.pbjs=t.win.pbjs||{},this.pbjsInstance=t.win.pbjs,this.pbjsInstance&&(this.pbjsInstance.que=this.pbjsInstance.que||[]);var i=t.win.document.createElement("script");i.async=!0;var n=this.profile.siteInfo.prebidPath;i.setAttribute("src",n),i.addEventListener("error",(function(){c.EventsService.get().sendErrorEvent("script_load_error",n,"prebid")})),t.win.document.head.appendChild(i)}},i.prototype.getGPID=function(t,i){return(i?i.aup+"#":"")+t},i.prototype.getConfig=function(t){var i=s({enableSendAllBids:!0,debug:this.profile.debugMode},t?{bidderTimeout:t}:{});this.usingBrowsiPbjs&&(i=Object.assign(i,s(s(s(s({},this.getUserIdConfig()),this.getSupplyChainConfig()),l.default.prebidConf),this.getPriceGranularityConfig())));var n=a.Utils.getExternalFlowHandler("setPrebidConfig");return n&&(this.logger.debug("calling setPrebidConfig hook"),n(i)),this.logger.info("Using Prebid configuration:",i),i},i.prototype.getPriceGranularityConfig=function(){var t=this.profile.siteInfo.prebidData&&this.profile.siteInfo.prebidData.pg,i=t&&t.n||"auto";return"custom"===i&&t&&t.v?{priceGranularity:JSON.parse(t.v)}:"custom"===i?{priceGranularity:"auto"}:{priceGranularity:i}},i.prototype.getUserIdConfig=function(){return this.profile.siteInfo.prebidData&&this.profile.siteInfo.prebidData.um?{userSync:JSON.parse(this.profile.siteInfo.prebidData.um)}:{}},i.prototype.getSupplyChainConfig=function(){return this.profile.siteInfo.prebidData&&this.profile.siteInfo.prebidData.s?{schain:JSON.parse(this.profile.siteInfo.prebidData.s)}:{}},i.prototype.renderAd=function(t,i,n,r){var e;if(t.win&&t.container&&t.container.id){var s=this.buildIframe(t.win,t.container.id,i);if(((null===(e=t.iframe)||void 0===e?void 0:e.contentDocument)?t.iframe.contentDocument.body:t.container).appendChild(s),this.pbjsInstance&&i.adId&&s.contentWindow)return this.pbjsInstance.renderAd(s.contentWindow.document,i.adId),this.expandAd(this.spot,n,r);n({status:"failure"})}},i.prototype.getBidResponses=function(t,i){return i&&i[t]?i[t].bids:[]},i.prototype.collectBidMatched=function(t,i){var n=this.getBidResponses(t,i),r={};n.forEach((function(i){var n={im:Number(i.cpm)>0,s:[{w:i.width,h:i.height}],br:Number(i.cpm)};i.currency&&(n.brc=i.currency),i.requestTimestamp&&i.responseTimestamp&&(n.reqt=i.requestTimestamp,n.rest=i.responseTimestamp),r[i.bidder]=r[i.bidder]||[],r[i.bidder]=r[i.bidder].concat(n.s),f.AuctionDataCollector.get().collectBidMatch(t,i.bidder,n)}));var e=[];this.getNoBids(t).forEach((function(i){if(!i.bidderRequestId||!e.includes(i.bidderRequestId)){var n=r[i.bidder]||[];i.bidderRequestId&&e.push(i.bidderRequestId);var s={im:!1,rsn:"no_bid",s:f.AuctionDataCollector.get().buildSizesFromArray(i.sizes).filter((function(t){return!n.some((function(i){return i.w===t.w&&i.h===t.h}))}))};0!==s.s.length&&f.AuctionDataCollector.get().collectBidMatch(t,i.bidder,s)}})),f.AuctionDataCollector.get().sendBidMatches(t)},i.prototype.getNoBids=function(t){if(this.pbjsInstance&&this.pbjsInstance.getNoBids&&"function"==typeof this.pbjsInstance.getNoBids){var i=this.pbjsInstance.getNoBids()[t];return i?i.bids:[]}return[]},i.prototype.getBidConfig=function(t,i,n){var r=this;return i&&i.reduce((function(i,e){switch(e.a&&r.handleBidAlias(e.a,e.bc.bidder),r.getBidName(e)){case"pulsepoint":return i.concat(r.buildPulsepointBids(e,t));case"ix":return i.concat(r.buildIndexExchangeBids(e,t));case"pubmatic":return i.concat(r.buildPubmaticBids(e,t));case"ias":return i.concat(r.buildIASBids(e,n));default:return i.concat([e.bc])}}),[])||[]},i.prototype.handleBidAlias=function(t,n){var r=this,e=this.spot.browsiAd.iframe,s=i.activeBidAlias[t]&&i.activeBidAlias[t]===n,o=e||!s;this.pbjsInstance&&o&&(e||(i.activeBidAlias[t]=n),this.pbjsInstance.que.push((function(){r.pbjsInstance.aliasBidder(t,n)})))},i.prototype.buildVideoMediaType=function(t){var i=t.params["video-context"],n=t.params["video-width"],r=t.params["video-height"];return i&&n&&r?{video:{context:i,playerSize:[[n,r]]}}:{}},i.prototype.buildPulsepointBids=function(t,i){return i.getCompatibleSizes().map((function(i){return{bidder:t.bc.bidder,params:s(s({},t.bc.params),{cf:a.Utils.sizeToString(i)})}}))},i.prototype.buildIndexExchangeBids=function(t,i){return i.getCompatibleSizes().map((function(i){return{bidder:t.bc.bidder,params:s(s({},t.bc.params),{size:[i.w,i.h]})}}))},i.prototype.buildPubmaticBids=function(t,i){return i.getCompatibleSizes().map((function(i){return{bidder:t.bc.bidder,params:{publisherId:t.bc.params.publisherId,adSlot:t.bc.params.adSlot+"@"+a.Utils.sizeToString(i)}}}))},i.prototype.buildIASBids=function(t,i){return[{bidder:t.bc.bidder,params:Object.assign(t.bc.params,{adUnitPath:i.aup})}]},i.prototype.getBidName=function(t){return t.a?t.a:t.bc.bidder},i.prototype.addCustomConfigByProvider=function(t){var i=this;t&&t.forEach((function(t){if(i.pbjsInstance)switch(i.getBidName(t)){case"pubmatic":case"aardvark":i.pbjsInstance.setConfig({userSync:{filterSettings:{iframe:{bidders:"*",filter:"include"}}}});break;case"ias":i.pbjsInstance.bidderSettings.ias={alwaysUseBid:!0,sendStandardTargeting:!1,suppressEmptyKeys:!0,adserverTargeting:[{key:"adt",val:function(t){return t.adt}},{key:"alc",val:function(t){return t.alc}},{key:"dlm",val:function(t){return t.dlm}},{key:"drg",val:function(t){return t.drg}},{key:"hat",val:function(t){return t.hat}},{key:"off",val:function(t){return t.off}},{key:"vio",val:function(t){return t.vio}},{key:"fr",val:function(t){return t.fr}},{key:"id",val:function(t){return t.slots[t.adUnitCode].id}},{key:"vw",val:function(t){return t.slots[t.adUnitCode].vw}},{key:"grm",val:function(t){return t.slots[t.adUnitCode].grm}},{key:"pub",val:function(t){return t.slots[t.adUnitCode].pub}}]}}}))},i.prototype.getPrebidWinner=function(t){if(t.container&&t.container.id&&this.pbjsInstance){var i=t.container.id;return this.pbjsInstance&&this.pbjsInstance.getHighestCpmBids().find((function(t){return t.adUnitCode===i}))||null}return null},i.prototype.onAuctionInit=function(t){},i.isBrowsiPbjs=!1,i.isListenersActive=!1,i.activeBidAlias={},i}(d.HBProvider);i.PrebidJs=v},1727:(t,i,n)=>{"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.Provider=void 0;var r=n(2727),e=n(1993),s=n(2362),o=n(7730),u=n(4269),a=n(4869),c=n(1128),h=n(8104),f=n(3006),d=n(5490),l=n(8939),v=n(4647),p=n(3034),m=function(){function t(t,i){var n;this.spot=t,this.providerName=i,this.spot.providerName=this.providerName,this.hasFluidSizeSupport=!1,this.profile=o.Profiler.get(),this.browsiViewability50Key=this.profile.browsiViewability50Key,o.Profiler.get().siteInfo.billableEvents===d.BillableEventType.AD_REQUEST&&(this.billableEvents=new d.BillableEvents(this.browsiViewability50Key,null===(n=o.Profiler.get().siteInfo.prebidData)||void 0===n?void 0:n.g))}return t.prototype.getAdUnit=function(t){return(null==t?void 0:t.aup)||""},t.prototype.addGPTScriptTag=function(t){var i,n,r=this;return(null===(n=null===(i=null==t?void 0:t.win)||void 0===i?void 0:i.googletag)||void 0===n?void 0:n.apiReady)?Promise.resolve(t):new Promise((function(i,n){if(t&&t.win){var e=t.win.document.createElement("script");e.async=!0,e.setAttribute("src","//securepubads.g.doubleclick.net/tag/js/gpt.js"),e.addEventListener("load",(function(){i(t)})),t.win.document.head.appendChild(e)}else r.logger.error("failed to append gpt script tag"),n(t)}))},t.prototype.handleDOMEventDispatch=function(){var t=!1;return this.profile.siteInfo.sendBrowsiImpressionDOMEvent&&(t=this.sendBrowsiImpressionDOMEvent()),t},t.prototype.expandAd=function(t,i,n,r){var o=this;t.selectedSize?(t.handleRefreshSuccess(),t.expand(t.selectedSize).then((function(u){if(t.selectedSize){t.isImpression=!0;var a=o.handleDOMEventDispatch();e.EventsService.get().sendAdImpression(t,t.providerDisplayName||o.providerName,a,n.plk,t.selectedSize.selectedEmbedding),"s"===t.tags.positionTag&&s.Embedder.addStickyCloseButton(t,t.browsiAd.wrapper),"generic_js"!==o.providerName&&o.isAdInViewport().then((function(i){i&&o.sendAdInViewEvent(t)})),t.updateInSpotEngineTest(),o.logger.info("added ["+u.w+"X"+u.h+"]: ",t.browsiAd.wrapper),o.verifyStickySpotSize(u)&&t.subscribeToViewabilityService(),o.checkBlankAd(t,t.adUnit),i(Object.assign({status:"success"},r||{}))}else i({status:"failure"})}))):i({status:"failure"})},t.prototype.sendBrowsiImpressionDOMEvent=function(){var t,i,n={element:this.spot.browsiAd.container,adUnit:(null===(t=this.spot.slot)||void 0===t?void 0:t.getAdUnitPath())||"NA",refreshCount:(null===(i=this.spot.refresh)||void 0===i?void 0:i.count)||0};return r.Utils.dispatchDOMEvent(v.BROWSI_IMPRESSION_DOM_EVENT_NAME,n)},t.prototype.checkBlankAd=function(t,i){var n=this;if(this.profile.siteInfo.sendBlankAdReport){var s=t&&t.browsiAd&&t.browsiAd.container;s&&(new l.BlankAdReportService).checkForBlankAd(s).then((function(o){if(o.isBlank){n.logger.info("Blank ad found:",o.reason,s);var u=r.Utils.getGAMResponseInfo(t.slot);e.EventsService.get().sendBlankAdEvent(t,i,o.reason,u)}})).catch((function(t){n.logger.info("blank ad check failure",t,s)}))}},t.prototype.isAdInViewport=function(){if(!this.profile.siteInfo.adInViewport||this.spot.refresh.count>0)return Promise.resolve(!1);var t=50+(this.spot.browsiAd.admarking?r.Utils.getElementSize(this.spot.browsiAd.admarking).h:0),i=this.spot.browsiAd.wrapper;return i?r.Utils.getElementSize(i).h>t?Promise.resolve(!0):new Promise((function(n){var e=new u.default(i);e.addResizeListener((function(){if(r.Utils.getElementSize(i).h>t)return e.removeResizeListener(),n(!0)}))})):Promise.resolve(!1)},t.prototype.sendAdInViewEvent=function(t){if(t.browsiAd&&t.browsiAd.wrapper){var i=t.browsiAd.wrapper,n=a.ViewabilityService.get().inViewPercentage({getCoords:function(){return r.Utils.getElementPosition(i)},getHeight:function(){return r.Utils.getElementSize(i).h}});n&&e.EventsService.get().sendAdInViewport(t,n)}},t.prototype.buildSizes=function(t,i){var n=i.type===c.SpotType.STICKY&&p.SpotsUtils.getConf(i.tags).useOriginalSizes;return i.isRefreshing()&&i.selectedSize&&!n?t&&r.Utils.isFluidSize(i.selectedSize)?["fluid"]:[i.selectedSize.w,i.selectedSize.h]:i.getCompatibleSizes().filter((function(i){return t||!t&&!r.Utils.isFluidSize(i)})).map((function(i){return t&&r.Utils.isFluidSize(i)?["fluid"]:[i.w,i.h]}))},t.prototype.isBrowsiSlot=function(t,i){return t.slot&&t.slot.getSlotElementId()===i},t.prototype.getAllKeyValues=function(t){var i=[];Array.isArray(t.kv)&&(i=t.kv.map((function(t){return{key:t.k||t.key,value:t.v||t.value}})));var n=this.getPredictionToSend(t);if(n){var e=this.billableEvents?this.billableEvents.viewabilityKeyName:this.browsiViewability50Key;i.push({key:e,value:this.getBrowsiViewability(n)})}this.spot.refresh.requested&&!this.spot.refresh.dcsRefresh&&this.spot.refresh.kv&&i.push({key:"browsiRefresh",value:"True"});var s=t.c.pgkv||t.c&&t.c.d&&t.c.d.pgkv||{},o=Object.assign(r.Utils.clone(this.profile.pageKeyValues||{}),r.Utils.clone(s||{}));if(o)for(var u in o){var a=this.getTargetingValue(o[u],u);a.length&&i.push({key:u,value:a})}return i},t.prototype.assignKeyValues=function(t,i){i.forEach((function(i){t.setTargeting(i.key,i.value)}))},t.prototype.getTargetingValue=function(t,i){var n,r,e,s,o,u,a;if(!t.v)return[];if((null===(s=null===(e=null===(r=null===(n=this.spot)||void 0===n?void 0:n.browsiAd)||void 0===r?void 0:r.win)||void 0===e?void 0:e.googletag)||void 0===s?void 0:s.pubads)&&-1!=(null===(a=null===(u=null===(o=this.spot)||void 0===o?void 0:o.browsiAd)||void 0===u?void 0:u.win)||void 0===a?void 0:a.googletag.pubads().getTargetingKeys().indexOf(i)))return[];if(!t.j)return t.v;try{return this.spot.browsiAd.win.eval(t.v&&t.v[0])||[]}catch(t){return[]}},t.prototype.getPredictionToSend=function(t){var i,n=null===(i=null==t?void 0:t.od)||void 0===i?void 0:i[50];return(null==n?void 0:n.sp)?n:void 0},t.prototype.getBrowsiViewability=function(t){return t.p&&t.p>=0?(Math.floor(10*t.p)/10).toFixed(2):"NA"},t.prototype.runPreAuction=function(t,i,n){var e="preAuction",s=r.Utils.getExternalFlowHandler(e);if(s){this.logger.info("invoking "+e);try{s(t,i,n)}catch(t){this.logger.error(e+" failed",t)}}},t.prototype.getAdSelector=function(){return this.spot.browsiAd.container&&this.spot.browsiAd.container.id||""},t.prototype.verifyStickySpotSize=function(t){return this.spot.type!==c.SpotType.STICKY||(r.Utils.isValidStickyHeight(t.h)?(this.profile.layouts.spots.sticky.location===h.StickyLocation.TOP?window.document.body.style.paddingTop=t.h+"px":window.document.body.style.paddingBottom=t.h+"px",!0):(this.spot.destroySlot(),s.Embedder.removeAdFromDom(this.spot),this.logger.info("sticky ad removed,",t.h," is over 30%"),!1))},t.prototype.setGoogleTagPrivacy=function(t){if(!f.default.hasUserConsent){var i=f.default.getCurrentConsentType();"ccpa"===i?t.pubads().setPrivacySettings({restrictDataProcessing:!0}):"gdpr"===i&&t.pubads().setRequestNonPersonalizedAds(1)}},t.prototype.handleBillableEvent=function(t,i,n){if(this.billableEvents){var r={placement_id:t.toString(),site_key:o.Profiler.get().identity.siteKey,publisher_key:o.Profiler.get().identity.publisherKey,bill_type:d.BillableEventType.AD_REQUEST,ad_unit:i,page_view_id:o.Profiler.get().identity.pageviewId,refresh_count:n};this.billableEvents.dispatchBillableEvent(r)}},t}();i.Provider=m},4569:function(t,i,n){"use strict";var r,e=this&&this.__extends||(r=function(t,i){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])},r(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)});Object.defineProperty(i,"__esModule",{value:!0}),i.ApiSpot=void 0;var s=n(4603),o=n(1128),u=n(3034),a=n(7730),c=n(6319),h=n(9763),f=n(6864),d=function(t){function i(i,n,r){var e=this,a={positionTag:r.positionTag||"in",typeTag:s.TypeTag.API,oldType:o.SpotType.API},h=Math.min(n,f.AD_INDEX_LIMIT),d=(e=t.call(this,i,a,h,r.sizes||[],0,c.DcsUtils.isDcs)||this).getLayoutConfig(a.positionTag);return e.adIndex=500+h,e.options=r,e.compatibleSizes=r.sizes||d&&e.buildCompatibleSizes(d.sizes)||[],e.options.sizes=e.compatibleSizes,e.optimizeViewability=e.shouldOptimizeApiViewability(d),e.isLazyLoading=u.SpotsUtils.shouldLazyLoad(e),e}return e(i,t),i.prototype.getLayoutConfig=function(t){var i={typeTag:s.TypeTag.API,positionTag:t,oldType:o.SpotType.API};return u.SpotsUtils.getConf(i)},i.prototype.shouldOptimizeApiViewability=function(t){var i,n,r;if(t){var e=t.viewabilityOptimizationBlocklist,s=e&&(!!(null===(i=this.options)||void 0===i?void 0:i.adUnit)&&e.includes(null===(n=this.options)||void 0===n?void 0:n.adUnit)||e.includes(this.ref.id));return!(null===(r=this.options)||void 0===r?void 0:r.disableViewabilityOptimization)&&!s}return!0},i.prototype.checkSpotOptions=function(t){var i=this.options,n=t.c.d||t.c,r=this.attemptIndex>1;return this.logger.info("Merging spot options:",i," waterfall ",r),t.c.ri&&void 0!==i.refresh&&(i.refresh.active?i.refresh.refreshSecond&&(t.c.ri.r=1e3*i.refresh.refreshSecond):t.c.ri.r=-1),r||(i.adUnit&&"demo-placement"!==t.plk&&(n.aup=i.adUnit,this.adUnit=i.adUnit),i.keyValues&&(t.kv=t.kv?t.kv.concat(i.keyValues):i.keyValues)),t},i.prototype.prepareResponseForFetch=function(t){return this.checkSpotOptions(t)},i.prototype.buildCompatibleSizes=function(t){return t.map((function(t){return{w:t.w,h:t.h,adSizeType:a.Profiler.getAdSizeType(t),minSizeForWrapping:-1,optionalEmbeddings:["break"],selectedEmbedding:"break"}}))},i.prototype.handleEmptyResponse=function(){return 1==this.attemptIndex&&this.options&&this.options.adUnit&&this.options.sizes?{rt:"empty_api",c:{a:{autoSize:!0,inIframe:!1},aup:this.options.adUnit,p:""},plk:"",szs:this.options.sizes}:null},i.prototype.unsetRefDisplay=function(){"INSIDE"===this.targetElementPosition&&"none"===this.ref.style.display&&this.ref.style.removeProperty("display")},i}(h.DirectSpot);i.ApiSpot=d},9763:function(t,i,n){"use strict";var r,e=this&&this.__extends||(r=function(t,i){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])},r(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)});Object.defineProperty(i,"__esModule",{value:!0}),i.DirectSpot=void 0;var s=function(t){function i(i,n,r,e,s,o,u){return t.call(this,i,n,r,e,s,o,u)||this}return e(i,t),i}(n(6864).Spot);i.DirectSpot=s},7989:function(t,i,n){"use strict";var r,e=this&&this.__extends||(r=function(t,i){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])},r(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)});Object.defineProperty(i,"__esModule",{value:!0}),i.DynamicSpot=void 0;var s=n(6454),o=n(4603),u=n(1128),a=n(7730),c=function(t){function i(i,n,r,e,s,c){var h,f={positionTag:((h={})[u.SpotType.DYNAMIC_MC]={index:0,positionTag:"in"},h[u.SpotType.DYNAMIC_RIGHT_RAIL]={index:300,positionTag:"r"},h[u.SpotType.DYNAMIC_LEFT_RAIL]={index:400,positionTag:"l"},h)[n].positionTag,typeTag:o.TypeTag.DYNAMIC,oldType:n},d=a.Profiler.get().spotEngineConfig.tryInsideTables;return t.call(this,i,r,e,s,f,c,d)||this}return e(i,t),i}(s.ScannedSpot);i.DynamicSpot=c},4510:function(t,i,n){"use strict";var r,e,s=this&&this.__extends||(r=function(t,i){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])},r(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)});Object.defineProperty(i,"__esModule",{value:!0}),i.FixedSpot=void 0;var o=n(6454),u=n(4603),a=n(1128),c=((e={})[a.SpotType.FIXED_MC]={index:600,positionTag:"in"},e[a.SpotType.FIXED_TOP]={index:100,positionTag:"t"},e[a.SpotType.FIXED_BOTTOM]={index:200,positionTag:"b"},e[a.SpotType.FIXED_RIGHT_RAIL]={index:700,positionTag:"r"},e[a.SpotType.FIXED_LEFT_RAIL]={index:800,positionTag:"l"},e),h=function(t){function i(n,r,e,s,o,a,h){var f=this,d={positionTag:c[o].positionTag,typeTag:u.TypeTag.FIXED,oldType:o};return i.typeIndexSelectorMap[h]=i.typeIndexSelectorMap[h]||0,(f=t.call(this,n,r,e,s,d,a)||this).demandIndex=i.typeIndexSelectorMap[h],i.typeIndexSelectorMap[h]++,f.selector=h,f}return s(i,t),i.typeIndexSelectorMap={},i}(o.ScannedSpot);i.FixedSpot=h},6454:function(t,i,n){"use strict";var r,e=this&&this.__extends||(r=function(t,i){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])},r(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)});Object.defineProperty(i,"__esModule",{value:!0}),i.ScannedSpot=void 0;var s=function(t){function i(i,n,r,e,s,o,u){return t.call(this,i,s,n,r,e,o,u)||this}return e(i,t),i}(n(6864).Spot);i.ScannedSpot=s},6864:(t,i,n)=>{"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.Spot=i.AD_INDEX_LIMIT=void 0;var r=n(2727),e=n(125),s=n(7730),o=n(6393),u=n(1993),a=n(1128),c=n(4869),h=n(3034),f=n(6102),d=n(4269),l=n(5701),v=n(2362);i.AD_INDEX_LIMIT=99;var p=function(){function t(i,n,o,u,c,d,l){this.demandCompatibleSizes=null,this.wrappedElements=[],this.isAutoSize=!1,this.ref=i,this.adIndex=-1,this.type=n.oldType,this.typeIndex=o,this.demandIndex=o,this.attemptIndex=1,this.isSaas=!1,this.compatibleSizes=u,this.availableHeight=c,this.offsetTop=r.Utils.getElementPosition(i).top,this.browsiAd={h:-1,w:-1},this.isImpression=!1,this.logger=new e.Logger("Spot"),this.refresh={refreshed:!1,requested:!1,active:!1,count:0,impressionsEventCount:0,rate:0,do:!1,kv:!1,blockRefresh:!1},this.tableConfiguration=l?this.buildTableConfiguration():void 0,this.adRequestBlockedSent=!1,this.isLazyLoading=!1,this.spotRenderEnded=0,this.positionTypes=t.getPositionType(i),this.isDcs=d,this.profile=s.Profiler.get(),this.isMeasurable=!1,this.optimizeViewability=!0,this.targetElementPosition=h.SpotsUtils.getTargetElementPosition(n),this.tags=n,this.shouldUsePlaceholder()&&(this.placeholder=new f.default(this.getPlaceholderSize())),this.vConf={minViewInitiator:50,duration:1e3,shouldReportOneTime:!(this.type!==a.SpotType.STICKY&&"s"!==this.tags.positionTag)},this.v100Conf={minViewInitiator:100,duration:1e3,shouldReportOneTime:!0}}return t.prototype.buildTableConfiguration=function(){var t=this.getTableIfExists();if(t){var i=t.rows[0].cells.length,n=document.createElement("tr"),r=document.createElement("td");return r.setAttribute("colspan",i.toString()),r.setAttribute("style","width: 100%; display: none;"),n.appendChild(r),{table:t,columns:i,adWrapper:n,mainTd:r}}},t.prototype.positionTypeToString=function(){return r.Utils.sortedString(this.positionTypes)},t.prototype.getExpectedEmbedding=function(){var t=this.getCompatibleSizes().map((function(t){return t.selectedEmbedding}));if(1!==r.Utils.toSet(t).size)return"na";switch(t[0]){case"break":return"b";case"right":return"r";case"left":return"l";default:return"na"}},t.prototype.expand=function(t){var i=this,n=function(t){var i,n=null===(i=t.contentWindow)||void 0===i?void 0:i.document.body;if(n){t.style.setProperty("width","100%","important");var e=new d.default(n);e.addResizeListener((function(){var i=r.Utils.getElementSize(n).h;t.style.setProperty("height",i+"px","important"),setTimeout((function(){e.removeResizeListener()}),1e3)}))}};return new Promise((function(t,n){if(i.browsiAd.wrapper){var r=document.querySelector("#"+i.browsiAd.wrapper.id);r?t(r):n()}else n()})).then((function(e){return new Promise((function(s,o){var u,a,c=r.Utils.isFluidSize(t),h=r.Utils.getAdMarkingExpectedHeight();null===(u=i.placeholder)||void 0===u||u.removePlaceholderStyle(i.browsiAd);var f=i.getEmbeddingStyle(t);e.setAttribute("height",""+(c||i.isAutoSize?"auto":t.h+h)),e.setAttribute("width",""+(c||i.isAutoSize?"100%":t.w)),e.setAttribute("style",f.w),f.c&&i.browsiAd.container&&i.browsiAd.container.setAttribute("style",f.c);var d=i.tableConfiguration&&e&&e.parentElement?e.parentElement:null;d&&d.setAttribute("style","width: 100%;"),i.browsiAd.iframe&&(i.browsiAd.iframe.setAttribute("style","text-align:center;display: block;margin: auto;width: "+t.w+"px !important; height: "+t.h+"px !important;"),(c||(null===(a=i.profile.layouts.uxFixes)||void 0===a?void 0:a.dynamicIframeSize))&&n(i.browsiAd.iframe));var l=r.Utils.getElementPosition(e);c?setTimeout((function(){var t=e.getBoundingClientRect();i.browsiAd.w=t.width,i.browsiAd.h=t.height,i.browsiAd=r.Utils.merge(i.browsiAd,{offsetTop:l.top,offsetLeft:l.left}),s({w:i.browsiAd.w,h:i.browsiAd.h})}),800):(i.browsiAd=r.Utils.merge(i.browsiAd,{offsetTop:l.top,offsetLeft:l.left}),s({w:i.browsiAd.w,h:i.browsiAd.h}))}))})).then((function(t){return new Promise((function(n,r){i.insertAdMarking(),i.setWrappedElementsStyle(),n(t)}))}))},t.prototype.setWrappedElementsStyle=function(){var t=this;this.selectedSize&&this.selectedSize.selectedEmbedding&&["left","right"].includes(this.selectedSize.selectedEmbedding)&&this.wrappedElements.forEach((function(i){i.minWrapSize.h<=t.selectedSize.h&&i.el.style&&(i.el.style.wordBreak="break-word")}))},t.prototype.setSelectedSize=function(t){var i=this.findSize(t);if(i)this.selectedSize=i;else{var n=h.SpotsUtils.getConf(this.tags).wrapperStyle,e=s.Profiler.buildCompatibleSize(s.Profiler.getWidthForEmbed(this.ref),t,r.Utils.getAdMarkingExpectedHeight(),!0,!1,n);e&&(e.optionalEmbeddings.includes("break")&&(e.selectedEmbedding="break"),this.selectedSize=e,this.logger.warn("unexpected "+JSON.stringify(t)+" to",this.browsiAd.wrapper))}this.browsiAd=Object.assign({},this.browsiAd,t)},t.prototype.isSizeInSpot=function(t){return!!this.findSize(t)},t.prototype.findSize=function(t){return this.getCompatibleSizes().find((function(i){return i.w===+t.w&&i.h===+t.h}))},t.prototype.getDomId=function(){return this.domId||"e"},t.prototype.setDomId=function(t){this.domId=t},t.prototype.getEmbeddingStyle=function(t){var i,n,r;if(this.type===a.SpotType.STICKY){var e="position:fixed!important;"+(null===(i=s.Profiler.get().layouts.spots.sticky)||void 0===i?void 0:i.location.toLowerCase())+": 0 !important; left: 50%; transform: translateX(-50%); margin:0 auto !important; z-index:9999;text-align:center; width:"+t.w+"px !important; height:"+t.h+"px !important;",o=this.getExternalStyle();return(null===(n=null==o?void 0:o.b)||void 0===n?void 0:n.w)&&(e+=o.b.w),{w:e,c:(null===(r=null==o?void 0:o.b)||void 0===r?void 0:r.c)||""}}var u={w:"",c:""};return t.selectedEmbedding?u=this.buildStyle(t,l.DEFAULT_SPOT_STYLE):this.logger.error("no embedding for spot "+this.adIndex,this.browsiAd.wrapper),u},t.prototype.buildStyle=function(t,i){var n,e,s=h.SpotsUtils.getConf(this.tags).style,o={w:"",c:""};if("break"===t.selectedEmbedding){var u=r.Utils.isFluidSize(t),a="margin: auto;margin-top:"+i.b.m.t+"px !important;margin-bottom:"+i.b.m.b+"px !important";o.w="text-align:center;display:block;clear: both !important;"+a+";width:"+(u?"100%":"auto")+" !important; height: auto !important;",(null===(n=null==s?void 0:s.b)||void 0===n?void 0:n.w)&&(o.w+=s.b.w),(null===(e=null==s?void 0:s.b)||void 0===e?void 0:e.c)&&(o.c=s.b.c)}else{var c=r.Utils.getAdMarkingExpectedHeight(),f="left"===t.selectedEmbedding?i.l:i.r,d="left"===t.selectedEmbedding?null==s?void 0:s.l:null==s?void 0:s.r,l=getComputedStyle(this.ref),v=(a="margin-top:"+(-1===f.m.t?parseInt(l.marginTop||"0"):f.m.t)+"px !important;\n                             margin-right:"+f.m.r+"px !important;\n                             margin-bottom:"+f.m.b+"px !important;\n                             margin-left:"+f.m.l+"px !important","padding-top:"+(-1===f.p.t?parseInt(l.paddingTop||"0"):f.p.t)+"px !important;\n                             padding-right:"+f.p.r+"px !important;\n                             padding-bottom:"+f.p.b+"px !important;\n                             padding-left:"+f.p.l+"px !important"),p=this.isAutoSize?"width:auto;height:auto;":"width:"+t.w+"px !important; height:"+(t.h+c)+"px !important;";o.w="text-align:center;float:"+t.selectedEmbedding+";position:relative;"+r.Utils.removeSpaces(a)+";"+r.Utils.removeSpaces(v)+";"+p,(null==d?void 0:d.w)&&(o.w+=d.w),(null==d?void 0:d.c)&&(o.c=d.c)}return o},t.prototype.getExternalStyle=function(){return h.SpotsUtils.getConf(this.tags).style},t.prototype.insertAdMarking=function(){if(this.type!==a.SpotType.STICKY){var t=s.Profiler.get().spotEngineConfig.adMarking;if(t&&this.browsiAd.wrapper&&this.selectedSize&&!this.browsiAd.admarking){var i=r.Utils.buildAdMarking(this,t);this.browsiAd.wrapper.insertBefore(i,this.browsiAd.wrapper.firstChild),this.browsiAd.admarking=i}}},t.prototype.getTableIfExists=function(){return this.ref?r.Utils.findParentElementByType("table",this.ref):null},t.prototype.cloneBrowsiAd=function(t){return Object.assign({},t)},t.prototype.destroySlot=function(){var t,i,n=this.slot&&(null===(i=null===(t=this.browsiAd.win)||void 0===t?void 0:t.googletag)||void 0===i?void 0:i.destroySlots([this.slot]));return delete this.slot,!n&&this.logger.debug("could not destroy slot",this),n},t.prototype.updateRefreshDetails=function(t){this.refresh.requested||this.isAllowedProvider(t)&&(this.refresh=Object.assign(this.refresh,{active:t.c.ri&&t.c.ri.r>-1,refreshed:!!this.refresh.refreshed&&this.refresh.refreshed,requested:!!this.refresh.requested&&this.refresh.requested,count:this.refresh.count?this.refresh.count:0,impressionsEventCount:this.refresh.impressionsEventCount?this.refresh.impressionsEventCount:0,rate:t.c.ri&&t.c.ri.r?t.c.ri.r:0,do:!(!t.c.ri||!t.c.ri.do)&&t.c.ri.do,kv:!(!t.c.ri||!t.c.ri.kv)&&t.c.ri.kv}))},t.prototype.refreshSpot=function(){this.placeholder=void 0,this.canRefresh()&&(this.logger.info("Refreshing spot #"+this.adIndex),c.ViewabilityService.get().unsubscribe(this),this.refresh=Object.assign(this.refresh,{requested:!0,refreshed:!1,dcsRefresh:!1,oldBrowsiAd:this.cloneBrowsiAd(this.browsiAd)}),this.refresh.count++,this.waterfall=[],this.isMeasurable=!1,"generic_js"!==this.providerName?o.YieldClient.get().processSingleSpot(this):this.invokeRefreshCallback&&(c.ViewabilityService.get().unsubscribe(this),this.invokeRefreshCallback()))},t.prototype.refreshDcsSpotOnNewPv=function(){this.profile.layouts.analysisMode||(this.logger.info("Refreshing dcs spot"),c.ViewabilityService.get().unsubscribe(this),this.refresh=Object.assign(this.refresh,{active:!0,requested:!0,refreshed:!1,dcsRefresh:!0,oldBrowsiAd:this.cloneBrowsiAd(this.browsiAd)}),this.waterfall=[],o.YieldClient.get().processSingleSpot(this))},t.prototype.canRefresh=function(){return!this.isRefreshing()&&this.spotShouldRefresh()},t.prototype.stopRefreshing=function(){this.refresh.blockRefresh=!0},t.prototype.isRefreshing=function(){return this.refresh.active&&this.refresh.requested&&!this.refresh.refreshed},t.prototype.spotShouldRefresh=function(){return this.refresh.active&&!this.refresh.blockRefresh},t.prototype.handleRefreshFailed=function(){this.refresh.requested=!1,this.refresh.refreshed=!1},t.prototype.handleRefreshSuccess=function(){if(this.isRefreshing()){if(this.refresh.oldBrowsiAd&&this.refresh.oldBrowsiAd.wrapper){v.Embedder.removeAdMarkingFromDom(this.browsiAd);var t=void 0;(t=this.tableConfiguration?this.refresh.oldBrowsiAd.wrapper.parentElement:this.refresh.oldBrowsiAd.wrapper)&&(r.Utils.removeElement(t),r.Utils.reportBrowsiAdRemoved(t)),this.refresh.oldBrowsiAd.externalElement&&r.Utils.removeElement(this.refresh.oldBrowsiAd.externalElement)}this.updateRefreshedSuccessStatus(),this.refresh.impressionsEventCount=this.refresh.count,this.logger.info("spot #"+this.adIndex+" refreshed with count "+this.refresh.count)}},t.prototype.updateRefreshedSuccessStatus=function(){this.refresh.requested=!1,this.refresh.refreshed=!0},t.prototype.updateBrowsiAdWrapper=function(){this.refresh.oldBrowsiAd&&this.refresh.oldBrowsiAd.wrapper&&(this.browsiAd.wrapper=this.refresh.oldBrowsiAd.wrapper,this.domId=this.refresh.oldBrowsiAd.wrapper.id,this.browsiAd.container=document.getElementById(this.refresh.oldBrowsiAd.wrapper.id.replace("adWrapper","adContainer"))||void 0)},t.prototype.initializeTypeIndex=function(t){var n=Math.min(t,i.AD_INDEX_LIMIT);this.typeIndex=n,this.demandIndex=n},t.prototype.isAllowedProvider=function(t){return"header_bidding"!==this.providerName||!!t.c.d},Object.defineProperty(t.prototype,"refreshInfo",{get:function(){var t=this;return{shouldRefresh:this.spotShouldRefresh.bind(this),rate:this.refresh.rate,doRefresh:function(){return t.refreshSpot()}}},enumerable:!1,configurable:!0}),t.prototype.sendViewedImpression=function(t){u.EventsService.get().sendViewedImpression(this,t)},t.prototype.sendViewedImpression100=function(t){u.EventsService.get().sendViewedImpression100(this)},t.getPositionType=function(t){var i=s.Profiler.get(),n=[],e=r.Utils.getElementSize(t),o=r.Utils.getElementPosition(t);if(i.domData&&i.domData.mainContent.inputElements&&i.domData.mainContent.start>-1){for(var u=i.domData.mainContent,a=u.inputElements[0].getBoundingClientRect().width,c=r.Utils.getElementPosition(u.inputElements[0]).left,h=0,f=o.left,d=Math.round(f+e.w),l=o.top,v=0;v<u.inputElements.length;v++)c=Math.min(c,r.Utils.getElementPosition(u.inputElements[v]).left),h=Math.max(h,c+a);f>=c&&d<=h?n.push("in-line"):(f<c&&d<=c&&n.push("left rail"),f>=h&&n.push("right rail")),l<u.start&&n.push("top"),l>u.endPosition&&n.push("bottom"),-1!=n.indexOf("in-line")&&-1==n.indexOf("bottom")&&-1==n.indexOf("top")&&n.push("within main content")}else n.push("out of main content");return 0===n.length&&n.push("unknown"),n},t.prototype.shouldWaitForUserEngagement=function(){return!r.Utils.isEngagedUser(this)&&!this.isEagerFirstFold()},t.prototype.subscribeToViewabilityService=function(){c.ViewabilityService.get().subscribe(this.buildViewabilityServiceObject(this.v100Conf)),c.ViewabilityService.get().subscribe(this.buildViewabilityServiceObject(this.vConf))},t.prototype.isEagerFirstFold=function(){return this.profile.layouts.eagerFirstFold&&r.Utils.getElementFoldNumber(this.ref)<=2},t.prototype.buildViewabilityServiceObject=function(t){var i=this,n=t.minViewInitiator===this.v100Conf.minViewInitiator,e=n?this.sendViewedImpression100.bind(this):this.sendViewedImpression.bind(this),s=n?{shouldRefresh:function(){return!1},rate:0,doRefresh:function(){}}:this.refreshInfo,o=this.generateInViewActionsMap(t,s.shouldRefresh());return{conf:t,refreshInfo:s,sendViewedImpression:e,type:0,getCoords:function(){return r.Utils.getSpotCoords(i)},getHeight:function(){return i.browsiAd.h},root:function(){return i},element:this.browsiAd.iframe?this.browsiAd.iframe:this.browsiAd.container,inViewActionsMap:o}},t.prototype.updateInSpotEngineTest=function(){var t=s.Profiler.get();t.debugMode&&t.spotEngineTest&&t.spotEngineTest.spots&&(t.spotEngineTest.spots[this.adIndex]=this.serialize())},t.prototype.serialize=function(){return{ref:this.ref,adIndex:this.adIndex,attemptIndex:this.attemptIndex,compatibleSizes:this.compatibleSizes,demandCompatibleSizes:this.demandCompatibleSizes,availableHeight:this.availableHeight,selectedSize:this.selectedSize,tableConfiguration:this.tableConfiguration,offsetTop:this.offsetTop,browsiAd:{iframe:this.browsiAd.iframe,wrapper:this.browsiAd.wrapper,container:this.browsiAd.container,admarking:this.browsiAd.admarking,w:this.browsiAd.w,h:this.browsiAd.h},adUnit:this.adUnit,isSaas:this.isSaas,providerName:this.providerName,isImpression:this.isImpression,slot:this.slot,domId:this.domId,logger:this.logger,refresh:this.refresh,adRequestBlockedSent:this.adRequestBlockedSent,isLazyLoading:this.isLazyLoading,spotRenderEnded:this.spotRenderEnded,waterfall:this.waterfall,positionTypes:this.positionTypes,type:this.type,typeIndex:this.typeIndex,placeholder:this.placeholder}},t.prototype.getIdentifier=function(){return"ai_"+this.adIndex+"_ati_"+(this.attemptIndex?this.attemptIndex:1)+"_rc_"+(this.refresh.active?this.refresh.count:0)},t.prototype.prepareResponseForFetch=function(t){return t},t.prototype.handleEmptyResponse=function(){return null},t.prototype.shouldUsePlaceholder=function(){var t;return this.profile.layouts.placeholder&&!!this.compatibleSizes.length&&(this.compatibleSizes.length>1||!this.isOneOnOne(this.compatibleSizes[0]))&&!(null===(t=this.refresh)||void 0===t?void 0:t.requested)},t.prototype.isOneOnOne=function(t){return 1===t.w&&1===t.h},t.prototype.getMaxSize=function(t){var i=0,n=0;return t.forEach((function(t){t.w>i&&(i=t.w),t.h>n&&(n=t.h)})),{w:i,h:n}},t.prototype.getPlaceholderSize=function(){var t=this.getMaxSize(this.getCompatibleSizes());if(r.Utils.isFluidSize(t)||this.isOneOnOne(t))return{w:r.Utils.getElementSize(this.ref).w,h:250};var i=t.w,n=t.h;switch(this.tags.positionTag){case"t":case"b":i=970,n=300;break;case"in":this.hasWrappedEmbedding()?(i=300,n=0):(n=300,i=970)}return{w:Math.min(t.w,i),h:Math.min(t.h,n)}},t.prototype.hasWrappedEmbedding=function(){return this.compatibleSizes.some((function(t){return t.optionalEmbeddings.includes("wrapped")||t.optionalEmbeddings.includes("left")||t.optionalEmbeddings.includes("right")}))},t.prototype.closePlaceholderAndRemove=function(){this.placeholder?this.placeholder.closePlaceholder(!0,this):v.Embedder.removeAdFromDom(this)},t.prototype.unsetRefDisplay=function(){},t.prototype.getCompatibleSizes=function(){return this.demandCompatibleSizes||this.compatibleSizes},t.prototype.generateInViewActionsMap=function(t,i){var n={};return n=c.ViewabilityService.get().addActionToMap(["event"],[t.duration],n),!t.shouldReportOneTime&&s.Profiler.get().sendViewabilityCheckpoints&&(n=c.ViewabilityService.get().addActionToMap(["event"],[2e3,5e3,1e4,2e4,25e3,3e4],n)),i&&this.spotShouldRefresh()&&this.refresh.rate>0&&(n=c.ViewabilityService.get().addActionToMap(["refresh"],[this.refresh.rate],n)),n},t}();i.Spot=p},5382:function(t,i,n){"use strict";var r,e=this&&this.__extends||(r=function(t,i){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])},r(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)});Object.defineProperty(i,"__esModule",{value:!0}),i.StickySpot=void 0;var s=n(9763),o=n(4603),u=n(1128),a=n(8104),c=n(3034),h=function(t){function i(i,n){var r,e=this,s={positionTag:"s",typeTag:o.TypeTag.STICKY,oldType:u.SpotType.STICKY},h=null===(r=c.SpotsUtils.getConf(u.SPOT_TAGS_MAP[u.SpotType.STICKY]))||void 0===r?void 0:r.location;return(e=t.call(this,window.document.body,s,-1,i,-1,n)||this).positionTypes=[h==a.StickyLocation.BOTTOM?"bottom":"top"],e.isLazyLoading=!1,e}return e(i,t),i}(s.DirectSpot);i.StickySpot=h},6652:()=>{var t,i,n,r;Array.prototype.reduce||Object.defineProperty(Array.prototype,"reduce",{value:function(t){if(null===this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof t)throw new TypeError(t+" is not a function");var i,n=Object(this),r=n.length>>>0,e=0;if(arguments.length>=2)i=arguments[1];else{for(;e<r&&!(e in n);)e++;if(e>=r)throw new TypeError("Reduce of empty array with no initial value");i=n[e++]}for(;e<r;)e in n&&(i=t(i,n[e],e,n)),e++;return i}}),Array.prototype.filter||(Array.prototype.filter=function(t){"use strict";if(null==this)throw new TypeError;var i=Object(this),n=i.length>>>0;if("function"!=typeof t)throw new TypeError;for(var r=[],e=arguments.length>=2?arguments[1]:void 0,s=0;s<n;s++)if(s in i){var o=i[s];t.call(e,o,s,i)&&r.push(o)}return r}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(t){if(null==this)throw new TypeError('"this" is null or not defined');var i=Object(this),n=i.length>>>0;if("function"!=typeof t)throw new TypeError("predicate must be a function");for(var r=arguments[1],e=0;e<n;){var s=i[e];if(t.call(r,s,e,i))return s;e++}}}),"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(t,i){"use strict";if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(t),r=1;r<arguments.length;r++){var e=arguments[r];if(null!=e)for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(n[s]=e[s])}return n},writable:!0,configurable:!0}),Array.from||(Array.from=(t=Object.prototype.toString,i=function(i){return"function"==typeof i||"[object Function]"===t.call(i)},n=Math.pow(2,53)-1,r=function(t){var i=function(t){var i=Number(t);return isNaN(i)?0:0!==i&&isFinite(i)?(i>0?1:-1)*Math.floor(Math.abs(i)):i}(t);return Math.min(Math.max(i,0),n)},function(t){var n=this,e=Object(t);if(null==t)throw new TypeError("Array.from requires an array-like object - not null or undefined");var s,o=arguments.length>1?arguments[1]:void 0;if(void 0!==o){if(!i(o))throw new TypeError("Array.from: when provided, the second argument must be a function");arguments.length>2&&(s=arguments[2])}for(var u,a=r(e.length),c=i(n)?Object(new n(a)):new Array(a),h=0;h<a;)u=e[h],c[h]=o?void 0===s?o(u,h):o.call(s,u,h):u,h+=1;return c.length=a,c})),Array.prototype.some||(Array.prototype.some=function(t){"use strict";if(null==this)throw new TypeError("Array.prototype.some called on null or undefined");if("function"!=typeof t)throw new TypeError;for(var i=Object(this),n=i.length>>>0,r=arguments.length>=2?arguments[1]:void 0,e=0;e<n;e++)if(e in i&&t.call(r,i[e],e,i))return!0;return!1}),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(t,i){if(null==this)throw new TypeError('"this" is null or not defined');var n=Object(this),r=n.length>>>0;if(0===r)return!1;for(var e,s,o=0|i,u=Math.max(o>=0?o:r-Math.abs(o),0);u<r;){if((e=n[u])===(s=t)||"number"==typeof e&&"number"==typeof s&&isNaN(e)&&isNaN(s))return!0;u++}return!1}}),Array.prototype.findIndex||Object.defineProperty(Array.prototype,"findIndex",{value:function(t){if(null==this)throw new TypeError('"this" is null or not defined');var i=Object(this),n=i.length>>>0;if("function"!=typeof t)throw new TypeError("predicate must be a function");for(var r=arguments[1],e=0;e<n;){var s=i[e];if(t.call(r,s,e,i))return e;e++}return-1},configurable:!0,writable:!0}),Number.isInteger=Number.isInteger||function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t},"function"!=typeof window.CustomEvent&&(window.CustomEvent=function(t,i){i=i||{bubbles:!1,cancelable:!1,detail:null};var n=document.createEvent("CustomEvent");return n.initCustomEvent(t,i.bubbles,i.cancelable,i.detail),n}),String.prototype.includes||(String.prototype.includes=function(t,i){"use strict";if(t instanceof RegExp)throw TypeError("first argument must not be a RegExp");return void 0===i&&(i=0),-1!==this.indexOf(t,i)})}},i={},function n(r){if(i[r])return i[r].exports;var e=i[r]={exports:{}};return t[r].call(e.exports,e,e.exports,n),e.exports}(7121);